{
  "config": {
    "max_epochs": 10,
    "attacker_image": "attacker:latest",
    "attacker_container_name": "attackercontainer-attacker",
    "attack_duration": 200,
    "monitor_accumulation_wait": 50,
    "firewall_update_wait": 2,
    "between_epoch_wait": 1,
    "attacker_network": "192.168.100.0/24",
    "honeypot_network": "172.20.0.0/24",
    "firewall_api_url": "http://192.168.200.2:5000",
    "allow_full_compromise": true,
    "stop_on_lockdown": true,
    "clear_memory_between_epochs": false,
    "results_dir": "./benchmark_results",
    "dir_name": "Test Struts + Gitlab + 2 decoys - MultiAgent + fast + attack_graph_enhance",
    "save_detailed_logs": true,
    "log_level": "INFO"
  },
  "start_time": 1754832897.1719203,
  "end_time": 1754833438.506549,
  "total_epochs": 5,
  "epochs": [
    {
      "epoch_number": 1,
      "start_time": 1754832897.1719203,
      "end_time": 1754832992.094886,
      "phase_timings": {
        "initialization": 1754832897.1719427,
        "attack_execution": 1754832897.1893218,
        "monitoring_accumulation": 1754832904.0322254,
        "agent_analysis": 1754832954.033723,
        "firewall_update_wait": 1754832990.0829391,
        "metrics_collection": 1754832992.0838606,
        "epoch_complete": 1754832992.0944488
      },
      "services_detected": [],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.6 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.6 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.6",
        "service": "cve-2015-5254-activemq-1",
        "current_level": 33
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 12",
            "ET SCAN Suspicious inbound to mySQL port 3306: 2"
          ]
        },
        {
          "ip": "172.20.0.6",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 10",
            "ET SCAN Suspicious inbound to mySQL port 3306: 2",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "cve-2014-6271-web-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 8",
            "ET SCAN Suspicious inbound to mySQL port 3306: 2",
            "POSSBL PORT SCAN (NMAP -sS) [different sig]: 2",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 8",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "b2511527c4a2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 12",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.6",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "05edbc1b0b2d",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 10",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "d60a3aaff453",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 8",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "POSSBL PORT SCAN (NMAP -sS) [different sig]: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "0e77ac17fab1",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 8",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1,
                "confidence": 0.33
              }
            ]
          }
        ]
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 2,
      "start_time": 1754832993.098697,
      "end_time": 1754833090.2294464,
      "phase_timings": {
        "initialization": 1754832993.0987172,
        "attack_execution": 1754832993.1097653,
        "monitoring_accumulation": 1754832998.0697145,
        "agent_analysis": 1754833048.0712059,
        "firewall_update_wait": 1754833088.2175527,
        "metrics_collection": 1754833090.2187076,
        "epoch_complete": 1754833090.2289026
      },
      "services_detected": [
        "PATROL-SNMP(172.20.0.6:8161)",
        "UNKNOWN(172.20.0.6:61616)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.2 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.6           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.6"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.2",
        "service": "s2-057-struts2-1",
        "current_level": 33
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 12",
            "ET SCAN Suspicious inbound to mySQL port 3306: 2"
          ]
        },
        {
          "ip": "172.20.0.6",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 10",
            "ET SCAN Suspicious inbound to mySQL port 3306: 2",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 8",
            "ET SCAN Suspicious inbound to mySQL port 3306: 2",
            "POSSBL PORT SCAN (NMAP -sS) [different sig]: 2",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 8",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "b2511527c4a2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 12",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.6",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "05edbc1b0b2d",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 10",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "d60a3aaff453",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 8",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "POSSBL PORT SCAN (NMAP -sS) [different sig]: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "0e77ac17fab1",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 8",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1,
                "confidence": 0.33
              }
            ]
          }
        ]
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 3,
      "start_time": 1754833091.2331417,
      "end_time": 1754833205.5099494,
      "phase_timings": {
        "initialization": 1754833091.2331529,
        "attack_execution": 1754833091.2441866,
        "monitoring_accumulation": 1754833104.0873077,
        "agent_analysis": 1754833154.0884106,
        "firewall_update_wait": 1754833203.496427,
        "metrics_collection": 1754833205.4979262,
        "epoch_complete": 1754833205.5095112
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.2:8080)"
      ],
      "services_successfully_exploited": [
        "STRUTS"
      ],
      "exploits_attempted": [
        "HTTP-PROXY(172.20.0.2:8080)"
      ],
      "flags_captured": [
        {
          "service": "STRUTS",
          "flag": "flag{privileged_struts}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.2           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.2"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 33
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 6 alerts",
            "ET WEB_SPECIFIC_APPS Apache Struts OGNL injection RCE: 6 alerts",
            "ET HUNTING .exec in HTTP URI Inbound: 6 alerts",
            "Reverse Shell Detected - No Job Control: 2 alerts"
          ]
        },
        {
          "ip": "172.20.0.6",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 12 alerts",
            "ET SCAN Suspicious inbound to mySQL port 3306: 2 alerts",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1 alert"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 7 alerts",
            "ET SCAN Potential SSH Scan: 1 alert",
            "ET SCAN Suspicious inbound to mySQL port 3306: 2 alerts",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 2 alerts"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 7 alerts",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1 alert",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1 alert"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "s2-057-struts2-1",
            "confidence": 0.66
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "b2511527c4a2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 15+ alerts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1 alert",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2 alerts"
                ],
                "seen_in_epoch": 2,
                "first_seen": 1,
                "last_seen": 2,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "initial-access/rce",
            "confidence": 0.66,
            "edge_id": "b2511527c4a2",
            "phases": [
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 6 alerts",
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL injection RCE: 6 alerts",
                  "ET HUNTING .exec in HTTP URI Inbound: 6 alerts",
                  "Reverse Shell Detected - No Job Control: 2 alerts"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2,
                "confidence": 0.66
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.6",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "05edbc1b0b2d",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 12 alerts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2 alerts",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1 alert"
                ],
                "seen_in_epoch": 2,
                "first_seen": 1,
                "last_seen": 2,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "d60a3aaff453",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 7 alerts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1 alert",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1 alert"
                ],
                "seen_in_epoch": 2,
                "first_seen": 1,
                "last_seen": 2,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "0e77ac17fab1",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 7 alerts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2 alerts",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2 alerts"
                ],
                "seen_in_epoch": 2,
                "first_seen": 1,
                "last_seen": 2,
                "confidence": 0.33
              }
            ]
          }
        ]
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 4,
      "start_time": 1754833206.514766,
      "end_time": 1754833336.7281353,
      "phase_timings": {
        "initialization": 1754833206.5147762,
        "attack_execution": 1754833206.5263524,
        "monitoring_accumulation": 1754833228.191812,
        "agent_analysis": 1754833278.1925476,
        "firewall_update_wait": 1754833334.7163885,
        "metrics_collection": 1754833336.7173295,
        "epoch_complete": 1754833336.7276394
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [
        "HTTP(172.20.0.10:80)"
      ],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{user_access}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.7 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.7 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.7",
        "service": "cve-2014-6271-web-1",
        "current_level": 33
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.6",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "Evidence of bash shell piped to tcp (possible exploit attempt)",
            "Multiple reverse shell detections",
            "User-level file discovery (find binary execution)",
            "Reverse Shell Detected: 2"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "s2-057-struts2-1",
            "confidence": 0.66
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 0.66
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "b2511527c4a2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 15+ alerts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1 alert",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2 alerts"
                ],
                "seen_in_epoch": 2,
                "first_seen": 1,
                "last_seen": 2,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "initial-access/rce",
            "confidence": 0.66,
            "edge_id": "b2511527c4a2",
            "phases": [
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 6 alerts",
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL injection RCE: 6 alerts",
                  "ET HUNTING .exec in HTTP URI Inbound: 6 alerts",
                  "Reverse Shell Detected - No Job Control: 2 alerts"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2,
                "confidence": 0.66
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.6",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "05edbc1b0b2d",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 12 alerts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2 alerts",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1 alert"
                ],
                "seen_in_epoch": 2,
                "first_seen": 1,
                "last_seen": 2,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "d60a3aaff453",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 7 alerts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1 alert",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1 alert"
                ],
                "seen_in_epoch": 2,
                "first_seen": 1,
                "last_seen": 2,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "0e77ac17fab1",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 7 alerts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2 alerts",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2 alerts"
                ],
                "seen_in_epoch": 2,
                "first_seen": 1,
                "last_seen": 2,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "initial-access/rce",
            "confidence": 0.66,
            "edge_id": "0e77ac17fab1",
            "phases": [
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "Evidence of bash shell piped to tcp (possible exploit attempt)",
                  "Multiple reverse shell detections",
                  "User-level file discovery (find binary execution)",
                  "Reverse Shell Detected: 2"
                ],
                "seen_in_epoch": 3,
                "first_seen": 3,
                "last_seen": 3,
                "confidence": 0.66
              }
            ]
          }
        ]
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 5,
      "start_time": 1754833337.732054,
      "end_time": 1754833438.506549,
      "phase_timings": {
        "initialization": 1754833337.732064,
        "attack_execution": 1754833337.742695,
        "monitoring_accumulation": 1754833342.4048543,
        "agent_analysis": 1754833392.4056118,
        "firewall_update_wait": 1754833436.493376,
        "metrics_collection": 1754833438.4947643,
        "epoch_complete": 1754833438.5058231
      },
      "services_detected": [
        "HTTP(172.20.0.7:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [
        "HTTP(172.20.0.7:80)"
      ],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.7           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.7"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "N/A",
        "service": "N/A",
        "current_level": 100
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.6",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "s2-057-struts2-1",
            "confidence": 0.66
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 0.66
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "b2511527c4a2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 15+ alerts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1 alert",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2 alerts"
                ],
                "seen_in_epoch": 2,
                "first_seen": 1,
                "last_seen": 2,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "initial-access/rce",
            "confidence": 0.66,
            "edge_id": "b2511527c4a2",
            "phases": [
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 6 alerts",
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL injection RCE: 6 alerts",
                  "ET HUNTING .exec in HTTP URI Inbound: 6 alerts",
                  "Reverse Shell Detected - No Job Control: 2 alerts"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2,
                "confidence": 0.66
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.6",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "05edbc1b0b2d",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 12 alerts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2 alerts",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1 alert"
                ],
                "seen_in_epoch": 2,
                "first_seen": 1,
                "last_seen": 2,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "d60a3aaff453",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 7 alerts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1 alert",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1 alert"
                ],
                "seen_in_epoch": 2,
                "first_seen": 1,
                "last_seen": 2,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "0e77ac17fab1",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 7 alerts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2 alerts",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2 alerts"
                ],
                "seen_in_epoch": 2,
                "first_seen": 1,
                "last_seen": 2,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "initial-access/rce",
            "confidence": 0.66,
            "edge_id": "0e77ac17fab1",
            "phases": [
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "Evidence of bash shell piped to tcp (possible exploit attempt)",
                  "Multiple reverse shell detections",
                  "User-level file discovery (find binary execution)",
                  "Reverse Shell Detected: 2"
                ],
                "seen_in_epoch": 3,
                "first_seen": 3,
                "last_seen": 3,
                "confidence": 0.66
              }
            ]
          }
        ]
      },
      "lockdown_activated": true
    }
  ],
  "summary": {
    "total_flags_captured": 2,
    "average_epoch_duration": 107.46367745399475,
    "lockdown_triggered": true,
    "lockdown_epoch": 5,
    "final_honeypots_exploitation": [
      {
        "ip": "172.20.0.2",
        "service": "s2-057-struts2-1",
        "level_prev": 66,
        "level_new": 66,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.6",
        "service": "cve-2015-5254-activemq-1",
        "level_prev": 33,
        "level_new": 33,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "level_prev": 66,
        "level_new": 66,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.7",
        "service": "cve-2014-6271-web-1",
        "level_prev": 33,
        "level_new": 33,
        "changed": false,
        "evidence_quotes": []
      }
    ],
    "final_inferred_attack_graph": {
      "interesting": [
        {
          "ip": "172.20.0.2",
          "service": "s2-057-struts2-1",
          "confidence": 0.66
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "confidence": 0.66
        }
      ],
      "edges": [
        {
          "from": "192.168.100.2",
          "to": "172.20.0.2",
          "vector": "scan",
          "confidence": 0.33,
          "edge_id": "b2511527c4a2",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS): 15+ alerts",
                "ET SCAN Suspicious inbound to mySQL port 3306: 1 alert",
                "ET SCAN Suspicious inbound to MSSQL port 1433: 2 alerts"
              ],
              "seen_in_epoch": 2,
              "first_seen": 1,
              "last_seen": 2,
              "confidence": 0.33
            }
          ]
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.2",
          "vector": "initial-access/rce",
          "confidence": 0.66,
          "edge_id": "b2511527c4a2",
          "phases": [
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 6 alerts",
                "ET WEB_SPECIFIC_APPS Apache Struts OGNL injection RCE: 6 alerts",
                "ET HUNTING .exec in HTTP URI Inbound: 6 alerts",
                "Reverse Shell Detected - No Job Control: 2 alerts"
              ],
              "seen_in_epoch": 2,
              "first_seen": 2,
              "last_seen": 2,
              "confidence": 0.66
            }
          ]
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.6",
          "vector": "scan",
          "confidence": 0.33,
          "edge_id": "05edbc1b0b2d",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS): 12 alerts",
                "ET SCAN Suspicious inbound to mySQL port 3306: 2 alerts",
                "ET SCAN Suspicious inbound to MSSQL port 1433: 1 alert"
              ],
              "seen_in_epoch": 2,
              "first_seen": 1,
              "last_seen": 2,
              "confidence": 0.33
            }
          ]
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.7",
          "vector": "scan",
          "confidence": 0.33,
          "edge_id": "d60a3aaff453",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS): 7 alerts",
                "ET SCAN Suspicious inbound to mySQL port 3306: 1 alert",
                "ET SCAN Suspicious inbound to MSSQL port 1433: 1 alert"
              ],
              "seen_in_epoch": 2,
              "first_seen": 1,
              "last_seen": 2,
              "confidence": 0.33
            }
          ]
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.10",
          "vector": "scan",
          "confidence": 0.33,
          "edge_id": "0e77ac17fab1",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS): 7 alerts",
                "ET SCAN Suspicious inbound to mySQL port 3306: 2 alerts",
                "ET SCAN Suspicious inbound to MSSQL port 1433: 2 alerts"
              ],
              "seen_in_epoch": 2,
              "first_seen": 1,
              "last_seen": 2,
              "confidence": 0.33
            }
          ]
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.10",
          "vector": "initial-access/rce",
          "confidence": 0.66,
          "edge_id": "0e77ac17fab1",
          "phases": [
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "Evidence of bash shell piped to tcp (possible exploit attempt)",
                "Multiple reverse shell detections",
                "User-level file discovery (find binary execution)",
                "Reverse Shell Detected: 2"
              ],
              "seen_in_epoch": 3,
              "first_seen": 3,
              "last_seen": 3,
              "confidence": 0.66
            }
          ]
        }
      ]
    }
  }
}