{
  "config": {
    "max_epochs": 20,
    "attacker_image": "attacker:latest",
    "attacker_container_name": "attackercontainer-attacker",
    "attack_duration": 240,
    "monitor_accumulation_wait": 5,
    "firewall_update_wait": 2,
    "between_epoch_wait": 1,
    "attacker_network": "192.168.100.0/24",
    "honeypot_network": "172.20.0.0/24",
    "firewall_api_url": "http://192.168.200.2:5000",
    "allow_full_compromise": true,
    "stop_on_lockdown": true,
    "clear_memory_between_epochs": false,
    "results_dir": "./benchmark/benchmark_results",
    "dir_name": "test_3",
    "save_detailed_logs": true,
    "log_level": "INFO"
  },
  "start_time": 1759429332.5402498,
  "end_time": 1759430471.3536363,
  "total_epochs": 10,
  "epochs": [
    {
      "epoch_number": 1,
      "start_time": 1759429332.5402498,
      "end_time": 1759429396.1128936,
      "phase_timings": {
        "initialization": 1759429332.540271,
        "attack_execution": 1759429332.5506654,
        "monitoring_accumulation": 1759429349.133136,
        "agent_analysis": 1759429354.1337404,
        "firewall_update_wait": 1759429394.10195,
        "metrics_collection": 1759429396.1038516,
        "epoch_complete": 1759429396.1122875
      },
      "services_detected": [],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.2 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "current_level": 0,
        "epoch": 1
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [],
        "edges": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 2,
      "start_time": 1759429397.1171849,
      "end_time": 1759429468.8000932,
      "phase_timings": {
        "initialization": 1759429397.1172075,
        "attack_execution": 1759429397.1314785,
        "monitoring_accumulation": 1759429415.1612983,
        "agent_analysis": 1759429420.1621475,
        "firewall_update_wait": 1759429466.7809205,
        "metrics_collection": 1759429468.7828274,
        "epoch_complete": 1759429468.7990344
      },
      "services_detected": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "current_level": 0,
        "epoch": 2
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [],
        "edges": []
      },
      "service_epoch_context": [
        {
          "service_id": "docker:172.20.0.2:2375",
          "service": "docker",
          "host": "172.20.0.2",
          "port": "2375",
          "first_exposed_epoch": 2,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 3,
      "start_time": 1759429469.8076324,
      "end_time": 1759429555.763115,
      "phase_timings": {
        "initialization": 1759429469.8076508,
        "attack_execution": 1759429469.8244972,
        "monitoring_accumulation": 1759429496.211119,
        "agent_analysis": 1759429501.2121537,
        "firewall_update_wait": 1759429553.7419891,
        "metrics_collection": 1759429555.7431722,
        "epoch_complete": 1759429555.7620711
      },
      "services_detected": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "services_successfully_exploited": [
        "DOCKER"
      ],
      "exploits_attempted": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "flags_captured": [
        {
          "service": "DOCKER",
          "flag": "flag{docker}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.7 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.7 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.2           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.2"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.7",
        "service": "xdebug-rce-xdebug2-1",
        "current_level": 33,
        "epoch": 3
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 0,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "destructive Docker API commands issued via REST calls",
            "User-Level File Discovery"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "scanned ... tcp/8081, tcp/3306, tcp/135, tcp/61616"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "scanned ... tcp/3306, tcp/1433, tcp/22, tcp/1720, tcp/61616",
            "critical fast RDP traffic detection"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "scanned on tcp/80, tcp/22, tcp/1433 with SQL and web service probing"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "experienced extensive scanning"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "destructive Docker API commands issued via REST calls"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "attempts to read sensitive files (\"find / -type f -name 'user.txt'\")"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 3,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/8081, tcp/3306, tcp/135, tcp/61616"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 3,
            "last_seen": 3,
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/3306, tcp/1433, tcp/22, tcp/1720, tcp/61616",
                  "critical fast RDP traffic detection"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 3,
            "last_seen": 3,
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned on tcp/80, tcp/22, tcp/1433 with SQL and web service probing"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 3,
            "last_seen": 3,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "docker:172.20.0.2:2375",
          "service": "docker",
          "host": "172.20.0.2",
          "port": "2375",
          "first_exposed_epoch": 2,
          "local_epoch": 2,
          "allowed_phase": "data-exfil"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 4,
      "start_time": 1759429556.7703004,
      "end_time": 1759429789.281321,
      "phase_timings": {
        "initialization": 1759429556.770321,
        "attack_execution": 1759429556.788268,
        "monitoring_accumulation": 1759429587.5898595,
        "agent_analysis": 1759429592.5907986,
        "firewall_update_wait": 1759429787.2605135,
        "metrics_collection": 1759429789.2614825,
        "epoch_complete": 1759429789.280543
      },
      "services_detected": [
        "HTTP(172.20.0.7:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.3 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.7           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.7"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "current_level": 33,
        "epoch": 4
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "DELETE REST attempts",
            "user-level file discovery",
            "network trojan scans returning from this honeypot to the attacker's NAT IP (tcp/4444)"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "PHP Xdebug extension exploitation attempts"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "experienced extensive scanning"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "destructive Docker API commands issued via REST calls"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "attempts to read sensitive files (\"find / -type f -name 'user.txt'\")"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "DELETE REST attempts",
                  "user-level file discovery",
                  "network trojan scans returning from this honeypot to the attacker's NAT IP (tcp/4444)"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "privilege-escalation"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/8081, tcp/3306, tcp/135, tcp/61616"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 3,
            "last_seen": 3,
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/3306, tcp/1433, tcp/22, tcp/1720, tcp/61616",
                  "critical fast RDP traffic detection"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "PHP Xdebug extension exploitation attempts"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned on tcp/80, tcp/22, tcp/1433 with SQL and web service probing"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 3,
            "last_seen": 3,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "debug_php:172.20.0.7:80",
          "service": "debug_php",
          "host": "172.20.0.7",
          "port": "80",
          "path": "http://172.20.0.7:80",
          "first_exposed_epoch": 4,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 5,
      "start_time": 1759429790.2881632,
      "end_time": 1759429895.1839705,
      "phase_timings": {
        "initialization": 1759429790.2881832,
        "attack_execution": 1759429790.3033516,
        "monitoring_accumulation": 1759429808.036151,
        "agent_analysis": 1759429813.037142,
        "firewall_update_wait": 1759429893.160332,
        "metrics_collection": 1759429895.161871,
        "epoch_complete": 1759429895.1827388
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.3:8080)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.7 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.7 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.3           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.7",
        "service": "xdebug-rce-xdebug2-1",
        "current_level": 66,
        "epoch": 5
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "Multiple exploit and privilege escalation attempts against Apache Struts (tcp/8080) using OGNL injection with Java runtime execution indications",
            "GET requests with malicious OGNL expressions",
            "java.lang.Runtime@getRuntime"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "experienced extensive scanning"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "destructive Docker API commands issued via REST calls"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "attempts to read sensitive files (\"find / -type f -name 'user.txt'\")"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "DELETE REST attempts",
                  "user-level file discovery",
                  "network trojan scans returning from this honeypot to the attacker's NAT IP (tcp/4444)"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "privilege-escalation"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/8081, tcp/3306, tcp/135, tcp/61616"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "Multiple exploit and privilege escalation attempts against Apache Struts (tcp/8080) using OGNL injection with Java runtime execution indications",
                  "GET requests with malicious OGNL expressions",
                  "java.lang.Runtime@getRuntime"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 3,
            "last_seen": 5,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/3306, tcp/1433, tcp/22, tcp/1720, tcp/61616",
                  "critical fast RDP traffic detection"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "PHP Xdebug extension exploitation attempts"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned on tcp/80, tcp/22, tcp/1433 with SQL and web service probing"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 3,
            "last_seen": 3,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "struts:172.20.0.3:8080",
          "service": "struts",
          "host": "172.20.0.3",
          "port": "8080",
          "path": "struts2-showcase",
          "first_exposed_epoch": 5,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 6,
      "start_time": 1759429896.1896048,
      "end_time": 1759430106.8176675,
      "phase_timings": {
        "initialization": 1759429896.1896198,
        "attack_execution": 1759429896.202496,
        "monitoring_accumulation": 1759429935.0549374,
        "agent_analysis": 1759429940.0560005,
        "firewall_update_wait": 1759430104.8004375,
        "metrics_collection": 1759430106.801344,
        "epoch_complete": 1759430106.816799
      },
      "services_detected": [
        "HTTP(172.20.0.7:80)"
      ],
      "services_successfully_exploited": [
        "PHP"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "PHP",
          "flag": "flag{user_access_php}"
        },
        {
          "service": "PHP",
          "flag": "flag{privileged_access_php}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.3 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.7           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.7"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "current_level": 66,
        "epoch": 6
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "Multiple exploit and privilege escalation attempts against Apache Struts (tcp/8080) using OGNL injection with Java runtime execution indications",
            "GET requests with malicious OGNL expressions",
            "java.lang.Runtime@getRuntime"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "experienced extensive scanning"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "destructive Docker API commands issued via REST calls"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "attempts to read sensitive files (\"find / -type f -name 'user.txt'\")"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "DELETE REST attempts",
                  "user-level file discovery",
                  "network trojan scans returning from this honeypot to the attacker's NAT IP (tcp/4444)"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "privilege-escalation"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/8081, tcp/3306, tcp/135, tcp/61616"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "Multiple exploit and privilege escalation attempts against Apache Struts (tcp/8080) using OGNL injection with Java runtime execution indications",
                  "GET requests with malicious OGNL expressions",
                  "java.lang.Runtime@getRuntime"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 3,
            "last_seen": 5,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/3306, tcp/1433, tcp/22, tcp/1720, tcp/61616",
                  "critical fast RDP traffic detection"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "PHP Xdebug extension exploitation attempts"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned on tcp/80, tcp/22, tcp/1433 with SQL and web service probing"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 3,
            "last_seen": 3,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "debug_php:172.20.0.7:80",
          "service": "debug_php",
          "host": "172.20.0.7",
          "port": "80",
          "path": "http://172.20.0.7:80",
          "first_exposed_epoch": 4,
          "local_epoch": 3,
          "allowed_phase": "privilege_escalation"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 7,
      "start_time": 1759430107.8238683,
      "end_time": 1759430195.105982,
      "phase_timings": {
        "initialization": 1759430107.8238885,
        "attack_execution": 1759430107.8407147,
        "monitoring_accumulation": 1759430131.613351,
        "agent_analysis": 1759430136.6141412,
        "firewall_update_wait": 1759430193.0859342,
        "metrics_collection": 1759430195.0874183,
        "epoch_complete": 1759430195.1047988
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.3:8080)"
      ],
      "services_successfully_exploited": [
        "STRUTS"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "STRUTS",
          "flag": "flag{privileged_access_struts}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.3           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 33,
        "epoch": 7
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "find / -type f -name 'root.txt'",
            "cat /root/root.txt",
            "multiple OGNL java.lang.Runtime exploit strings"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "experienced extensive scanning"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "destructive Docker API commands issued via REST calls"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "attempts to read sensitive files (\"find / -type f -name 'user.txt'\")"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "DELETE REST attempts",
                  "user-level file discovery",
                  "network trojan scans returning from this honeypot to the attacker's NAT IP (tcp/4444)"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "privilege-escalation"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/8081, tcp/3306, tcp/135, tcp/61616"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "Multiple exploit and privilege escalation attempts against Apache Struts (tcp/8080) using OGNL injection with Java runtime execution indications",
                  "GET requests with malicious OGNL expressions",
                  "java.lang.Runtime@getRuntime"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "find / -type f -name 'root.txt'",
                  "cat /root/root.txt",
                  "multiple OGNL java.lang.Runtime exploit strings"
                ],
                "seen_in_epoch": 7
              }
            ],
            "first_seen": 3,
            "last_seen": 7,
            "current_phase": "privilege-escalation"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/3306, tcp/1433, tcp/22, tcp/1720, tcp/61616",
                  "critical fast RDP traffic detection"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "PHP Xdebug extension exploitation attempts"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned on tcp/80, tcp/22, tcp/1433 with SQL and web service probing"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 3,
            "last_seen": 3,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "struts:172.20.0.3:8080",
          "service": "struts",
          "host": "172.20.0.3",
          "port": "8080",
          "path": "struts2-showcase",
          "first_exposed_epoch": 5,
          "local_epoch": 3,
          "allowed_phase": "privilege_escalation"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 8,
      "start_time": 1759430196.1143944,
      "end_time": 1759430295.170963,
      "phase_timings": {
        "initialization": 1759430196.1144154,
        "attack_execution": 1759430196.1295388,
        "monitoring_accumulation": 1759430218.0569515,
        "agent_analysis": 1759430223.0578213,
        "firewall_update_wait": 1759430293.1513486,
        "metrics_collection": 1759430295.1530707,
        "epoch_complete": 1759430295.16993
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 33,
        "epoch": 8
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "experienced extensive scanning"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "destructive Docker API commands issued via REST calls"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "attempts to read sensitive files (\"find / -type f -name 'user.txt'\")"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "DELETE REST attempts",
                  "user-level file discovery",
                  "network trojan scans returning from this honeypot to the attacker's NAT IP (tcp/4444)"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "privilege-escalation"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/8081, tcp/3306, tcp/135, tcp/61616"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "Multiple exploit and privilege escalation attempts against Apache Struts (tcp/8080) using OGNL injection with Java runtime execution indications",
                  "GET requests with malicious OGNL expressions",
                  "java.lang.Runtime@getRuntime"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "find / -type f -name 'root.txt'",
                  "cat /root/root.txt",
                  "multiple OGNL java.lang.Runtime exploit strings"
                ],
                "seen_in_epoch": 7
              }
            ],
            "first_seen": 3,
            "last_seen": 7,
            "current_phase": "privilege-escalation"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/3306, tcp/1433, tcp/22, tcp/1720, tcp/61616",
                  "critical fast RDP traffic detection"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "PHP Xdebug extension exploitation attempts"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned on tcp/80, tcp/22, tcp/1433 with SQL and web service probing"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 3,
            "last_seen": 3,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 8,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 9,
      "start_time": 1759430296.1790173,
      "end_time": 1759430383.6866024,
      "phase_timings": {
        "initialization": 1759430296.1790402,
        "attack_execution": 1759430296.1952612,
        "monitoring_accumulation": 1759430323.838581,
        "agent_analysis": 1759430328.8399029,
        "firewall_update_wait": 1759430381.6699626,
        "metrics_collection": 1759430383.6715436,
        "epoch_complete": 1759430383.6857557
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{user_access_gitlab}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 33,
        "epoch": 9
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "experienced extensive scanning"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "destructive Docker API commands issued via REST calls"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "attempts to read sensitive files (\"find / -type f -name 'user.txt'\")"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "DELETE REST attempts",
                  "user-level file discovery",
                  "network trojan scans returning from this honeypot to the attacker's NAT IP (tcp/4444)"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "privilege-escalation"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/8081, tcp/3306, tcp/135, tcp/61616"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "Multiple exploit and privilege escalation attempts against Apache Struts (tcp/8080) using OGNL injection with Java runtime execution indications",
                  "GET requests with malicious OGNL expressions",
                  "java.lang.Runtime@getRuntime"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "find / -type f -name 'root.txt'",
                  "cat /root/root.txt",
                  "multiple OGNL java.lang.Runtime exploit strings"
                ],
                "seen_in_epoch": 7
              }
            ],
            "first_seen": 3,
            "last_seen": 7,
            "current_phase": "privilege-escalation"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/3306, tcp/1433, tcp/22, tcp/1720, tcp/61616",
                  "critical fast RDP traffic detection"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "PHP Xdebug extension exploitation attempts"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned on tcp/80, tcp/22, tcp/1433 with SQL and web service probing"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 3,
            "last_seen": 3,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 8,
          "local_epoch": 2,
          "allowed_phase": "data-exfil"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 10,
      "start_time": 1759430384.6936016,
      "end_time": 1759430471.3536363,
      "phase_timings": {
        "initialization": 1759430384.6936293,
        "attack_execution": 1759430384.7091045,
        "monitoring_accumulation": 1759430418.3890705,
        "agent_analysis": 1759430423.3899167,
        "firewall_update_wait": 1759430469.3317943,
        "metrics_collection": 1759430471.3350081,
        "epoch_complete": 1759430471.3526099
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{privileged_access_gitlab}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "none",
        "service": "none",
        "current_level": 100,
        "epoch": 10
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "Reverse Shell Detected - No Job Control",
            "bash-4.4$ cat /home/ctf/user.txt",
            "flag{user_access_gitlab}",
            "Privilege Escalation Attempt - bash -p",
            "SUID Binary Enumeration Detected",
            "bash-4.4$ cat /root/root.txt"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "experienced extensive scanning"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "destructive Docker API commands issued via REST calls"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "attempts to read sensitive files (\"find / -type f -name 'user.txt'\")"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "DELETE REST attempts",
                  "user-level file discovery",
                  "network trojan scans returning from this honeypot to the attacker's NAT IP (tcp/4444)"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "privilege-escalation"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/8081, tcp/3306, tcp/135, tcp/61616"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "Multiple exploit and privilege escalation attempts against Apache Struts (tcp/8080) using OGNL injection with Java runtime execution indications",
                  "GET requests with malicious OGNL expressions",
                  "java.lang.Runtime@getRuntime"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "find / -type f -name 'root.txt'",
                  "cat /root/root.txt",
                  "multiple OGNL java.lang.Runtime exploit strings"
                ],
                "seen_in_epoch": 7
              }
            ],
            "first_seen": 3,
            "last_seen": 7,
            "current_phase": "privilege-escalation"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "scanned ... tcp/3306, tcp/1433, tcp/22, tcp/1720, tcp/61616",
                  "critical fast RDP traffic detection"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "PHP Xdebug extension exploitation attempts"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "data-exfil-root",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)"
                ],
                "seen_in_epoch": 10
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "Reverse Shell Detected - No Job Control"
                ],
                "seen_in_epoch": 10
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "bash-4.4$ cat /home/ctf/user.txt",
                  "flag{user_access_gitlab}"
                ],
                "seen_in_epoch": 10
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "SUID Binary Enumeration Detected"
                ],
                "seen_in_epoch": 10
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "bash-4.4$ cat /root/root.txt"
                ],
                "seen_in_epoch": 10
              }
            ],
            "first_seen": 10,
            "last_seen": 10,
            "current_phase": "data-exfil-root"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 8,
          "local_epoch": 3,
          "allowed_phase": "privilege_escalation"
        }
      ],
      "lockdown_activated": true
    }
  ],
  "summary": {
    "total_flags_captured": 6,
    "average_epoch_duration": 112.9752227306366,
    "lockdown_triggered": true,
    "lockdown_epoch": 10,
    "final_honeypots_exploitation": [
      {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.7",
        "service": "xdebug-rce-xdebug2-1",
        "level_prev": 66,
        "level_new": 66,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "level_prev": 33,
        "level_new": 100,
        "changed": true,
        "evidence_quotes": [
          "Reverse Shell Detected - No Job Control",
          "bash-4.4$ cat /home/ctf/user.txt",
          "flag{user_access_gitlab}",
          "Privilege Escalation Attempt - bash -p",
          "SUID Binary Enumeration Detected",
          "bash-4.4$ cat /root/root.txt"
        ]
      }
    ],
    "final_inferred_attack_graph": {
      "interesting": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1"
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1"
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1"
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy"
        }
      ],
      "edges": [
        {
          "from": "192.168.100.2",
          "to": "172.20.0.2",
          "edge_id": "",
          "vector": "privilege-escalation",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "experienced extensive scanning"
              ],
              "seen_in_epoch": 3
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "destructive Docker API commands issued via REST calls"
              ],
              "seen_in_epoch": 3
            },
            {
              "phase": "data-exfil-user",
              "evidence_quotes": [
                "User-Level File Discovery",
                "attempts to read sensitive files (\"find / -type f -name 'user.txt'\")"
              ],
              "seen_in_epoch": 3
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "DELETE REST attempts",
                "user-level file discovery",
                "network trojan scans returning from this honeypot to the attacker's NAT IP (tcp/4444)"
              ],
              "seen_in_epoch": 4
            }
          ],
          "first_seen": 3,
          "last_seen": 4,
          "current_phase": "privilege-escalation"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.3",
          "edge_id": "",
          "vector": "privilege-escalation",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "scanned ... tcp/8081, tcp/3306, tcp/135, tcp/61616"
              ],
              "seen_in_epoch": 3
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "Multiple exploit and privilege escalation attempts against Apache Struts (tcp/8080) using OGNL injection with Java runtime execution indications",
                "GET requests with malicious OGNL expressions",
                "java.lang.Runtime@getRuntime"
              ],
              "seen_in_epoch": 5
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "find / -type f -name 'root.txt'",
                "cat /root/root.txt",
                "multiple OGNL java.lang.Runtime exploit strings"
              ],
              "seen_in_epoch": 7
            }
          ],
          "first_seen": 3,
          "last_seen": 7,
          "current_phase": "privilege-escalation"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.7",
          "edge_id": "",
          "vector": "initial-access/rce",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "scanned ... tcp/3306, tcp/1433, tcp/22, tcp/1720, tcp/61616",
                "critical fast RDP traffic detection"
              ],
              "seen_in_epoch": 3
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "PHP Xdebug extension exploitation attempts"
              ],
              "seen_in_epoch": 4
            }
          ],
          "first_seen": 3,
          "last_seen": 4,
          "current_phase": "initial-access/rce"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.10",
          "edge_id": "",
          "vector": "data-exfil-root",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS)"
              ],
              "seen_in_epoch": 10
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "Reverse Shell Detected - No Job Control"
              ],
              "seen_in_epoch": 10
            },
            {
              "phase": "data-exfil-user",
              "evidence_quotes": [
                "bash-4.4$ cat /home/ctf/user.txt",
                "flag{user_access_gitlab}"
              ],
              "seen_in_epoch": 10
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "Privilege Escalation Attempt - bash -p",
                "SUID Binary Enumeration Detected"
              ],
              "seen_in_epoch": 10
            },
            {
              "phase": "data-exfil-root",
              "evidence_quotes": [
                "bash-4.4$ cat /root/root.txt"
              ],
              "seen_in_epoch": 10
            }
          ],
          "first_seen": 10,
          "last_seen": 10,
          "current_phase": "data-exfil-root"
        }
      ]
    }
  }
}