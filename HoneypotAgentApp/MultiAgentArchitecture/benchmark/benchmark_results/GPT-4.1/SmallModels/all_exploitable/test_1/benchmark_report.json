{
  "config": {
    "max_epochs": 15,
    "attacker_image": "attacker:latest",
    "attacker_container_name": "attackercontainer-attacker",
    "attack_duration": 240,
    "monitor_accumulation_wait": 5,
    "firewall_update_wait": 2,
    "between_epoch_wait": 1,
    "attacker_network": "192.168.100.0/24",
    "honeypot_network": "172.20.0.0/24",
    "firewall_api_url": "http://192.168.200.2:5000",
    "allow_full_compromise": true,
    "stop_on_lockdown": true,
    "clear_memory_between_epochs": false,
    "results_dir": "./benchmark/benchmark_results",
    "dir_name": "all_exploitable_small",
    "save_detailed_logs": true,
    "log_level": "INFO"
  },
  "start_time": 1757771512.3649344,
  "end_time": 1757772434.619543,
  "total_epochs": 10,
  "epochs": [
    {
      "epoch_number": 1,
      "start_time": 1757771512.3649344,
      "end_time": 1757771595.0759308,
      "phase_timings": {
        "initialization": 1757771512.3649561,
        "attack_execution": 1757771512.3764496,
        "monitoring_accumulation": 1757771543.287999,
        "agent_analysis": 1757771548.288563,
        "firewall_update_wait": 1757771593.0533087,
        "metrics_collection": 1757771595.0546489,
        "epoch_complete": 1757771595.0747776
      },
      "services_detected": [
        "HTTP(172.20.0.7:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2:2375 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.2 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2:2376 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.7           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.7"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "current_level": 33,
        "epoch": 1
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS) on multiple ports including tcp/80, tcp/138, tcp/139, tcp/143, tcp/465, tcp/465, tcp/3306, tcp/2375",
            "ET SCAN Suspicious inbound traffic on tcp/3306 and tcp/1433"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "multiple ET INFO PHP Xdebug Extension Query Parameter (XDEBUG_SESSION_START) requests seen indicating attempts to trigger debug code execution (evidence: \"GET /index.php?XDEBUG_SESSION_START=phpstorm&XDEBUG_SESSION=1&XDEBUG_TRIGGER=1 HTTP/1.1\")"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "ET SCAN Suspicious inbound to MSSQL tcp/1433 noted; multiple port scans on tcp/587 and tcp/1433"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "Seen port scans tcp/8081 and ET SCAN Suspicious inbound to mysql tcp/3306; multiple POSSBL PORT SCAN (NMAP -sS) on tcp/8081"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on multiple ports including tcp/80, tcp/138, tcp/139, tcp/143, tcp/465, tcp/465, tcp/3306, tcp/2375",
                  "ET SCAN Suspicious inbound traffic on tcp/3306 and tcp/1433"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on tcp/80, tcp/138, tcp/139, tcp/2375, tcp/443",
                  "ET SCAN Suspicious inbound to mysql port tcp/3306 and MSSQL tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple ET INFO PHP Xdebug Extension Query Parameter (XDEBUG_SESSION_START) requests seen indicating attempts to trigger debug code execution (evidence: \"GET /index.php?XDEBUG_SESSION_START=phpstorm&XDEBUG_SESSION=1&XDEBUG_TRIGGER=1 HTTP/1.1\")"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL tcp/1433 noted; multiple port scans on tcp/587 and tcp/1433"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "Seen port scans tcp/8081 and ET SCAN Suspicious inbound to mysql tcp/3306; multiple POSSBL PORT SCAN (NMAP -sS) on tcp/8081"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          }
        ],
        "edge_updates": [
          {
            "edge_id": "",
            "edge_id_hint": "192.168.100.2->172.20.0.2",
            "added_phases": [
              "scan"
            ],
            "seen_in_epoch": 1
          },
          {
            "edge_id": "",
            "edge_id_hint": "192.168.100.2->172.20.0.7",
            "added_phases": [
              "scan",
              "initial-access/rce"
            ],
            "seen_in_epoch": 1
          },
          {
            "edge_id": "",
            "edge_id_hint": "192.168.100.2->172.20.0.3",
            "added_phases": [
              "scan"
            ],
            "seen_in_epoch": 1
          },
          {
            "edge_id": "",
            "edge_id_hint": "192.168.100.2->172.20.0.10",
            "added_phases": [
              "scan"
            ],
            "seen_in_epoch": 1
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "debug_php:172.20.0.7:80",
          "service": "debug_php",
          "host": "172.20.0.7",
          "port": "80",
          "path": "http://172.20.0.7:80",
          "first_exposed_epoch": 1,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 2,
      "start_time": 1757771596.0908213,
      "end_time": 1757771662.8620577,
      "phase_timings": {
        "initialization": 1757771596.0908623,
        "attack_execution": 1757771596.1093192,
        "monitoring_accumulation": 1757771615.4859054,
        "agent_analysis": 1757771620.4871726,
        "firewall_update_wait": 1757771660.8353977,
        "metrics_collection": 1757771662.8372867,
        "epoch_complete": 1757771662.860857
      },
      "services_detected": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "current_level": 66,
        "epoch": 2
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "multiple new GPL WEB_SERVER DELETE attempts via Docker remote API (tcp/2375) with payload evidence of docker-sdk-python commands indicating exploitation attempts"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on multiple ports including tcp/80, tcp/138, tcp/139, tcp/143, tcp/465, tcp/465, tcp/3306, tcp/2375",
                  "ET SCAN Suspicious inbound traffic on tcp/3306 and tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple new GPL WEB_SERVER DELETE attempts via Docker remote API (tcp/2375) with payload evidence of docker-sdk-python commands indicating exploitation attempts"
                ],
                "seen_in_epoch": 2
              }
            ],
            "first_seen": 1,
            "last_seen": 2,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on tcp/80, tcp/138, tcp/139, tcp/2375, tcp/443",
                  "ET SCAN Suspicious inbound to mysql port tcp/3306 and MSSQL tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple ET INFO PHP Xdebug Extension Query Parameter (XDEBUG_SESSION_START) requests seen indicating attempts to trigger debug code execution (evidence: \"GET /index.php?XDEBUG_SESSION_START=phpstorm&XDEBUG_SESSION=1&XDEBUG_TRIGGER=1 HTTP/1.1\")"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL tcp/1433 noted; multiple port scans on tcp/587 and tcp/1433"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "Seen port scans tcp/8081 and ET SCAN Suspicious inbound to mysql tcp/3306; multiple POSSBL PORT SCAN (NMAP -sS) on tcp/8081"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          }
        ],
        "edge_updates": [
          {
            "edge_id": "",
            "edge_id_hint": "192.168.100.2->172.20.0.2",
            "added_phases": [
              "initial-access/rce"
            ],
            "seen_in_epoch": 2
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "docker:172.20.0.2:2375",
          "service": "docker",
          "host": "172.20.0.2",
          "port": "2375",
          "first_exposed_epoch": 2,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 3,
      "start_time": 1757771663.8696647,
      "end_time": 1757771736.988305,
      "phase_timings": {
        "initialization": 1757771663.8696988,
        "attack_execution": 1757771663.8861678,
        "monitoring_accumulation": 1757771690.8319952,
        "agent_analysis": 1757771695.8326783,
        "firewall_update_wait": 1757771734.968101,
        "metrics_collection": 1757771736.969581,
        "epoch_complete": 1757771736.9873328
      },
      "services_detected": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "services_successfully_exploited": [
        "DOCKER"
      ],
      "exploits_attempted": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "flags_captured": [
        {
          "service": "DOCKER",
          "flag": "flag{docker}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10:80 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.2           tcp dpt:2376",
            "REMOVED rule #2:    ACCEPT     tcp  --  172.20.0.2           192.168.100.0/24",
            "REMOVED rule #3:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.2           tcp dpt:2375"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 33,
        "epoch": 3
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on multiple ports including tcp/80, tcp/138, tcp/139, tcp/143, tcp/465, tcp/465, tcp/3306, tcp/2375",
                  "ET SCAN Suspicious inbound traffic on tcp/3306 and tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple new GPL WEB_SERVER DELETE attempts via Docker remote API (tcp/2375) with payload evidence of docker-sdk-python commands indicating exploitation attempts"
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "New User-Level File Discovery attempts detected on tcp/32907 with payload \"find / -type f -name 'user.txt'...\" indicating data access attempts"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on tcp/80, tcp/138, tcp/139, tcp/2375, tcp/443",
                  "ET SCAN Suspicious inbound to mysql port tcp/3306 and MSSQL tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple ET INFO PHP Xdebug Extension Query Parameter (XDEBUG_SESSION_START) requests seen indicating attempts to trigger debug code execution (evidence: \"GET /index.php?XDEBUG_SESSION_START=phpstorm&XDEBUG_SESSION=1&XDEBUG_TRIGGER=1 HTTP/1.1\")"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL tcp/1433 noted; multiple port scans on tcp/587 and tcp/1433"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "Seen port scans tcp/8081 and ET SCAN Suspicious inbound to mysql tcp/3306; multiple POSSBL PORT SCAN (NMAP -sS) on tcp/8081"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          }
        ],
        "edge_updates": [
          {
            "edge_id": "",
            "edge_id_hint": "192.168.100.2->172.20.0.2",
            "added_phases": [
              "data-exfil-user"
            ],
            "seen_in_epoch": 3
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "docker:172.20.0.2:2375",
          "service": "docker",
          "host": "172.20.0.2",
          "port": "2375",
          "first_exposed_epoch": 2,
          "local_epoch": 2,
          "allowed_phase": "data-exfil"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 4,
      "start_time": 1757771737.9969742,
      "end_time": 1757771798.1249979,
      "phase_timings": {
        "initialization": 1757771737.9970038,
        "attack_execution": 1757771738.01196,
        "monitoring_accumulation": 1757771760.091842,
        "agent_analysis": 1757771765.0930424,
        "firewall_update_wait": 1757771796.1055942,
        "metrics_collection": 1757771798.1070714,
        "epoch_complete": 1757771798.124256
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 33,
        "epoch": 4
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on multiple ports including tcp/80, tcp/138, tcp/139, tcp/143, tcp/465, tcp/465, tcp/3306, tcp/2375",
                  "ET SCAN Suspicious inbound traffic on tcp/3306 and tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple new GPL WEB_SERVER DELETE attempts via Docker remote API (tcp/2375) with payload evidence of docker-sdk-python commands indicating exploitation attempts"
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "New User-Level File Discovery attempts detected on tcp/32907 with payload \"find / -type f -name 'user.txt'...\" indicating data access attempts"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on tcp/80, tcp/138, tcp/139, tcp/2375, tcp/443",
                  "ET SCAN Suspicious inbound to mysql port tcp/3306 and MSSQL tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple ET INFO PHP Xdebug Extension Query Parameter (XDEBUG_SESSION_START) requests seen indicating attempts to trigger debug code execution (evidence: \"GET /index.php?XDEBUG_SESSION_START=phpstorm&XDEBUG_SESSION=1&XDEBUG_TRIGGER=1 HTTP/1.1\")"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL tcp/1433 noted; multiple port scans on tcp/587 and tcp/1433"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "Seen port scans tcp/8081 and ET SCAN Suspicious inbound to mysql tcp/3306; multiple POSSBL PORT SCAN (NMAP -sS) on tcp/8081"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          }
        ],
        "edge_updates": []
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 4,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 5,
      "start_time": 1757771799.132224,
      "end_time": 1757771902.9631805,
      "phase_timings": {
        "initialization": 1757771799.1322494,
        "attack_execution": 1757771799.1471758,
        "monitoring_accumulation": 1757771826.9118137,
        "agent_analysis": 1757771831.9126241,
        "firewall_update_wait": 1757771900.945631,
        "metrics_collection": 1757771902.9468155,
        "epoch_complete": 1757771902.9620779
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{user_access_gitlab}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 66,
        "epoch": 5
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3",
            "find / -type f -name 'user.txt' 2>/dev/null",
            "cat /home/ctf/user.txt"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on multiple ports including tcp/80, tcp/138, tcp/139, tcp/143, tcp/465, tcp/465, tcp/3306, tcp/2375",
                  "ET SCAN Suspicious inbound traffic on tcp/3306 and tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple new GPL WEB_SERVER DELETE attempts via Docker remote API (tcp/2375) with payload evidence of docker-sdk-python commands indicating exploitation attempts"
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "New User-Level File Discovery attempts detected on tcp/32907 with payload \"find / -type f -name 'user.txt'...\" indicating data access attempts"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on tcp/80, tcp/138, tcp/139, tcp/2375, tcp/443",
                  "ET SCAN Suspicious inbound to mysql port tcp/3306 and MSSQL tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple ET INFO PHP Xdebug Extension Query Parameter (XDEBUG_SESSION_START) requests seen indicating attempts to trigger debug code execution (evidence: \"GET /index.php?XDEBUG_SESSION_START=phpstorm&XDEBUG_SESSION=1&XDEBUG_TRIGGER=1 HTTP/1.1\")"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL tcp/1433 noted; multiple port scans on tcp/587 and tcp/1433"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "Seen port scans tcp/8081 and ET SCAN Suspicious inbound to mysql tcp/3306; multiple POSSBL PORT SCAN (NMAP -sS) on tcp/8081"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "find / -type f -name 'user.txt' 2>/dev/null",
                  "cat /home/ctf/user.txt"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 1,
            "last_seen": 5,
            "current_phase": "data-exfil-user"
          }
        ],
        "edge_updates": [
          {
            "edge_id": "",
            "edge_id_hint": "192.168.100.2->172.20.0.10",
            "added_phases": [
              "initial-access/rce",
              "data-exfil-user"
            ],
            "seen_in_epoch": 5
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 4,
          "local_epoch": 2,
          "allowed_phase": "data-exfil"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 6,
      "start_time": 1757771903.970954,
      "end_time": 1757771991.2599862,
      "phase_timings": {
        "initialization": 1757771903.9709716,
        "attack_execution": 1757771903.9848533,
        "monitoring_accumulation": 1757771938.6678233,
        "agent_analysis": 1757771943.6691103,
        "firewall_update_wait": 1757771989.2306492,
        "metrics_collection": 1757771991.2319908,
        "epoch_complete": 1757771991.2590516
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{privileged_access_gitlab}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3:8080 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.3 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10          tcp dpt:80"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "current_level": 33,
        "epoch": 6
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 66,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "/bin/bash -p",
            "cat /root/root.txt",
            "find / -perm -4000 -type f 2>/dev/null"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on multiple ports including tcp/80, tcp/138, tcp/139, tcp/143, tcp/465, tcp/465, tcp/3306, tcp/2375",
                  "ET SCAN Suspicious inbound traffic on tcp/3306 and tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple new GPL WEB_SERVER DELETE attempts via Docker remote API (tcp/2375) with payload evidence of docker-sdk-python commands indicating exploitation attempts"
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "New User-Level File Discovery attempts detected on tcp/32907 with payload \"find / -type f -name 'user.txt'...\" indicating data access attempts"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on tcp/80, tcp/138, tcp/139, tcp/2375, tcp/443",
                  "ET SCAN Suspicious inbound to mysql port tcp/3306 and MSSQL tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple ET INFO PHP Xdebug Extension Query Parameter (XDEBUG_SESSION_START) requests seen indicating attempts to trigger debug code execution (evidence: \"GET /index.php?XDEBUG_SESSION_START=phpstorm&XDEBUG_SESSION=1&XDEBUG_TRIGGER=1 HTTP/1.1\")"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL tcp/1433 noted; multiple port scans on tcp/587 and tcp/1433"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "Seen port scans tcp/8081 and ET SCAN Suspicious inbound to mysql tcp/3306; multiple POSSBL PORT SCAN (NMAP -sS) on tcp/8081"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "find / -type f -name 'user.txt' 2>/dev/null",
                  "cat /home/ctf/user.txt"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "/bin/bash -p",
                  "cat /root/root.txt",
                  "find / -perm -4000 -type f 2>/dev/null"
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 1,
            "last_seen": 6,
            "current_phase": "privilege-escalation"
          }
        ],
        "edge_updates": [
          {
            "edge_id": "",
            "edge_id_hint": "192.168.100.2->172.20.0.10",
            "added_phases": [
              "privilege-escalation"
            ],
            "seen_in_epoch": 6
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 4,
          "local_epoch": 3,
          "allowed_phase": "privilege_escalation"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 7,
      "start_time": 1757771992.2676232,
      "end_time": 1757772087.6205573,
      "phase_timings": {
        "initialization": 1757771992.2676492,
        "attack_execution": 1757771992.2885683,
        "monitoring_accumulation": 1757772010.347404,
        "agent_analysis": 1757772015.3483903,
        "firewall_update_wait": 1757772085.5934336,
        "metrics_collection": 1757772087.5947495,
        "epoch_complete": 1757772087.6197019
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.3:8080)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "current_level": 66,
        "epoch": 7
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
            "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
            "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on multiple ports including tcp/80, tcp/138, tcp/139, tcp/143, tcp/465, tcp/465, tcp/3306, tcp/2375",
                  "ET SCAN Suspicious inbound traffic on tcp/3306 and tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple new GPL WEB_SERVER DELETE attempts via Docker remote API (tcp/2375) with payload evidence of docker-sdk-python commands indicating exploitation attempts"
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "New User-Level File Discovery attempts detected on tcp/32907 with payload \"find / -type f -name 'user.txt'...\" indicating data access attempts"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on tcp/80, tcp/138, tcp/139, tcp/2375, tcp/443",
                  "ET SCAN Suspicious inbound to mysql port tcp/3306 and MSSQL tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple ET INFO PHP Xdebug Extension Query Parameter (XDEBUG_SESSION_START) requests seen indicating attempts to trigger debug code execution (evidence: \"GET /index.php?XDEBUG_SESSION_START=phpstorm&XDEBUG_SESSION=1&XDEBUG_TRIGGER=1 HTTP/1.1\")"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL tcp/1433 noted; multiple port scans on tcp/587 and tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
                ],
                "seen_in_epoch": 7
              }
            ],
            "first_seen": 1,
            "last_seen": 7,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "Seen port scans tcp/8081 and ET SCAN Suspicious inbound to mysql tcp/3306; multiple POSSBL PORT SCAN (NMAP -sS) on tcp/8081"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "find / -type f -name 'user.txt' 2>/dev/null",
                  "cat /home/ctf/user.txt"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "/bin/bash -p",
                  "cat /root/root.txt",
                  "find / -perm -4000 -type f 2>/dev/null"
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 1,
            "last_seen": 6,
            "current_phase": "privilege-escalation"
          }
        ],
        "edge_updates": [
          {
            "edge_id": "",
            "edge_id_hint": "192.168.100.2->172.20.0.3",
            "added_phases": [
              "initial-access/rce"
            ],
            "seen_in_epoch": 7
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "struts:172.20.0.3:8080",
          "service": "struts",
          "host": "172.20.0.3",
          "port": "8080",
          "path": "struts2-showcase",
          "first_exposed_epoch": 7,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 8,
      "start_time": 1757772088.6254916,
      "end_time": 1757772190.1885831,
      "phase_timings": {
        "initialization": 1757772088.6255178,
        "attack_execution": 1757772088.646329,
        "monitoring_accumulation": 1757772112.8798373,
        "agent_analysis": 1757772117.8814316,
        "firewall_update_wait": 1757772188.1602259,
        "metrics_collection": 1757772190.1632204,
        "epoch_complete": 1757772190.1875598
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.3:8080)"
      ],
      "services_successfully_exploited": [
        "STRUTS"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "STRUTS",
          "flag": "flag{privileged_access_struts}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.7:80 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.7 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.3           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3           tcp dpt:8080"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.7",
        "service": "xdebug-rce-xdebug2-1",
        "current_level": 66,
        "epoch": 8
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on multiple ports including tcp/80, tcp/138, tcp/139, tcp/143, tcp/465, tcp/465, tcp/3306, tcp/2375",
                  "ET SCAN Suspicious inbound traffic on tcp/3306 and tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple new GPL WEB_SERVER DELETE attempts via Docker remote API (tcp/2375) with payload evidence of docker-sdk-python commands indicating exploitation attempts"
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "New User-Level File Discovery attempts detected on tcp/32907 with payload \"find / -type f -name 'user.txt'...\" indicating data access attempts"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on tcp/80, tcp/138, tcp/139, tcp/2375, tcp/443",
                  "ET SCAN Suspicious inbound to mysql port tcp/3306 and MSSQL tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple ET INFO PHP Xdebug Extension Query Parameter (XDEBUG_SESSION_START) requests seen indicating attempts to trigger debug code execution (evidence: \"GET /index.php?XDEBUG_SESSION_START=phpstorm&XDEBUG_SESSION=1&XDEBUG_TRIGGER=1 HTTP/1.1\")"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL tcp/1433 noted; multiple port scans on tcp/587 and tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
                ],
                "seen_in_epoch": 7
              }
            ],
            "first_seen": 1,
            "last_seen": 7,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "Seen port scans tcp/8081 and ET SCAN Suspicious inbound to mysql tcp/3306; multiple POSSBL PORT SCAN (NMAP -sS) on tcp/8081"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "find / -type f -name 'user.txt' 2>/dev/null",
                  "cat /home/ctf/user.txt"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "/bin/bash -p",
                  "cat /root/root.txt",
                  "find / -perm -4000 -type f 2>/dev/null"
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 1,
            "last_seen": 6,
            "current_phase": "privilege-escalation"
          }
        ],
        "edge_updates": []
      },
      "service_epoch_context": [
        {
          "service_id": "struts:172.20.0.3:8080",
          "service": "struts",
          "host": "172.20.0.3",
          "port": "8080",
          "path": "struts2-showcase",
          "first_exposed_epoch": 7,
          "local_epoch": 2,
          "allowed_phase": "data-exfil"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 9,
      "start_time": 1757772191.1947372,
      "end_time": 1757772331.5261507,
      "phase_timings": {
        "initialization": 1757772191.194768,
        "attack_execution": 1757772191.2160408,
        "monitoring_accumulation": 1757772230.844275,
        "agent_analysis": 1757772235.8458054,
        "firewall_update_wait": 1757772329.5021567,
        "metrics_collection": 1757772331.504646,
        "epoch_complete": 1757772331.5250497
      },
      "services_detected": [
        "HTTP(172.20.0.7:80)"
      ],
      "services_successfully_exploited": [
        "PHP"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "PHP",
          "flag": "flag{user_access_php}"
        },
        {
          "service": "PHP",
          "flag": "flag{privileged_access_php}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2:2375 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2:2376 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.2 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.7           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.7           tcp dpt:80"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "current_level": 66,
        "epoch": 9
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "find / -perm -4000 2>/dev/null",
            "find . -exec /bin/bash -p \\; -quit",
            "cat /root/root.txt"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "cat /root/root.txt",
            "flag{privileged_access_struts}",
            "bash: no job control in this shell",
            "Reverse Shell Detected - No Job Control"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on multiple ports including tcp/80, tcp/138, tcp/139, tcp/143, tcp/465, tcp/465, tcp/3306, tcp/2375",
                  "ET SCAN Suspicious inbound traffic on tcp/3306 and tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple new GPL WEB_SERVER DELETE attempts via Docker remote API (tcp/2375) with payload evidence of docker-sdk-python commands indicating exploitation attempts"
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "New User-Level File Discovery attempts detected on tcp/32907 with payload \"find / -type f -name 'user.txt'...\" indicating data access attempts"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "data-exfil-root",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on tcp/80, tcp/138, tcp/139, tcp/2375, tcp/443",
                  "ET SCAN Suspicious inbound to mysql port tcp/3306 and MSSQL tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple ET INFO PHP Xdebug Extension Query Parameter (XDEBUG_SESSION_START) requests seen indicating attempts to trigger debug code execution (evidence: \"GET /index.php?XDEBUG_SESSION_START=phpstorm&XDEBUG_SESSION=1&XDEBUG_TRIGGER=1 HTTP/1.1\")"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "find / -perm -4000 2>/dev/null",
                  "find . -exec /bin/bash -p \\; -quit"
                ],
                "seen_in_epoch": 9
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "cat /root/root.txt"
                ],
                "seen_in_epoch": 9
              }
            ],
            "first_seen": 1,
            "last_seen": 9,
            "current_phase": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "data-exfil-root",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL tcp/1433 noted; multiple port scans on tcp/587 and tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
                ],
                "seen_in_epoch": 7
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "cat /root/root.txt",
                  "flag{privileged_access_struts}",
                  "bash: no job control in this shell",
                  "Reverse Shell Detected - No Job Control"
                ],
                "seen_in_epoch": 9
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "cat /root/root.txt",
                  "flag{privileged_access_struts}"
                ],
                "seen_in_epoch": 9
              }
            ],
            "first_seen": 1,
            "last_seen": 9,
            "current_phase": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "Seen port scans tcp/8081 and ET SCAN Suspicious inbound to mysql tcp/3306; multiple POSSBL PORT SCAN (NMAP -sS) on tcp/8081"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "find / -type f -name 'user.txt' 2>/dev/null",
                  "cat /home/ctf/user.txt"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "/bin/bash -p",
                  "cat /root/root.txt",
                  "find / -perm -4000 -type f 2>/dev/null"
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 1,
            "last_seen": 6,
            "current_phase": "privilege-escalation"
          }
        ],
        "edge_updates": [
          {
            "edge_id": "",
            "edge_id_hint": "192.168.100.2->172.20.0.3",
            "added_phases": [
              "privilege-escalation",
              "data-exfil-root"
            ],
            "seen_in_epoch": 9
          },
          {
            "edge_id": "",
            "edge_id_hint": "192.168.100.2->172.20.0.7",
            "added_phases": [
              "privilege-escalation",
              "data-exfil-root"
            ],
            "seen_in_epoch": 9
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "debug_php:172.20.0.7:80",
          "service": "debug_php",
          "host": "172.20.0.7",
          "port": "80",
          "path": "http://172.20.0.7:80",
          "first_exposed_epoch": 1,
          "local_epoch": 9,
          "allowed_phase": "privilege_escalation"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 10,
      "start_time": 1757772332.5352378,
      "end_time": 1757772434.619543,
      "phase_timings": {
        "initialization": 1757772332.5352616,
        "attack_execution": 1757772332.55133,
        "monitoring_accumulation": 1757772359.9101732,
        "agent_analysis": 1757772364.911203,
        "firewall_update_wait": 1757772432.5991135,
        "metrics_collection": 1757772434.6004074,
        "epoch_complete": 1757772434.6185913
      },
      "services_detected": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "services_successfully_exploited": [
        "DOCKER"
      ],
      "exploits_attempted": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "flags_captured": [
        {
          "service": "DOCKER",
          "flag": "flag{docker}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.2           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.2           tcp dpt:2376",
            "REMOVED rule #3:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.2           tcp dpt:2375"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "none",
        "service": "none",
        "current_level": 100,
        "epoch": 10
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "find / -perm -4000 2>/dev/null",
            "find . -exec /bin/bash -p \\; -quit",
            "cat /root/root.txt"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "cat /root/root.txt",
            "flag{privileged_access_struts}",
            "bash: no job control in this shell",
            "Reverse Shell Detected - No Job Control"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on multiple ports including tcp/80, tcp/138, tcp/139, tcp/143, tcp/465, tcp/465, tcp/3306, tcp/2375",
                  "ET SCAN Suspicious inbound traffic on tcp/3306 and tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple new GPL WEB_SERVER DELETE attempts via Docker remote API (tcp/2375) with payload evidence of docker-sdk-python commands indicating exploitation attempts"
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "New User-Level File Discovery attempts detected on tcp/32907 with payload \"find / -type f -name 'user.txt'...\" indicating data access attempts"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "data-exfil-root",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) on tcp/80, tcp/138, tcp/139, tcp/2375, tcp/443",
                  "ET SCAN Suspicious inbound to mysql port tcp/3306 and MSSQL tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "multiple ET INFO PHP Xdebug Extension Query Parameter (XDEBUG_SESSION_START) requests seen indicating attempts to trigger debug code execution (evidence: \"GET /index.php?XDEBUG_SESSION_START=phpstorm&XDEBUG_SESSION=1&XDEBUG_TRIGGER=1 HTTP/1.1\")"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "find / -perm -4000 2>/dev/null",
                  "find . -exec /bin/bash -p \\; -quit"
                ],
                "seen_in_epoch": 9
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "cat /root/root.txt"
                ],
                "seen_in_epoch": 9
              }
            ],
            "first_seen": 1,
            "last_seen": 9,
            "current_phase": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "data-exfil-root",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL tcp/1433 noted; multiple port scans on tcp/587 and tcp/1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
                ],
                "seen_in_epoch": 7
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "cat /root/root.txt",
                  "flag{privileged_access_struts}",
                  "bash: no job control in this shell",
                  "Reverse Shell Detected - No Job Control"
                ],
                "seen_in_epoch": 9
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "cat /root/root.txt",
                  "flag{privileged_access_struts}"
                ],
                "seen_in_epoch": 9
              }
            ],
            "first_seen": 1,
            "last_seen": 9,
            "current_phase": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "Seen port scans tcp/8081 and ET SCAN Suspicious inbound to mysql tcp/3306; multiple POSSBL PORT SCAN (NMAP -sS) on tcp/8081"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "find / -type f -name 'user.txt' 2>/dev/null",
                  "cat /home/ctf/user.txt"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "/bin/bash -p",
                  "cat /root/root.txt",
                  "find / -perm -4000 -type f 2>/dev/null"
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 1,
            "last_seen": 6,
            "current_phase": "privilege-escalation"
          }
        ],
        "edge_updates": []
      },
      "service_epoch_context": [
        {
          "service_id": "docker:172.20.0.2:2375",
          "service": "docker",
          "host": "172.20.0.2",
          "port": "2375",
          "first_exposed_epoch": 2,
          "local_epoch": 9,
          "allowed_phase": "privilege_escalation"
        }
      ],
      "lockdown_activated": true
    }
  ],
  "summary": {
    "total_flags_captured": 7,
    "average_epoch_duration": 91.31806299686431,
    "lockdown_triggered": true,
    "lockdown_epoch": 10,
    "final_honeypots_exploitation": [
      {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "level_prev": 66,
        "level_new": 66,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.7",
        "service": "xdebug-rce-xdebug2-1",
        "level_prev": 66,
        "level_new": 100,
        "changed": true,
        "evidence_quotes": [
          "find / -perm -4000 2>/dev/null",
          "find . -exec /bin/bash -p \\; -quit",
          "cat /root/root.txt"
        ]
      },
      {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "level_prev": 66,
        "level_new": 100,
        "changed": true,
        "evidence_quotes": [
          "cat /root/root.txt",
          "flag{privileged_access_struts}",
          "bash: no job control in this shell",
          "Reverse Shell Detected - No Job Control"
        ]
      },
      {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": []
      }
    ],
    "final_inferred_attack_graph": {
      "interesting": [
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1"
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1"
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy"
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1"
        }
      ],
      "edges": [
        {
          "from": "192.168.100.2",
          "to": "172.20.0.2",
          "edge_id": "",
          "vector": "data-exfil-user",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS) on multiple ports including tcp/80, tcp/138, tcp/139, tcp/143, tcp/465, tcp/465, tcp/3306, tcp/2375",
                "ET SCAN Suspicious inbound traffic on tcp/3306 and tcp/1433"
              ],
              "seen_in_epoch": 1
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "multiple new GPL WEB_SERVER DELETE attempts via Docker remote API (tcp/2375) with payload evidence of docker-sdk-python commands indicating exploitation attempts"
              ],
              "seen_in_epoch": 2
            },
            {
              "phase": "data-exfil-user",
              "evidence_quotes": [
                "New User-Level File Discovery attempts detected on tcp/32907 with payload \"find / -type f -name 'user.txt'...\" indicating data access attempts"
              ],
              "seen_in_epoch": 3
            }
          ],
          "first_seen": 1,
          "last_seen": 3,
          "current_phase": "data-exfil-user"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.7",
          "edge_id": "",
          "vector": "data-exfil-root",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS) on tcp/80, tcp/138, tcp/139, tcp/2375, tcp/443",
                "ET SCAN Suspicious inbound to mysql port tcp/3306 and MSSQL tcp/1433"
              ],
              "seen_in_epoch": 1
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "multiple ET INFO PHP Xdebug Extension Query Parameter (XDEBUG_SESSION_START) requests seen indicating attempts to trigger debug code execution (evidence: \"GET /index.php?XDEBUG_SESSION_START=phpstorm&XDEBUG_SESSION=1&XDEBUG_TRIGGER=1 HTTP/1.1\")"
              ],
              "seen_in_epoch": 1
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "find / -perm -4000 2>/dev/null",
                "find . -exec /bin/bash -p \\; -quit"
              ],
              "seen_in_epoch": 9
            },
            {
              "phase": "data-exfil-root",
              "evidence_quotes": [
                "cat /root/root.txt"
              ],
              "seen_in_epoch": 9
            }
          ],
          "first_seen": 1,
          "last_seen": 9,
          "current_phase": "data-exfil-root"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.3",
          "edge_id": "",
          "vector": "data-exfil-root",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "ET SCAN Suspicious inbound to MSSQL tcp/1433 noted; multiple port scans on tcp/587 and tcp/1433"
              ],
              "seen_in_epoch": 1
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
              ],
              "seen_in_epoch": 7
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "cat /root/root.txt",
                "flag{privileged_access_struts}",
                "bash: no job control in this shell",
                "Reverse Shell Detected - No Job Control"
              ],
              "seen_in_epoch": 9
            },
            {
              "phase": "data-exfil-root",
              "evidence_quotes": [
                "cat /root/root.txt",
                "flag{privileged_access_struts}"
              ],
              "seen_in_epoch": 9
            }
          ],
          "first_seen": 1,
          "last_seen": 9,
          "current_phase": "data-exfil-root"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.10",
          "edge_id": "",
          "vector": "privilege-escalation",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "Seen port scans tcp/8081 and ET SCAN Suspicious inbound to mysql tcp/3306; multiple POSSBL PORT SCAN (NMAP -sS) on tcp/8081"
              ],
              "seen_in_epoch": 1
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
              ],
              "seen_in_epoch": 5
            },
            {
              "phase": "data-exfil-user",
              "evidence_quotes": [
                "find / -type f -name 'user.txt' 2>/dev/null",
                "cat /home/ctf/user.txt"
              ],
              "seen_in_epoch": 5
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "/bin/bash -p",
                "cat /root/root.txt",
                "find / -perm -4000 -type f 2>/dev/null"
              ],
              "seen_in_epoch": 6
            }
          ],
          "first_seen": 1,
          "last_seen": 6,
          "current_phase": "privilege-escalation"
        }
      ],
      "edge_updates": []
    }
  }
}