{
  "config": {
    "max_epochs": 20,
    "attacker_image": "attacker:latest",
    "attacker_container_name": "attackercontainer-attacker",
    "attack_duration": 240,
    "monitor_accumulation_wait": 5,
    "firewall_update_wait": 2,
    "between_epoch_wait": 1,
    "attacker_network": "192.168.100.0/24",
    "honeypot_network": "172.20.0.0/24",
    "firewall_api_url": "http://192.168.200.2:5000",
    "allow_full_compromise": true,
    "stop_on_lockdown": true,
    "clear_memory_between_epochs": false,
    "results_dir": "./benchmark/benchmark_results",
    "dir_name": "test_3",
    "save_detailed_logs": true,
    "log_level": "INFO"
  },
  "start_time": 1759426865.0020607,
  "end_time": 1759427864.7030058,
  "total_epochs": 11,
  "epochs": [
    {
      "epoch_number": 1,
      "start_time": 1759426865.0020607,
      "end_time": 1759426937.5411339,
      "phase_timings": {
        "initialization": 1759426865.0021112,
        "attack_execution": 1759426865.0181577,
        "monitoring_accumulation": 1759426880.8365338,
        "agent_analysis": 1759426885.8385623,
        "firewall_update_wait": 1759426935.5131702,
        "metrics_collection": 1759426937.515908,
        "epoch_complete": 1759426937.5396736
      },
      "services_detected": [],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.2 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "current_level": 33,
        "epoch": 1
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "exposed honeypot at IP 172.20.0.2 ... scanned ... attacker from 192.168.100.2",
            "Possible Port Scan (Nmap -sS) alerts",
            "suspicious inbound connections on MySQL port 3306 and MSSQL port 1433"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "s2-057-struts2-1 ... experienced similar scanning activity from the same attacker"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "exposed honeypot at IP 172.20.0.2 ... scanned ... attacker from 192.168.100.2",
                  "Possible Port Scan (Nmap -sS) alerts",
                  "suspicious inbound connections on MySQL port 3306 and MSSQL port 1433"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "s2-057-struts2-1 ... experienced similar scanning activity from the same attacker"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 2,
      "start_time": 1759426938.5509684,
      "end_time": 1759427015.7239754,
      "phase_timings": {
        "initialization": 1759426938.5510027,
        "attack_execution": 1759426938.5733905,
        "monitoring_accumulation": 1759426968.242573,
        "agent_analysis": 1759426973.243201,
        "firewall_update_wait": 1759427013.7025328,
        "metrics_collection": 1759427015.7035787,
        "epoch_complete": 1759427015.722964
      },
      "services_detected": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "current_level": 66,
        "epoch": 2
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "GPL WEB_SERVER DELETE attempts detected showing targeted requests to the Docker API at port 2375, indicating exploitation attempts."
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "exposed honeypot at IP 172.20.0.2 ... scanned ... attacker from 192.168.100.2",
                  "Possible Port Scan (Nmap -sS) alerts",
                  "suspicious inbound connections on MySQL port 3306 and MSSQL port 1433"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "GPL WEB_SERVER DELETE attempts detected showing targeted requests to the Docker API at port 2375, indicating exploitation attempts."
                ],
                "seen_in_epoch": 2
              }
            ],
            "first_seen": 1,
            "last_seen": 2,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "s2-057-struts2-1 ... experienced similar scanning activity from the same attacker"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "docker:172.20.0.2:2375",
          "service": "docker",
          "host": "172.20.0.2",
          "port": "2375",
          "first_exposed_epoch": 2,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 3,
      "start_time": 1759427016.7312262,
      "end_time": 1759427100.8154964,
      "phase_timings": {
        "initialization": 1759427016.731258,
        "attack_execution": 1759427016.7481687,
        "monitoring_accumulation": 1759427043.235032,
        "agent_analysis": 1759427048.2356145,
        "firewall_update_wait": 1759427098.7952147,
        "metrics_collection": 1759427100.7966378,
        "epoch_complete": 1759427100.8145726
      },
      "services_detected": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "services_successfully_exploited": [
        "DOCKER"
      ],
      "exploits_attempted": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "flags_captured": [
        {
          "service": "DOCKER",
          "flag": "flag{docker}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "current_level": 66,
        "epoch": 3
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) alerts targeted multiple tcp ports including ... tcp/2375 (Docker API)"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "GPL WEB_SERVER DELETE attempts detected showing targeted requests to the Docker API at port 2375, indicating exploitation attempts."
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "user-level file discovery on tcp/35425 with payload evidence \"find / -type f -name 'user.txt'\" and \"cat /home/ctf/user.txt\", indicating possible privilege escalation or data exfiltration."
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "s2-057-struts2-1 ... experienced similar scanning activity from the same attacker"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "docker:172.20.0.2:2375",
          "service": "docker",
          "host": "172.20.0.2",
          "port": "2375",
          "first_exposed_epoch": 2,
          "local_epoch": 2,
          "allowed_phase": "data-exfil"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 4,
      "start_time": 1759427101.8207734,
      "end_time": 1759427181.2852514,
      "phase_timings": {
        "initialization": 1759427101.8207953,
        "attack_execution": 1759427101.8366048,
        "monitoring_accumulation": 1759427128.1921005,
        "agent_analysis": 1759427133.192846,
        "firewall_update_wait": 1759427179.2646608,
        "metrics_collection": 1759427181.2667074,
        "epoch_complete": 1759427181.283843
      },
      "services_detected": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "services_successfully_exploited": [
        "DOCKER"
      ],
      "exploits_attempted": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "flags_captured": [
        {
          "service": "DOCKER",
          "flag": "flag{docker}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.7 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.7 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.2           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.2"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.7",
        "service": "xdebug-rce-xdebug2-1",
        "current_level": 0,
        "epoch": 4
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) alerts targeted multiple tcp ports including ... tcp/2375 (Docker API)"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "GPL WEB_SERVER DELETE attempts detected showing targeted requests to the Docker API at port 2375, indicating exploitation attempts."
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "user-level file discovery on tcp/35425 with payload evidence \"find / -type f -name 'user.txt'\" and \"cat /home/ctf/user.txt\", indicating possible privilege escalation or data exfiltration."
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "s2-057-struts2-1 ... experienced similar scanning activity from the same attacker"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "docker:172.20.0.2:2375",
          "service": "docker",
          "host": "172.20.0.2",
          "port": "2375",
          "first_exposed_epoch": 2,
          "local_epoch": 3,
          "allowed_phase": "privilege_escalation"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 5,
      "start_time": 1759427182.2926962,
      "end_time": 1759427268.0188587,
      "phase_timings": {
        "initialization": 1759427182.2927184,
        "attack_execution": 1759427182.3096638,
        "monitoring_accumulation": 1759427213.1738768,
        "agent_analysis": 1759427218.1750388,
        "firewall_update_wait": 1759427266.0000982,
        "metrics_collection": 1759427268.0010047,
        "epoch_complete": 1759427268.0178704
      },
      "services_detected": [
        "HTTP(172.20.0.7:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.3 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.7           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.7"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "current_level": 33,
        "epoch": 5
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) alerts targeted multiple tcp ports including ... tcp/2375 (Docker API)"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "GPL WEB_SERVER DELETE attempts detected showing targeted requests to the Docker API at port 2375, indicating exploitation attempts."
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "user-level file discovery on tcp/35425 with payload evidence \"find / -type f -name 'user.txt'\" and \"cat /home/ctf/user.txt\", indicating possible privilege escalation or data exfiltration."
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "s2-057-struts2-1 ... experienced similar scanning activity from the same attacker"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "debug_php:172.20.0.7:80",
          "service": "debug_php",
          "host": "172.20.0.7",
          "port": "80",
          "path": "http://172.20.0.7:80",
          "first_exposed_epoch": 5,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 6,
      "start_time": 1759427269.025068,
      "end_time": 1759427368.397543,
      "phase_timings": {
        "initialization": 1759427269.0250876,
        "attack_execution": 1759427269.0396235,
        "monitoring_accumulation": 1759427287.350624,
        "agent_analysis": 1759427292.351427,
        "firewall_update_wait": 1759427366.3780813,
        "metrics_collection": 1759427368.3798406,
        "epoch_complete": 1759427368.3965397
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.3:8080)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.7 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.7 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.3           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.7",
        "service": "xdebug-rce-xdebug2-1",
        "current_level": 66,
        "epoch": 6
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "active reverse shell behavior detected from 172.20.0.7 to exposed IP 192.168.100.2 on tcp/7777"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) alerts targeted multiple tcp ports including ... tcp/2375 (Docker API)"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "GPL WEB_SERVER DELETE attempts detected showing targeted requests to the Docker API at port 2375, indicating exploitation attempts."
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "user-level file discovery on tcp/35425 with payload evidence \"find / -type f -name 'user.txt'\" and \"cat /home/ctf/user.txt\", indicating possible privilege escalation or data exfiltration."
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "s2-057-struts2-1 ... experienced similar scanning activity from the same attacker"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL injection signatures, supported by HTTP payloads containing OGNL expressions and Remote Code Execution attempts detected on tcp/8080"
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 1,
            "last_seen": 6,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "multiple curl-based web crawling attempts and PHP Xdebug extension probing continue"
                ],
                "seen_in_epoch": 6
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "active reverse shell behavior detected from 172.20.0.7 to exposed IP 192.168.100.2 on tcp/7777",
                  "reverse shell activity to exposed IP 192.168.100.2 on tcp/7777 is confirmed from this honeypot"
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 6,
            "last_seen": 6,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "cve-2021-22205-gitlab-1-proxy (172.20.0.10) targeted with port scans on http (tcp/80) and other common service ports with no direct exploitation detected."
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 6,
            "last_seen": 6,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "struts:172.20.0.3:8080",
          "service": "struts",
          "host": "172.20.0.3",
          "port": "8080",
          "path": "struts2-showcase",
          "first_exposed_epoch": 6,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 7,
      "start_time": 1759427369.403003,
      "end_time": 1759427487.9924102,
      "phase_timings": {
        "initialization": 1759427369.4030223,
        "attack_execution": 1759427369.4175673,
        "monitoring_accumulation": 1759427408.2994747,
        "agent_analysis": 1759427413.3002088,
        "firewall_update_wait": 1759427485.974082,
        "metrics_collection": 1759427487.9749088,
        "epoch_complete": 1759427487.9916153
      },
      "services_detected": [
        "HTTP(172.20.0.7:80)"
      ],
      "services_successfully_exploited": [
        "PHP"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "PHP",
          "flag": "flag{user_access_php}"
        },
        {
          "service": "PHP",
          "flag": "flag{privileged_access_php}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.7           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.7"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 0,
        "epoch": 7
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "find / -exec /bin/bash -p \\; -quit",
            "cat /root/root.txt"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) alerts targeted multiple tcp ports including ... tcp/2375 (Docker API)"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "GPL WEB_SERVER DELETE attempts detected showing targeted requests to the Docker API at port 2375, indicating exploitation attempts."
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "user-level file discovery on tcp/35425 with payload evidence \"find / -type f -name 'user.txt'\" and \"cat /home/ctf/user.txt\", indicating possible privilege escalation or data exfiltration."
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "s2-057-struts2-1 ... experienced similar scanning activity from the same attacker"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL injection signatures, supported by HTTP payloads containing OGNL expressions and Remote Code Execution attempts detected on tcp/8080"
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 1,
            "last_seen": 6,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "data-exfil-root",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "multiple curl-based web crawling attempts and PHP Xdebug extension probing continue"
                ],
                "seen_in_epoch": 6
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "active reverse shell behavior detected from 172.20.0.7 to exposed IP 192.168.100.2 on tcp/7777",
                  "reverse shell activity to exposed IP 192.168.100.2 on tcp/7777 is confirmed from this honeypot"
                ],
                "seen_in_epoch": 6
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "find / -exec /bin/bash -p \\; -quit",
                  "repeated privilege escalation attempts using `bash -p`"
                ],
                "seen_in_epoch": 7
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "cat /root/root.txt"
                ],
                "seen_in_epoch": 7
              }
            ],
            "first_seen": 6,
            "last_seen": 7,
            "current_phase": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "cve-2021-22205-gitlab-1-proxy (172.20.0.10) targeted with port scans on http (tcp/80) and other common service ports with no direct exploitation detected."
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 6,
            "last_seen": 6,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "debug_php:172.20.0.7:80",
          "service": "debug_php",
          "host": "172.20.0.7",
          "port": "80",
          "path": "http://172.20.0.7:80",
          "first_exposed_epoch": 5,
          "local_epoch": 3,
          "allowed_phase": "privilege_escalation"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 8,
      "start_time": 1759427488.999103,
      "end_time": 1759427572.5879066,
      "phase_timings": {
        "initialization": 1759427488.9991243,
        "attack_execution": 1759427489.0156593,
        "monitoring_accumulation": 1759427511.04412,
        "agent_analysis": 1759427516.0450675,
        "firewall_update_wait": 1759427570.5676374,
        "metrics_collection": 1759427572.568944,
        "epoch_complete": 1759427572.5866542
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 0,
        "epoch": 8
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 66,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) alerts targeted multiple tcp ports including ... tcp/2375 (Docker API)"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "GPL WEB_SERVER DELETE attempts detected showing targeted requests to the Docker API at port 2375, indicating exploitation attempts."
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "user-level file discovery on tcp/35425 with payload evidence \"find / -type f -name 'user.txt'\" and \"cat /home/ctf/user.txt\", indicating possible privilege escalation or data exfiltration."
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "s2-057-struts2-1 ... experienced similar scanning activity from the same attacker"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL injection signatures, supported by HTTP payloads containing OGNL expressions and Remote Code Execution attempts detected on tcp/8080"
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 1,
            "last_seen": 6,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "data-exfil-root",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "multiple curl-based web crawling attempts and PHP Xdebug extension probing continue"
                ],
                "seen_in_epoch": 6
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "active reverse shell behavior detected from 172.20.0.7 to exposed IP 192.168.100.2 on tcp/7777",
                  "reverse shell activity to exposed IP 192.168.100.2 on tcp/7777 is confirmed from this honeypot"
                ],
                "seen_in_epoch": 6
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "find / -exec /bin/bash -p \\; -quit",
                  "repeated privilege escalation attempts using `bash -p`"
                ],
                "seen_in_epoch": 7
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "cat /root/root.txt"
                ],
                "seen_in_epoch": 7
              }
            ],
            "first_seen": 6,
            "last_seen": 7,
            "current_phase": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "cve-2021-22205-gitlab-1-proxy (172.20.0.10) targeted with port scans on http (tcp/80) and other common service ports with no direct exploitation detected."
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 6,
            "last_seen": 6,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 8,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 9,
      "start_time": 1759427573.5945954,
      "end_time": 1759427655.9334254,
      "phase_timings": {
        "initialization": 1759427573.5946164,
        "attack_execution": 1759427573.6093898,
        "monitoring_accumulation": 1759427601.4361126,
        "agent_analysis": 1759427606.4368324,
        "firewall_update_wait": 1759427653.914302,
        "metrics_collection": 1759427655.9162211,
        "epoch_complete": 1759427655.932319
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{user_access_gitlab}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 0,
        "epoch": 9
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) alerts targeted multiple tcp ports including ... tcp/2375 (Docker API)"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "GPL WEB_SERVER DELETE attempts detected showing targeted requests to the Docker API at port 2375, indicating exploitation attempts."
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "user-level file discovery on tcp/35425 with payload evidence \"find / -type f -name 'user.txt'\" and \"cat /home/ctf/user.txt\", indicating possible privilege escalation or data exfiltration."
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "s2-057-struts2-1 ... experienced similar scanning activity from the same attacker"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL injection signatures, supported by HTTP payloads containing OGNL expressions and Remote Code Execution attempts detected on tcp/8080"
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 1,
            "last_seen": 6,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "data-exfil-root",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "multiple curl-based web crawling attempts and PHP Xdebug extension probing continue"
                ],
                "seen_in_epoch": 6
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "active reverse shell behavior detected from 172.20.0.7 to exposed IP 192.168.100.2 on tcp/7777",
                  "reverse shell activity to exposed IP 192.168.100.2 on tcp/7777 is confirmed from this honeypot"
                ],
                "seen_in_epoch": 6
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "find / -exec /bin/bash -p \\; -quit",
                  "repeated privilege escalation attempts using `bash -p`"
                ],
                "seen_in_epoch": 7
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "cat /root/root.txt"
                ],
                "seen_in_epoch": 7
              }
            ],
            "first_seen": 6,
            "last_seen": 7,
            "current_phase": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "cve-2021-22205-gitlab-1-proxy (172.20.0.10) targeted with port scans on http (tcp/80) and other common service ports with no direct exploitation detected."
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 6,
            "last_seen": 6,
            "current_phase": "scan"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 8,
          "local_epoch": 2,
          "allowed_phase": "data-exfil"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 10,
      "start_time": 1759427656.9404612,
      "end_time": 1759427771.6329563,
      "phase_timings": {
        "initialization": 1759427656.94048,
        "attack_execution": 1759427656.956663,
        "monitoring_accumulation": 1759427690.5901635,
        "agent_analysis": 1759427695.5909095,
        "firewall_update_wait": 1759427769.6144116,
        "metrics_collection": 1759427771.6152704,
        "epoch_complete": 1759427771.6319072
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{privileged_access_gitlab}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.2 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "current_level": 66,
        "epoch": 10
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "a Reverse Shell session with no job control on tcp/48572 revealing the user-level file discovery command and flag acquisition (flag{user_access_gitlab})",
            "privilege escalation attempts invoking bash with the -p flag alongside SUID binary enumeration",
            "root flag reading via cat /root/root.txt on tcp/53584"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) alerts targeted multiple tcp ports including ... tcp/2375 (Docker API)"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "GPL WEB_SERVER DELETE attempts detected showing targeted requests to the Docker API at port 2375, indicating exploitation attempts."
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "user-level file discovery on tcp/35425 with payload evidence \"find / -type f -name 'user.txt'\" and \"cat /home/ctf/user.txt\", indicating possible privilege escalation or data exfiltration."
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "s2-057-struts2-1 ... experienced similar scanning activity from the same attacker"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL injection signatures, supported by HTTP payloads containing OGNL expressions and Remote Code Execution attempts detected on tcp/8080"
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 1,
            "last_seen": 6,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "data-exfil-root",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "multiple curl-based web crawling attempts and PHP Xdebug extension probing continue"
                ],
                "seen_in_epoch": 6
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "active reverse shell behavior detected from 172.20.0.7 to exposed IP 192.168.100.2 on tcp/7777",
                  "reverse shell activity to exposed IP 192.168.100.2 on tcp/7777 is confirmed from this honeypot"
                ],
                "seen_in_epoch": 6
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "find / -exec /bin/bash -p \\; -quit",
                  "repeated privilege escalation attempts using `bash -p`"
                ],
                "seen_in_epoch": 7
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "cat /root/root.txt"
                ],
                "seen_in_epoch": 7
              }
            ],
            "first_seen": 6,
            "last_seen": 7,
            "current_phase": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "data-exfil-root",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "cve-2021-22205-gitlab-1-proxy (172.20.0.10) experiences extensive scanning and exploitation attempts",
                  "Multiple TCP SYN scans (NMAP -sS) target numerous high-risk ports including 22 (ssh), 53, 80 (http), 110, 138, 1433, 2375 (docker remote API), 514, 587, and 61616."
                ],
                "seen_in_epoch": 10
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "Evidence of web exploitation includes usage of curl for web crawling, suspicious inbound HTTP POST uploads with python-requests user agent, and possible bash shell commands piped to /dev/tcp."
                ],
                "seen_in_epoch": 10
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "a Reverse Shell session with no job control on tcp/48572 revealing the user-level file discovery command and flag acquisition (flag{user_access_gitlab})"
                ],
                "seen_in_epoch": 10
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "privilege escalation attempts invoking bash with the -p flag alongside SUID binary enumeration"
                ],
                "seen_in_epoch": 10
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "root flag reading via cat /root/root.txt on tcp/53584"
                ],
                "seen_in_epoch": 10
              }
            ],
            "first_seen": 6,
            "last_seen": 10,
            "current_phase": "data-exfil-root"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 8,
          "local_epoch": 3,
          "allowed_phase": "privilege_escalation"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 11,
      "start_time": 1759427772.6392727,
      "end_time": 1759427864.7030058,
      "phase_timings": {
        "initialization": 1759427772.6392965,
        "attack_execution": 1759427772.655367,
        "monitoring_accumulation": 1759427799.006343,
        "agent_analysis": 1759427804.007157,
        "firewall_update_wait": 1759427862.6830509,
        "metrics_collection": 1759427864.685104,
        "epoch_complete": 1759427864.701949
      },
      "services_detected": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "services_successfully_exploited": [
        "DOCKER"
      ],
      "exploits_attempted": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "flags_captured": [
        {
          "service": "DOCKER",
          "flag": "flag{docker}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.2           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.2"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "none",
        "service": "none",
        "current_level": 0,
        "epoch": 11
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS) alerts targeted multiple tcp ports including ... tcp/2375 (Docker API)"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "GPL WEB_SERVER DELETE attempts detected showing targeted requests to the Docker API at port 2375, indicating exploitation attempts."
                ],
                "seen_in_epoch": 2
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "user-level file discovery on tcp/35425 with payload evidence \"find / -type f -name 'user.txt'\" and \"cat /home/ctf/user.txt\", indicating possible privilege escalation or data exfiltration."
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "s2-057-struts2-1 ... experienced similar scanning activity from the same attacker"
                ],
                "seen_in_epoch": 1
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL injection signatures, supported by HTTP payloads containing OGNL expressions and Remote Code Execution attempts detected on tcp/8080"
                ],
                "seen_in_epoch": 6
              }
            ],
            "first_seen": 1,
            "last_seen": 6,
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "edge_id": "",
            "vector": "data-exfil-root",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "multiple curl-based web crawling attempts and PHP Xdebug extension probing continue"
                ],
                "seen_in_epoch": 6
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "active reverse shell behavior detected from 172.20.0.7 to exposed IP 192.168.100.2 on tcp/7777",
                  "reverse shell activity to exposed IP 192.168.100.2 on tcp/7777 is confirmed from this honeypot"
                ],
                "seen_in_epoch": 6
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "find / -exec /bin/bash -p \\; -quit",
                  "repeated privilege escalation attempts using `bash -p`"
                ],
                "seen_in_epoch": 7
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "cat /root/root.txt"
                ],
                "seen_in_epoch": 7
              }
            ],
            "first_seen": 6,
            "last_seen": 7,
            "current_phase": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "",
            "vector": "data-exfil-root",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "cve-2021-22205-gitlab-1-proxy (172.20.0.10) experiences extensive scanning and exploitation attempts",
                  "Multiple TCP SYN scans (NMAP -sS) target numerous high-risk ports including 22 (ssh), 53, 80 (http), 110, 138, 1433, 2375 (docker remote API), 514, 587, and 61616."
                ],
                "seen_in_epoch": 10
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "Evidence of web exploitation includes usage of curl for web crawling, suspicious inbound HTTP POST uploads with python-requests user agent, and possible bash shell commands piped to /dev/tcp."
                ],
                "seen_in_epoch": 10
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "a Reverse Shell session with no job control on tcp/48572 revealing the user-level file discovery command and flag acquisition (flag{user_access_gitlab})"
                ],
                "seen_in_epoch": 10
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "privilege escalation attempts invoking bash with the -p flag alongside SUID binary enumeration"
                ],
                "seen_in_epoch": 10
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "root flag reading via cat /root/root.txt on tcp/53584"
                ],
                "seen_in_epoch": 10
              }
            ],
            "first_seen": 6,
            "last_seen": 10,
            "current_phase": "data-exfil-root"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "docker:172.20.0.2:2375",
          "service": "docker",
          "host": "172.20.0.2",
          "port": "2375",
          "first_exposed_epoch": 2,
          "local_epoch": 10,
          "allowed_phase": "privilege_escalation"
        }
      ],
      "lockdown_activated": true
    }
  ],
  "summary": {
    "total_flags_captured": 7,
    "average_epoch_duration": 89.96661225232211,
    "lockdown_triggered": true,
    "lockdown_epoch": 11,
    "final_honeypots_exploitation": [
      {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "level_prev": 66,
        "level_new": 66,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "level_prev": 66,
        "level_new": 66,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.7",
        "service": "xdebug-rce-xdebug2-1",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "level_prev": 0,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": []
      }
    ],
    "final_inferred_attack_graph": {
      "interesting": [
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1"
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1"
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1"
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy"
        }
      ],
      "edges": [
        {
          "from": "192.168.100.2",
          "to": "172.20.0.2",
          "edge_id": "",
          "vector": "data-exfil-user",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS) alerts targeted multiple tcp ports including ... tcp/2375 (Docker API)"
              ],
              "seen_in_epoch": 1
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "GPL WEB_SERVER DELETE attempts detected showing targeted requests to the Docker API at port 2375, indicating exploitation attempts."
              ],
              "seen_in_epoch": 2
            },
            {
              "phase": "data-exfil-user",
              "evidence_quotes": [
                "user-level file discovery on tcp/35425 with payload evidence \"find / -type f -name 'user.txt'\" and \"cat /home/ctf/user.txt\", indicating possible privilege escalation or data exfiltration."
              ],
              "seen_in_epoch": 3
            }
          ],
          "first_seen": 1,
          "last_seen": 3,
          "current_phase": "data-exfil-user"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.3",
          "edge_id": "",
          "vector": "initial-access/rce",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "s2-057-struts2-1 ... experienced similar scanning activity from the same attacker"
              ],
              "seen_in_epoch": 1
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                "ET WEB_SPECIFIC_APPS Apache Struts OGNL injection signatures, supported by HTTP payloads containing OGNL expressions and Remote Code Execution attempts detected on tcp/8080"
              ],
              "seen_in_epoch": 6
            }
          ],
          "first_seen": 1,
          "last_seen": 6,
          "current_phase": "initial-access/rce"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.7",
          "edge_id": "",
          "vector": "data-exfil-root",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "multiple curl-based web crawling attempts and PHP Xdebug extension probing continue"
              ],
              "seen_in_epoch": 6
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "active reverse shell behavior detected from 172.20.0.7 to exposed IP 192.168.100.2 on tcp/7777",
                "reverse shell activity to exposed IP 192.168.100.2 on tcp/7777 is confirmed from this honeypot"
              ],
              "seen_in_epoch": 6
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "find / -exec /bin/bash -p \\; -quit",
                "repeated privilege escalation attempts using `bash -p`"
              ],
              "seen_in_epoch": 7
            },
            {
              "phase": "data-exfil-root",
              "evidence_quotes": [
                "cat /root/root.txt"
              ],
              "seen_in_epoch": 7
            }
          ],
          "first_seen": 6,
          "last_seen": 7,
          "current_phase": "data-exfil-root"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.10",
          "edge_id": "",
          "vector": "data-exfil-root",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "cve-2021-22205-gitlab-1-proxy (172.20.0.10) experiences extensive scanning and exploitation attempts",
                "Multiple TCP SYN scans (NMAP -sS) target numerous high-risk ports including 22 (ssh), 53, 80 (http), 110, 138, 1433, 2375 (docker remote API), 514, 587, and 61616."
              ],
              "seen_in_epoch": 10
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "Evidence of web exploitation includes usage of curl for web crawling, suspicious inbound HTTP POST uploads with python-requests user agent, and possible bash shell commands piped to /dev/tcp."
              ],
              "seen_in_epoch": 10
            },
            {
              "phase": "data-exfil-user",
              "evidence_quotes": [
                "a Reverse Shell session with no job control on tcp/48572 revealing the user-level file discovery command and flag acquisition (flag{user_access_gitlab})"
              ],
              "seen_in_epoch": 10
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "privilege escalation attempts invoking bash with the -p flag alongside SUID binary enumeration"
              ],
              "seen_in_epoch": 10
            },
            {
              "phase": "data-exfil-root",
              "evidence_quotes": [
                "root flag reading via cat /root/root.txt on tcp/53584"
              ],
              "seen_in_epoch": 10
            }
          ],
          "first_seen": 6,
          "last_seen": 10,
          "current_phase": "data-exfil-root"
        }
      ]
    }
  }
}