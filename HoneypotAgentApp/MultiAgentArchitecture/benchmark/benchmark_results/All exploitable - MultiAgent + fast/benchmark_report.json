{
  "config": {
    "max_epochs": 10,
    "attacker_image": "attacker:latest",
    "attacker_container_name": "attackercontainer-attacker",
    "attack_duration": 200,
    "monitor_accumulation_wait": 50,
    "firewall_update_wait": 2,
    "between_epoch_wait": 1,
    "attacker_network": "192.168.100.0/24",
    "honeypot_network": "172.20.0.0/24",
    "firewall_api_url": "http://192.168.200.2:5000",
    "allow_full_compromise": true,
    "stop_on_lockdown": true,
    "clear_memory_between_epochs": false,
    "results_dir": "./benchmark_results",
    "dir_name": "All exploitable - MultiAgent + fast",
    "save_detailed_logs": true,
    "log_level": "INFO"
  },
  "start_time": 1754839914.9295437,
  "end_time": 1754840514.501402,
  "total_epochs": 5,
  "epochs": [
    {
      "epoch_number": 1,
      "start_time": 1754839914.9295437,
      "end_time": 1754840005.0378666,
      "phase_timings": {
        "initialization": 1754839914.9295654,
        "attack_execution": 1754839914.9495416,
        "monitoring_accumulation": 1754839921.822617,
        "agent_analysis": 1754839971.8234072,
        "firewall_update_wait": 1754840003.0133066,
        "metrics_collection": 1754840005.0146604,
        "epoch_complete": 1754840005.0371969
      },
      "services_detected": [],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.3 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.3",
        "service": "unauthorized-rce-docker-1",
        "current_level": 33
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 7"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 9",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 2",
            "ET SCAN Suspicious inbound to mySQL port 3306: 2"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 8",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1"
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 4",
            "ET SCAN Potential SSH Scan: 1"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [],
        "edges": []
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 2,
      "start_time": 1754840006.0413852,
      "end_time": 1754840126.7474403,
      "phase_timings": {
        "initialization": 1754840006.041398,
        "attack_execution": 1754840006.0555217,
        "monitoring_accumulation": 1754840019.4509785,
        "agent_analysis": 1754840069.4519348,
        "firewall_update_wait": 1754840124.7252371,
        "metrics_collection": 1754840126.7268407,
        "epoch_complete": 1754840126.745866
      },
      "services_detected": [
        "DOCKER(172.20.0.3:2375)"
      ],
      "services_successfully_exploited": [
        "DOCKER"
      ],
      "exploits_attempted": [
        "DOCKER(172.20.0.3:2375)"
      ],
      "flags_captured": [
        {
          "service": "DOCKER",
          "flag": "flag{docker}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.3           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 33
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "Evidence of targeted scans and probes; no clear evidence of successful interactive deception (no session or post-exploit activity logged in alerts).",
            "POSSBL PORT SCAN (NMAP -sS): >12"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "Port scan evidence; no sign of direct exploitation or session.",
            "POSSBL PORT SCAN (NMAP -sS): 5",
            "ET SCAN Behavioral Unusually fast Terminal Server (RDP): 1"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "POSSBL SCAN SHELL M-SPLOIT TCP (2 alerts; possible reverse shell attempt involving 172.20.0.3 and 192.168.100.2:4444)",
            "User-Level File Discovery - find binary execution (2 alerts)",
            "Web crawl and DELETE attempts (web application interaction)"
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "Only port scans and probes; no interactive or exploit signatures detected."
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "unauthorized-rce-docker-1",
            "confidence": 0.66
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "aa823512e830",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): >12"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2,
                "confidence": 0.33
              }
            ],
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "edge_id": "c47214fa4209",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 5",
                  "ET SCAN Behavioral Unusually fast Terminal Server (RDP): 1"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2,
                "confidence": 0.33
              }
            ],
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "858329889bee",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP): >10"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2,
                "confidence": 0.33
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "POSSBL SCAN SHELL M-SPLOIT TCP (2 alerts; possible reverse shell attempt involving 172.20.0.3 and 192.168.100.2:4444)",
                  "User-Level File Discovery - find binary execution (2 alerts)"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2,
                "confidence": 0.66
              }
            ],
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "b8586a6723cb",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): >10"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2,
                "confidence": 0.33
              }
            ],
            "current_phase": "scan"
          }
        ]
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 3,
      "start_time": 1754840127.7518785,
      "end_time": 1754840261.6894689,
      "phase_timings": {
        "initialization": 1754840127.7518947,
        "attack_execution": 1754840127.7633657,
        "monitoring_accumulation": 1754840155.180436,
        "agent_analysis": 1754840205.181023,
        "firewall_update_wait": 1754840259.643331,
        "metrics_collection": 1754840261.6450934,
        "epoch_complete": 1754840261.6885326
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [
        "HTTP(172.20.0.10:80)"
      ],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{user_access}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.4 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.4 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.4",
        "service": "s2-057-struts2-1",
        "current_level": 33
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "ET WEB_SERVER Possible bash shell piped to dev tcp: 2",
            "Reverse Shell Detected - No Job Control: 2",
            "User-Level File Discovery - find binary execution: 3",
            "ET INFO POSSIBLE Web Crawl using Curl: 1"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): multiple",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): multiple",
            "ET SCAN Potential SSH Scan: 1",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): multiple",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "unauthorized-rce-docker-1",
            "confidence": 0.66
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 0.66
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "aa823512e830",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): multiple",
                  "ET SCAN Suspicious inbound to mySQL port 3306: multiple",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: multiple"
                ],
                "seen_in_epoch": 3,
                "first_seen": 2,
                "last_seen": 3,
                "confidence": 0.33
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp: 2",
                  "Reverse Shell Detected - No Job Control: 2",
                  "User-Level File Discovery - find binary execution: 3",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1"
                ],
                "seen_in_epoch": 3,
                "first_seen": 3,
                "last_seen": 3,
                "confidence": 0.66
              }
            ],
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "edge_id": "c47214fa4209",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): multiple",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1"
                ],
                "seen_in_epoch": 3,
                "first_seen": 2,
                "last_seen": 3,
                "confidence": 0.33
              }
            ],
            "current_phase": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "858329889bee",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): multiple",
                  "ET SCAN Potential SSH Scan: 1",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
                ],
                "seen_in_epoch": 3,
                "first_seen": 2,
                "last_seen": 3,
                "confidence": 0.33
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "POSSBL SCAN SHELL M-SPLOIT TCP (2 alerts; possible reverse shell attempt involving 172.20.0.3 and 192.168.100.2:4444)",
                  "User-Level File Discovery - find binary execution (2 alerts)"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2,
                "confidence": 0.66
              }
            ],
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "b8586a6723cb",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): multiple",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
                ],
                "seen_in_epoch": 3,
                "first_seen": 2,
                "last_seen": 3,
                "confidence": 0.33
              }
            ],
            "current_phase": "scan"
          }
        ]
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 4,
      "start_time": 1754840262.6956234,
      "end_time": 1754840382.5315578,
      "phase_timings": {
        "initialization": 1754840262.6956418,
        "attack_execution": 1754840262.7130363,
        "monitoring_accumulation": 1754840276.4728925,
        "agent_analysis": 1754840326.473559,
        "firewall_update_wait": 1754840380.5032725,
        "metrics_collection": 1754840382.5044675,
        "epoch_complete": 1754840382.5301313
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.4:8080)"
      ],
      "services_successfully_exploited": [
        "STRUTS"
      ],
      "exploits_attempted": [
        "HTTP-PROXY(172.20.0.4:8080)"
      ],
      "flags_captured": [
        {
          "service": "STRUTS",
          "flag": "flag{privileged_struts}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.2 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.4           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.4"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.2",
        "service": "xdebug-rce-xdebug2-1",
        "current_level": 33
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "ET WEB_SERVER Possible bash shell piped to dev tcp: 2",
            "Reverse Shell Detected - No Job Control: 2",
            "User-Level File Discovery - find binary execution: 3",
            "ET INFO POSSIBLE Web Crawl using Curl: 1"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "Multiple Remote Code Execution (RCE) attempts detected against Struts2 honeypot (172.20.0.4:8080) using OGNL injection, with Priority 1 signatures",
            "Reverse shell activity observed from 172.20.0.4 to external IP 192.168.100.2:9999",
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 4",
            "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 4",
            "ET WEB_SPECIFIC_APPS Apache Struts ognl and java.lang inbound OGNL injection RCE: 8",
            "ET HUNTING .exec in HTTP URI: 4",
            "Reverse Shell Detected - No Job Control: 2"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): multiple",
            "ET SCAN Potential SSH Scan: 1",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): multiple",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 0.66
          },
          {
            "ip": "172.20.0.4",
            "service": "s2-057-struts2-1",
            "confidence": 0.66
          },
          {
            "ip": "172.20.0.3",
            "service": "unauthorized-rce-docker-1",
            "confidence": 0.66
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "aa823512e830",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): multiple",
                  "ET SCAN Suspicious inbound to mySQL port 3306: multiple",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: multiple"
                ],
                "seen_in_epoch": 3,
                "first_seen": 2,
                "last_seen": 3,
                "confidence": 0.33
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp: 2",
                  "Reverse Shell Detected - No Job Control: 2",
                  "User-Level File Discovery - find binary execution: 3",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1"
                ],
                "seen_in_epoch": 3,
                "first_seen": 3,
                "last_seen": 3,
                "confidence": 0.66
              }
            ],
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "edge_id": "c47214fa4209",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): multiple",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1"
                ],
                "seen_in_epoch": 3,
                "first_seen": 2,
                "last_seen": 3,
                "confidence": 0.33
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "Multiple Remote Code Execution (RCE) attempts detected against Struts2 honeypot (172.20.0.4:8080) using OGNL injection, with Priority 1 signatures",
                  "Reverse shell activity observed from 172.20.0.4 to external IP 192.168.100.2:9999",
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 4",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 4",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl and java.lang inbound OGNL injection RCE: 8",
                  "ET HUNTING .exec in HTTP URI: 4",
                  "Reverse Shell Detected - No Job Control: 2"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4,
                "confidence": 0.66
              }
            ],
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "858329889bee",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): multiple",
                  "ET SCAN Potential SSH Scan: 1",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
                ],
                "seen_in_epoch": 3,
                "first_seen": 2,
                "last_seen": 3,
                "confidence": 0.33
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "POSSBL SCAN SHELL M-SPLOIT TCP (2 alerts; possible reverse shell attempt involving 172.20.0.3 and 192.168.100.2:4444)",
                  "User-Level File Discovery - find binary execution (2 alerts)"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2,
                "confidence": 0.66
              }
            ],
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "b8586a6723cb",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): multiple",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
                ],
                "seen_in_epoch": 3,
                "first_seen": 2,
                "last_seen": 3,
                "confidence": 0.33
              }
            ],
            "current_phase": "scan"
          }
        ]
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 5,
      "start_time": 1754840383.5363796,
      "end_time": 1754840514.501402,
      "phase_timings": {
        "initialization": 1754840383.5363934,
        "attack_execution": 1754840383.551218,
        "monitoring_accumulation": 1754840411.5353444,
        "agent_analysis": 1754840461.5371017,
        "firewall_update_wait": 1754840512.47917,
        "metrics_collection": 1754840514.480661,
        "epoch_complete": 1754840514.500462
      },
      "services_detected": [
        "HTTP(172.20.0.2:80)"
      ],
      "services_successfully_exploited": [
        "PHP"
      ],
      "exploits_attempted": [
        "HTTP(172.20.0.2:80)"
      ],
      "flags_captured": [
        {
          "service": "PHP",
          "flag": "flag{rce_php}"
        },
        {
          "service": "PHP",
          "flag": "flag{privilege_escalation_php}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.2           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.2"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "",
        "service": "",
        "current_level": 0
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): multiple times",
            "ET SCAN Suspicious inbound to mySQL port 3306: at least 1",
            "ET SCAN Suspicious inbound to MSSQL port 1433: at least 2"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): multiple times"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): multiple times",
            "ET SCAN Suspicious inbound to mySQL port 3306: at least 1"
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 33,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "Privilege Escalation Attempt - bash -p: at least 3",
            "User-Level File Discovery - find binary execution: at least 3",
            "Reverse Shell Detected - No Job Control: at least 2"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 0.66
          },
          {
            "ip": "172.20.0.4",
            "service": "s2-057-struts2-1",
            "confidence": 0.66
          },
          {
            "ip": "172.20.0.3",
            "service": "unauthorized-rce-docker-1",
            "confidence": 0.66
          },
          {
            "ip": "172.20.0.2",
            "service": "xdebug-rce-xdebug2-1",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "aa823512e830",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): multiple",
                  "ET SCAN Suspicious inbound to mySQL port 3306: multiple",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: multiple"
                ],
                "seen_in_epoch": 3,
                "first_seen": 2,
                "last_seen": 3,
                "confidence": 0.33
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp: 2",
                  "Reverse Shell Detected - No Job Control: 2",
                  "User-Level File Discovery - find binary execution: 3",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1"
                ],
                "seen_in_epoch": 3,
                "first_seen": 3,
                "last_seen": 3,
                "confidence": 0.66
              }
            ],
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "edge_id": "c47214fa4209",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): multiple",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1"
                ],
                "seen_in_epoch": 3,
                "first_seen": 2,
                "last_seen": 3,
                "confidence": 0.33
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "Multiple Remote Code Execution (RCE) attempts detected against Struts2 honeypot (172.20.0.4:8080) using OGNL injection, with Priority 1 signatures",
                  "Reverse shell activity observed from 172.20.0.4 to external IP 192.168.100.2:9999",
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 4",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 4",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl and java.lang inbound OGNL injection RCE: 8",
                  "ET HUNTING .exec in HTTP URI: 4",
                  "Reverse Shell Detected - No Job Control: 2"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4,
                "confidence": 0.66
              }
            ],
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "858329889bee",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): multiple",
                  "ET SCAN Potential SSH Scan: 1",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
                ],
                "seen_in_epoch": 3,
                "first_seen": 2,
                "last_seen": 3,
                "confidence": 0.33
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "POSSBL SCAN SHELL M-SPLOIT TCP (2 alerts; possible reverse shell attempt involving 172.20.0.3 and 192.168.100.2:4444)",
                  "User-Level File Discovery - find binary execution (2 alerts)"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2,
                "confidence": 0.66
              }
            ],
            "current_phase": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "edge_id": "b8586a6723cb",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): multiple",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
                ],
                "seen_in_epoch": 3,
                "first_seen": 2,
                "last_seen": 3,
                "confidence": 0.33
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p: at least 3",
                  "User-Level File Discovery - find binary execution: at least 3",
                  "Reverse Shell Detected - No Job Control: at least 2"
                ],
                "seen_in_epoch": 5,
                "first_seen": 5,
                "last_seen": 5,
                "confidence": 1.0
              }
            ],
            "current_phase": "privilege-escalation"
          }
        ]
      },
      "lockdown_activated": true
    }
  ],
  "summary": {
    "total_flags_captured": 5,
    "average_epoch_duration": 119.11058502197265,
    "lockdown_triggered": true,
    "lockdown_epoch": 5,
    "final_honeypots_exploitation": [
      {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "level_prev": 66,
        "level_new": 66,
        "changed": false,
        "evidence_quotes": [
          "POSSBL PORT SCAN (NMAP -sS): multiple times",
          "ET SCAN Suspicious inbound to mySQL port 3306: at least 1",
          "ET SCAN Suspicious inbound to MSSQL port 1433: at least 2"
        ]
      },
      {
        "ip": "172.20.0.4",
        "service": "s2-057-struts2-1",
        "level_prev": 66,
        "level_new": 66,
        "changed": false,
        "evidence_quotes": [
          "POSSBL PORT SCAN (NMAP -sS): multiple times"
        ]
      },
      {
        "ip": "172.20.0.3",
        "service": "unauthorized-rce-docker-1",
        "level_prev": 66,
        "level_new": 66,
        "changed": false,
        "evidence_quotes": [
          "POSSBL PORT SCAN (NMAP -sS): multiple times",
          "ET SCAN Suspicious inbound to mySQL port 3306: at least 1"
        ]
      },
      {
        "ip": "172.20.0.2",
        "service": "xdebug-rce-xdebug2-1",
        "level_prev": 33,
        "level_new": 100,
        "changed": true,
        "evidence_quotes": [
          "Privilege Escalation Attempt - bash -p: at least 3",
          "User-Level File Discovery - find binary execution: at least 3",
          "Reverse Shell Detected - No Job Control: at least 2"
        ]
      }
    ],
    "final_inferred_attack_graph": {
      "interesting": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "confidence": 0.66
        },
        {
          "ip": "172.20.0.4",
          "service": "s2-057-struts2-1",
          "confidence": 0.66
        },
        {
          "ip": "172.20.0.3",
          "service": "unauthorized-rce-docker-1",
          "confidence": 0.66
        },
        {
          "ip": "172.20.0.2",
          "service": "xdebug-rce-xdebug2-1",
          "confidence": 1.0
        }
      ],
      "edges": [
        {
          "from": "192.168.100.2",
          "to": "172.20.0.10",
          "edge_id": "aa823512e830",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS): multiple",
                "ET SCAN Suspicious inbound to mySQL port 3306: multiple",
                "ET SCAN Suspicious inbound to MSSQL port 1433: multiple"
              ],
              "seen_in_epoch": 3,
              "first_seen": 2,
              "last_seen": 3,
              "confidence": 0.33
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "ET WEB_SERVER Possible bash shell piped to dev tcp: 2",
                "Reverse Shell Detected - No Job Control: 2",
                "User-Level File Discovery - find binary execution: 3",
                "ET INFO POSSIBLE Web Crawl using Curl: 1"
              ],
              "seen_in_epoch": 3,
              "first_seen": 3,
              "last_seen": 3,
              "confidence": 0.66
            }
          ],
          "current_phase": "initial-access/rce"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.4",
          "edge_id": "c47214fa4209",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS): multiple",
                "ET SCAN Suspicious inbound to mySQL port 3306: 1"
              ],
              "seen_in_epoch": 3,
              "first_seen": 2,
              "last_seen": 3,
              "confidence": 0.33
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "Multiple Remote Code Execution (RCE) attempts detected against Struts2 honeypot (172.20.0.4:8080) using OGNL injection, with Priority 1 signatures",
                "Reverse shell activity observed from 172.20.0.4 to external IP 192.168.100.2:9999",
                "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 4",
                "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 4",
                "ET WEB_SPECIFIC_APPS Apache Struts ognl and java.lang inbound OGNL injection RCE: 8",
                "ET HUNTING .exec in HTTP URI: 4",
                "Reverse Shell Detected - No Job Control: 2"
              ],
              "seen_in_epoch": 4,
              "first_seen": 4,
              "last_seen": 4,
              "confidence": 0.66
            }
          ],
          "current_phase": "initial-access/rce"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.3",
          "edge_id": "858329889bee",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS): multiple",
                "ET SCAN Potential SSH Scan: 1",
                "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
              ],
              "seen_in_epoch": 3,
              "first_seen": 2,
              "last_seen": 3,
              "confidence": 0.33
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "POSSBL SCAN SHELL M-SPLOIT TCP (2 alerts; possible reverse shell attempt involving 172.20.0.3 and 192.168.100.2:4444)",
                "User-Level File Discovery - find binary execution (2 alerts)"
              ],
              "seen_in_epoch": 2,
              "first_seen": 2,
              "last_seen": 2,
              "confidence": 0.66
            }
          ],
          "current_phase": "initial-access/rce"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.2",
          "edge_id": "b8586a6723cb",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS): multiple",
                "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
              ],
              "seen_in_epoch": 3,
              "first_seen": 2,
              "last_seen": 3,
              "confidence": 0.33
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "Privilege Escalation Attempt - bash -p: at least 3",
                "User-Level File Discovery - find binary execution: at least 3",
                "Reverse Shell Detected - No Job Control: at least 2"
              ],
              "seen_in_epoch": 5,
              "first_seen": 5,
              "last_seen": 5,
              "confidence": 1.0
            }
          ],
          "current_phase": "privilege-escalation"
        }
      ]
    }
  }
}