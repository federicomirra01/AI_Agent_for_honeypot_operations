{
  "config": {
    "max_epochs": 20,
    "attacker_image": "attacker:latest",
    "attacker_container_name": "attackercontainer-attacker",
    "attack_duration": 150,
    "monitor_accumulation_wait": 50,
    "firewall_update_wait": 2,
    "between_epoch_wait": 1,
    "attacker_network": "192.168.100.0/24",
    "honeypot_network": "172.20.0.0/24",
    "firewall_api_url": "http://192.168.200.2:5000",
    "allow_full_compromise": true,
    "stop_on_lockdown": true,
    "clear_memory_between_epochs": false,
    "results_dir": "./benchmark/benchmark_results",
    "dir_name": "Struts_Gitlab_2_decoys_eve_enhanced",
    "save_detailed_logs": true,
    "log_level": "INFO"
  },
  "start_time": 1755872366.867798,
  "end_time": 1755873669.2433167,
  "total_epochs": 8,
  "epochs": [
    {
      "epoch_number": 1,
      "start_time": 1755872366.867798,
      "end_time": 1755872519.39255,
      "phase_timings": {
        "initialization": 1755872366.8678267,
        "attack_execution": 1755872366.8879952,
        "monitoring_accumulation": 1755872373.8001184,
        "agent_analysis": 1755872423.801361,
        "firewall_update_wait": 1755872517.3610826,
        "metrics_collection": 1755872519.3627517,
        "epoch_complete": 1755872519.3915198
      },
      "services_detected": [],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.5 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.5 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.5",
        "service": "cve-2014-6271-web-1",
        "current_level": 33,
        "epoch": 1
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "ET SCAN Suspicious inbound to mySQL port 3306",
            "ET SCAN Suspicious inbound to MSSQL port 1433"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "ET SCAN Suspicious inbound to mySQL port 3306",
            "ET SCAN Suspicious inbound to MSSQL port 1433",
            "POSSBL PORT SCAN (NMAP -sS)"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "ET SCAN Potential SSH Scan",
            "ET SCAN Suspicious inbound to mySQL port 3306",
            "ET SCAN Suspicious inbound to MSSQL port 1433"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "edge_id": "c99e98f27042",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "ET SCAN Suspicious inbound to MSSQL port 1433"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "edge_id": "de43ae179be7",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "37e86c92435b",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "4b579f6c3e86",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Potential SSH Scan",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "ET SCAN Suspicious inbound to MSSQL port 1433"
                ],
                "seen_in_epoch": 1
              }
            ],
            "first_seen": 1,
            "last_seen": 1,
            "current_phase": "scan",
            "confidence": 1.0
          }
        ],
        "edge_updates": [
          {
            "edge_id": "c99e98f27042",
            "added_phases": [
              "scan"
            ],
            "seen_in_epoch": 1
          },
          {
            "edge_id": "de43ae179be7",
            "added_phases": [
              "scan"
            ],
            "seen_in_epoch": 1
          },
          {
            "edge_id": "37e86c92435b",
            "added_phases": [
              "scan"
            ],
            "seen_in_epoch": 1
          },
          {
            "edge_id": "4b579f6c3e86",
            "added_phases": [
              "scan"
            ],
            "seen_in_epoch": 1
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 2,
      "start_time": 1755872520.3980746,
      "end_time": 1755872660.5435524,
      "phase_timings": {
        "initialization": 1755872520.398102,
        "attack_execution": 1755872520.4210262,
        "monitoring_accumulation": 1755872525.3687036,
        "agent_analysis": 1755872575.3702755,
        "firewall_update_wait": 1755872658.5143578,
        "metrics_collection": 1755872660.5158927,
        "epoch_complete": 1755872660.5423265
      },
      "services_detected": [
        "HTTP(172.20.0.5:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.4 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.4 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.3 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.5",
        "service": "cve-2014-6271-web-1",
        "current_level": 33,
        "epoch": 2
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "ET SCAN Suspicious inbound to mySQL port 3306",
            "ET SCAN Suspicious inbound to MSSQL port 1433",
            "ET INFO POSSIBLE Web Crawl using Curl (GET /struts2-examples)"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "ET SCAN Suspicious inbound to mySQL port 3306",
            "ET SCAN Suspicious inbound to MSSQL port 1433"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "ET SCAN Suspicious inbound to mySQL port 3306",
            "ET SCAN Suspicious inbound to MSSQL port 1433"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "ET SCAN Potential SSH Scan",
            "ET SCAN Suspicious inbound to mySQL port 3306",
            "ET SCAN Suspicious inbound to MSSQL port 1433"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "edge_id": "c99e98f27042",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET INFO POSSIBLE Web Crawl using Curl (GET /struts2-examples)"
                ],
                "seen_in_epoch": 2
              }
            ],
            "first_seen": 1,
            "last_seen": 2,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "edge_id": "de43ae179be7",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "ET SCAN Suspicious inbound to MSSQL port 1433"
                ],
                "seen_in_epoch": 2
              }
            ],
            "first_seen": 1,
            "last_seen": 2,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "37e86c92435b",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "ET SCAN Suspicious inbound to MSSQL port 1433"
                ],
                "seen_in_epoch": 2
              }
            ],
            "first_seen": 1,
            "last_seen": 2,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "4b579f6c3e86",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Potential SSH Scan",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "ET SCAN Suspicious inbound to MSSQL port 1433"
                ],
                "seen_in_epoch": 2
              }
            ],
            "first_seen": 1,
            "last_seen": 2,
            "current_phase": "scan",
            "confidence": 1.0
          }
        ],
        "edge_updates": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 3,
      "start_time": 1755872661.5494049,
      "end_time": 1755872860.4901674,
      "phase_timings": {
        "initialization": 1755872661.549426,
        "attack_execution": 1755872661.5663457,
        "monitoring_accumulation": 1755872677.1491287,
        "agent_analysis": 1755872727.1503046,
        "firewall_update_wait": 1755872858.4612632,
        "metrics_collection": 1755872860.463349,
        "epoch_complete": 1755872860.4893053
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)",
        "HTTP(172.20.0.5:80)",
        "UNKNOWN(172.20.0.4:61616)",
        "HTTP-PROXY(172.20.0.3:8080)",
        "PATROL-SNMP(172.20.0.4:8161)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.3 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.4 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.4 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.3           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3",
            "REMOVED rule #3:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #4:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10",
            "REMOVED rule #5:    ACCEPT     tcp  --  172.20.0.4           192.168.100.0/24",
            "REMOVED rule #6:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.4"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.5",
        "service": "cve-2014-6271-web-1",
        "current_level": 33,
        "epoch": 3
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "ET SCAN Suspicious inbound to mySQL port 3306",
            "ET SCAN Suspicious inbound to MSSQL port 1433"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "ET SCAN Suspicious inbound to mySQL port 3306",
            "ET SCAN Suspicious inbound to MSSQL port 1433"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3",
            "ET INFO User-Agent (python-requests) Inbound to Webserver"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "ET WEB_SPECIFIC_APPS Apache Struts ognl/java.lang inbound OGNL injection RCE",
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
            "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity",
            "ET HUNTING curl User-Agent to Dotted Quad"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "edge_id": "c99e98f27042",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "ET SCAN Suspicious inbound to MSSQL port 1433"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "edge_id": "de43ae179be7",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "ET SCAN Suspicious inbound to MSSQL port 1433"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "37e86c92435b",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "ET SCAN Suspicious inbound to MSSQL port 1433"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "initial-access/rce",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "4b579f6c3e86",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Potential SSH Scan",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "ET SCAN Suspicious inbound to MSSQL port 1433"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl/java.lang inbound OGNL injection RCE",
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
                ],
                "seen_in_epoch": 3
              },
              {
                "phase": "data-exfil-user",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET HUNTING curl User-Agent to Dotted Quad"
                ],
                "seen_in_epoch": 3
              }
            ],
            "first_seen": 1,
            "last_seen": 3,
            "current_phase": "data-exfil-user",
            "confidence": 1.0
          }
        ],
        "edge_updates": [
          {
            "edge_id": "37e86c92435b",
            "added_phases": [
              "initial-access/rce"
            ],
            "seen_in_epoch": 3
          },
          {
            "edge_id": "4b579f6c3e86",
            "added_phases": [
              "initial-access/rce",
              "data-exfil-user"
            ],
            "seen_in_epoch": 3
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 4,
      "start_time": 1755872861.4963737,
      "end_time": 1755873022.6901202,
      "phase_timings": {
        "initialization": 1755872861.4963958,
        "attack_execution": 1755872861.5229409,
        "monitoring_accumulation": 1755872882.6308181,
        "agent_analysis": 1755872932.6337953,
        "firewall_update_wait": 1755873020.6663537,
        "metrics_collection": 1755873022.66736,
        "epoch_complete": 1755873022.6895056
      },
      "services_detected": [
        "PATROL-SNMP(172.20.0.4:8161)",
        "HTTP-PROXY(172.20.0.3:8080)",
        "HTTP(172.20.0.5:80)",
        "UNKNOWN(172.20.0.4:61616)",
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB",
        "STRUTS"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "STRUTS",
          "flag": "flag{privileged_access_struts}"
        },
        {
          "service": "GITLAB",
          "flag": "flag{user_access_gitlab}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #7:    ACCEPT     tcp  --  172.20.0.5           192.168.100.0/24",
            "REMOVED rule #8:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.5"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.4",
        "service": "cve-2015-5254-activemq-1",
        "current_level": 33,
        "epoch": 4
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "ET SCAN Potential SSH Scan"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "SURICATA Applayer Detect protocol only one direction"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "Reverse Shell Detected - No Job Control",
            "cat /home/ctf/user.txt"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "cat /root/root.txt",
            "flag{privileged_access_struts}",
            "Reverse Shell Detected - No Job Control"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "edge_id": "c99e98f27042",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Potential SSH Scan"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 1,
            "last_seen": 4,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "edge_id": "de43ae179be7",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "SURICATA Applayer Detect protocol only one direction"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 1,
            "last_seen": 4,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "37e86c92435b",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Reverse Shell Detected - No Job Control"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-user",
                "confidence": 1.0,
                "evidence_quotes": [
                  "cat /home/ctf/user.txt"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "data-exfil-user",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "4b579f6c3e86",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Potential SSH Scan"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL/javalang RCE attempt",
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-user",
                "confidence": 1.0,
                "evidence_quotes": [
                  "find / -type f -name 'root.txt'"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "privilege-escalation",
                "confidence": 1.0,
                "evidence_quotes": [
                  "cat /root/root.txt"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-root",
                "confidence": 1.0,
                "evidence_quotes": [
                  "flag{privileged_access_struts}"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 4,
            "current_phase": "data-exfil-root",
            "confidence": 1.0
          }
        ],
        "edge_updates": [
          {
            "edge_id": "4b579f6c3e86",
            "added_phases": [
              "privilege-escalation",
              "data-exfil-root"
            ],
            "seen_in_epoch": 4
          },
          {
            "edge_id": "37e86c92435b",
            "added_phases": [
              "data-exfil-user"
            ],
            "seen_in_epoch": 4
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 5,
      "start_time": 1755873023.6935866,
      "end_time": 1755873186.8767898,
      "phase_timings": {
        "initialization": 1755873023.6936007,
        "attack_execution": 1755873023.711089,
        "monitoring_accumulation": 1755873046.2423077,
        "agent_analysis": 1755873096.2432768,
        "firewall_update_wait": 1755873184.8640685,
        "metrics_collection": 1755873186.8653255,
        "epoch_complete": 1755873186.87611
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.3:8080)",
        "PATROL-SNMP(172.20.0.4:8161)",
        "HTTP(172.20.0.10:80)",
        "UNKNOWN(172.20.0.4:61616)"
      ],
      "services_successfully_exploited": [
        "STRUTS",
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{privileged_access_gitlab}"
        },
        {
          "service": "STRUTS",
          "flag": "flag{privileged_access_struts}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10",
            "REMOVED rule #5:    ACCEPT     tcp  --  172.20.0.3           192.168.100.0/24",
            "REMOVED rule #6:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.4",
        "service": "cve-2015-5254-activemq-1",
        "current_level": 33,
        "epoch": 5
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "ET SCAN Behavioral Unusually fast Terminal Server Traffic Potential Scan or Infection (Inbound)"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "SURICATA Applayer Detect protocol only one direction"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 66,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "Privilege Escalation Attempt - bash -p",
            "SUID Binary Enumeration Detected",
            "Reverse Shell Detected - No Job Control",
            "flag{privileged_access_gitlab}"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": [
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
            "flag{privileged_access_struts}",
            "Reverse Shell Detected - No Job Control"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "edge_id": "c99e98f27042",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Behavioral Unusually fast Terminal Server Traffic Potential Scan or Infection (Inbound)"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 1,
            "last_seen": 5,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "edge_id": "de43ae179be7",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "SURICATA Applayer Detect protocol only one direction"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 1,
            "last_seen": 5,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "37e86c92435b",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Reverse Shell Detected - No Job Control"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-user",
                "confidence": 1.0,
                "evidence_quotes": [
                  "cat /home/ctf/user.txt"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "privilege-escalation",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "SUID Binary Enumeration Detected"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "data-exfil-root",
                "confidence": 1.0,
                "evidence_quotes": [
                  "flag{privileged_access_gitlab}"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 3,
            "last_seen": 5,
            "current_phase": "data-exfil-root",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "4b579f6c3e86",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Potential SSH Scan"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL/javalang RCE attempt",
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-user",
                "confidence": 1.0,
                "evidence_quotes": [
                  "find / -type f -name 'root.txt'"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "privilege-escalation",
                "confidence": 1.0,
                "evidence_quotes": [
                  "cat /root/root.txt"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-root",
                "confidence": 1.0,
                "evidence_quotes": [
                  "flag{privileged_access_struts}"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 5,
            "current_phase": "data-exfil-root",
            "confidence": 1.0
          }
        ],
        "edge_updates": [
          {
            "edge_id": "37e86c92435b",
            "added_phases": [
              "privilege-escalation",
              "data-exfil-root"
            ],
            "seen_in_epoch": 5
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 6,
      "start_time": 1755873187.8806226,
      "end_time": 1755873351.6664941,
      "phase_timings": {
        "initialization": 1755873187.8806472,
        "attack_execution": 1755873187.8919027,
        "monitoring_accumulation": 1755873193.0066538,
        "agent_analysis": 1755873243.0092406,
        "firewall_update_wait": 1755873349.6310525,
        "metrics_collection": 1755873351.633114,
        "epoch_complete": 1755873351.665347
      },
      "services_detected": [
        "UNKNOWN(172.20.0.4:61616)",
        "PATROL-SNMP(172.20.0.4:8161)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.5 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.5 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.3 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.4",
        "service": "cve-2015-5254-activemq-1",
        "current_level": 33,
        "epoch": 6
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "ET SCAN Behavioral Unusually fast Terminal Server Traffic Potential Scan or Infection (Inbound)"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "SURICATA Applayer Detect protocol only one direction"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": [
            "Privilege Escalation Attempt - bash -p",
            "SUID Binary Enumeration Detected",
            "Reverse Shell Detected - No Job Control",
            "flag{privileged_access_gitlab}"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": [
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
            "flag{privileged_access_struts}",
            "Reverse Shell Detected - No Job Control"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "edge_id": "c99e98f27042",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Behavioral Unusually fast Terminal Server Traffic Potential Scan or Infection (Inbound)"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 1,
            "last_seen": 5,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "edge_id": "de43ae179be7",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "SURICATA Applayer Detect protocol only one direction"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 1,
            "last_seen": 5,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "37e86c92435b",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Reverse Shell Detected - No Job Control"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-user",
                "confidence": 1.0,
                "evidence_quotes": [
                  "cat /home/ctf/user.txt"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "privilege-escalation",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "SUID Binary Enumeration Detected"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "data-exfil-root",
                "confidence": 1.0,
                "evidence_quotes": [
                  "flag{privileged_access_gitlab}"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 3,
            "last_seen": 5,
            "current_phase": "data-exfil-root",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "4b579f6c3e86",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Potential SSH Scan"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL/javalang RCE attempt",
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-user",
                "confidence": 1.0,
                "evidence_quotes": [
                  "find / -type f -name 'root.txt'"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "privilege-escalation",
                "confidence": 1.0,
                "evidence_quotes": [
                  "cat /root/root.txt"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-root",
                "confidence": 1.0,
                "evidence_quotes": [
                  "flag{privileged_access_struts}"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 5,
            "current_phase": "data-exfil-root",
            "confidence": 1.0
          }
        ],
        "edge_updates": [
          {
            "edge_id": "37e86c92435b",
            "added_phases": [
              "privilege-escalation",
              "data-exfil-root"
            ],
            "seen_in_epoch": 5
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 7,
      "start_time": 1755873352.6720886,
      "end_time": 1755873531.4999971,
      "phase_timings": {
        "initialization": 1755873352.672111,
        "attack_execution": 1755873352.6951878,
        "monitoring_accumulation": 1755873374.4023678,
        "agent_analysis": 1755873424.4036078,
        "firewall_update_wait": 1755873529.4668355,
        "metrics_collection": 1755873531.4680715,
        "epoch_complete": 1755873531.4988923
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)",
        "UNKNOWN(172.20.0.4:61616)",
        "HTTP-PROXY(172.20.0.3:8080)",
        "PATROL-SNMP(172.20.0.4:8161)",
        "HTTP(172.20.0.5:80)"
      ],
      "services_successfully_exploited": [
        "STRUTS",
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "STRUTS",
          "flag": "flag{privileged_access_struts}"
        },
        {
          "service": "GITLAB",
          "flag": "flag{privileged_access_gitlab}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10",
            "REMOVED rule #3:    ACCEPT     tcp  --  172.20.0.3           192.168.100.0/24",
            "REMOVED rule #4:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3",
            "REMOVED rule #5:    ACCEPT     tcp  --  172.20.0.5           192.168.100.0/24",
            "REMOVED rule #6:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.5"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.4",
        "service": "cve-2015-5254-activemq-1",
        "current_level": 33,
        "epoch": 7
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "ET SCAN Behavioral Unusually fast Terminal Server Traffic Potential Scan or Infection (Inbound)"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "SURICATA Applayer Detect protocol only one direction"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": [
            "Privilege Escalation Attempt - bash -p",
            "SUID Binary Enumeration Detected",
            "Reverse Shell Detected - No Job Control",
            "flag{privileged_access_gitlab}"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": [
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
            "flag{privileged_access_struts}",
            "Reverse Shell Detected - No Job Control"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "edge_id": "c99e98f27042",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Behavioral Unusually fast Terminal Server Traffic Potential Scan or Infection (Inbound)"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 1,
            "last_seen": 5,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "edge_id": "de43ae179be7",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "SURICATA Applayer Detect protocol only one direction"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 1,
            "last_seen": 5,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "37e86c92435b",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Reverse Shell Detected - No Job Control"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-user",
                "confidence": 1.0,
                "evidence_quotes": [
                  "cat /home/ctf/user.txt"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "privilege-escalation",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "SUID Binary Enumeration Detected"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "data-exfil-root",
                "confidence": 1.0,
                "evidence_quotes": [
                  "flag{privileged_access_gitlab}"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 3,
            "last_seen": 5,
            "current_phase": "data-exfil-root",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "4b579f6c3e86",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Potential SSH Scan"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL/javalang RCE attempt",
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-user",
                "confidence": 1.0,
                "evidence_quotes": [
                  "find / -type f -name 'root.txt'"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "privilege-escalation",
                "confidence": 1.0,
                "evidence_quotes": [
                  "cat /root/root.txt"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-root",
                "confidence": 1.0,
                "evidence_quotes": [
                  "flag{privileged_access_struts}"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 5,
            "current_phase": "data-exfil-root",
            "confidence": 1.0
          }
        ],
        "edge_updates": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 8,
      "start_time": 1755873532.5063362,
      "end_time": 1755873669.2433167,
      "phase_timings": {
        "initialization": 1755873532.506361,
        "attack_execution": 1755873532.5238936,
        "monitoring_accumulation": 1755873537.727026,
        "agent_analysis": 1755873587.7283702,
        "firewall_update_wait": 1755873667.22528,
        "metrics_collection": 1755873669.2263026,
        "epoch_complete": 1755873669.242432
      },
      "services_detected": [
        "UNKNOWN(172.20.0.4:61616)",
        "PATROL-SNMP(172.20.0.4:8161)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.4           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.4"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "",
        "service": "",
        "current_level": 0,
        "epoch": 8
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "ET INFO POSSIBLE Web Crawl using Curl",
            "SURICATA Applayer Detect protocol only one direction",
            "POSSBL PORT SCAN (NMAP -sS)"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": [
            "Privilege Escalation Attempt - bash -p",
            "SUID Binary Enumeration Detected",
            "Reverse Shell Detected - No Job Control",
            "flag{privileged_access_gitlab}"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": [
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
            "flag{privileged_access_struts}",
            "Reverse Shell Detected - No Job Control"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "edge_id": "c99e98f27042",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "ET SCAN Behavioral Unusually fast Terminal Server Traffic Potential Scan or Infection (Inbound)"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 1,
            "last_seen": 5,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "edge_id": "de43ae179be7",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)",
                  "SURICATA Applayer Detect protocol only one direction"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 1,
            "last_seen": 5,
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "edge_id": "37e86c92435b",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Reverse Shell Detected - No Job Control"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-user",
                "confidence": 1.0,
                "evidence_quotes": [
                  "cat /home/ctf/user.txt"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "privilege-escalation",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "SUID Binary Enumeration Detected"
                ],
                "seen_in_epoch": 5
              },
              {
                "phase": "data-exfil-root",
                "confidence": 1.0,
                "evidence_quotes": [
                  "flag{privileged_access_gitlab}"
                ],
                "seen_in_epoch": 5
              }
            ],
            "first_seen": 3,
            "last_seen": 5,
            "current_phase": "data-exfil-root",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "edge_id": "4b579f6c3e86",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Potential SSH Scan"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET WEB_SPECIFIC_APPS Apache Struts OGNL/javalang RCE attempt",
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-user",
                "confidence": 1.0,
                "evidence_quotes": [
                  "find / -type f -name 'root.txt'"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "privilege-escalation",
                "confidence": 1.0,
                "evidence_quotes": [
                  "cat /root/root.txt"
                ],
                "seen_in_epoch": 4
              },
              {
                "phase": "data-exfil-root",
                "confidence": 1.0,
                "evidence_quotes": [
                  "flag{privileged_access_struts}"
                ],
                "seen_in_epoch": 4
              }
            ],
            "first_seen": 3,
            "last_seen": 5,
            "current_phase": "data-exfil-root",
            "confidence": 1.0
          }
        ],
        "edge_updates": []
      },
      "service_epoch_context": [],
      "lockdown_activated": true
    }
  ],
  "summary": {
    "total_flags_captured": 6,
    "average_epoch_duration": 161.91733780503273,
    "lockdown_triggered": true,
    "lockdown_epoch": 8,
    "final_honeypots_exploitation": [
      {
        "ip": "172.20.0.5",
        "service": "cve-2014-6271-web-1",
        "level_prev": 33,
        "level_new": 33,
        "changed": false,
        "evidence_quotes": [
          "POSSBL PORT SCAN (NMAP -sS)"
        ]
      },
      {
        "ip": "172.20.0.4",
        "service": "cve-2015-5254-activemq-1",
        "level_prev": 33,
        "level_new": 33,
        "changed": false,
        "evidence_quotes": [
          "ET INFO POSSIBLE Web Crawl using Curl",
          "SURICATA Applayer Detect protocol only one direction",
          "POSSBL PORT SCAN (NMAP -sS)"
        ]
      },
      {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": [
          "Privilege Escalation Attempt - bash -p",
          "SUID Binary Enumeration Detected",
          "Reverse Shell Detected - No Job Control",
          "flag{privileged_access_gitlab}"
        ]
      },
      {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": [
          "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
          "flag{privileged_access_struts}",
          "Reverse Shell Detected - No Job Control"
        ]
      }
    ],
    "final_inferred_attack_graph": {
      "interesting": [
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "confidence": 1.0
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "confidence": 1.0
        }
      ],
      "edges": [
        {
          "from": "192.168.100.2",
          "to": "172.20.0.5",
          "edge_id": "c99e98f27042",
          "vector": "scan",
          "phases": [
            {
              "phase": "scan",
              "confidence": 1.0,
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS)",
                "ET SCAN Behavioral Unusually fast Terminal Server Traffic Potential Scan or Infection (Inbound)"
              ],
              "seen_in_epoch": 5
            }
          ],
          "first_seen": 1,
          "last_seen": 5,
          "current_phase": "scan",
          "confidence": 1.0
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.4",
          "edge_id": "de43ae179be7",
          "vector": "scan",
          "phases": [
            {
              "phase": "scan",
              "confidence": 1.0,
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS)",
                "SURICATA Applayer Detect protocol only one direction"
              ],
              "seen_in_epoch": 5
            }
          ],
          "first_seen": 1,
          "last_seen": 5,
          "current_phase": "scan",
          "confidence": 1.0
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.10",
          "edge_id": "37e86c92435b",
          "vector": "privilege-escalation",
          "phases": [
            {
              "phase": "scan",
              "confidence": 1.0,
              "evidence_quotes": [
                "ET INFO User-Agent (python-requests) Inbound to Webserver"
              ],
              "seen_in_epoch": 4
            },
            {
              "phase": "initial-access/rce",
              "confidence": 1.0,
              "evidence_quotes": [
                "Reverse Shell Detected - No Job Control"
              ],
              "seen_in_epoch": 4
            },
            {
              "phase": "data-exfil-user",
              "confidence": 1.0,
              "evidence_quotes": [
                "cat /home/ctf/user.txt"
              ],
              "seen_in_epoch": 4
            },
            {
              "phase": "privilege-escalation",
              "confidence": 1.0,
              "evidence_quotes": [
                "Privilege Escalation Attempt - bash -p",
                "SUID Binary Enumeration Detected"
              ],
              "seen_in_epoch": 5
            },
            {
              "phase": "data-exfil-root",
              "confidence": 1.0,
              "evidence_quotes": [
                "flag{privileged_access_gitlab}"
              ],
              "seen_in_epoch": 5
            }
          ],
          "first_seen": 3,
          "last_seen": 5,
          "current_phase": "data-exfil-root",
          "confidence": 1.0
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.3",
          "edge_id": "4b579f6c3e86",
          "vector": "privilege-escalation",
          "phases": [
            {
              "phase": "scan",
              "confidence": 1.0,
              "evidence_quotes": [
                "ET SCAN Potential SSH Scan"
              ],
              "seen_in_epoch": 4
            },
            {
              "phase": "initial-access/rce",
              "confidence": 1.0,
              "evidence_quotes": [
                "ET WEB_SPECIFIC_APPS Apache Struts OGNL/javalang RCE attempt",
                "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
              ],
              "seen_in_epoch": 4
            },
            {
              "phase": "data-exfil-user",
              "confidence": 1.0,
              "evidence_quotes": [
                "find / -type f -name 'root.txt'"
              ],
              "seen_in_epoch": 4
            },
            {
              "phase": "privilege-escalation",
              "confidence": 1.0,
              "evidence_quotes": [
                "cat /root/root.txt"
              ],
              "seen_in_epoch": 4
            },
            {
              "phase": "data-exfil-root",
              "confidence": 1.0,
              "evidence_quotes": [
                "flag{privileged_access_struts}"
              ],
              "seen_in_epoch": 4
            }
          ],
          "first_seen": 3,
          "last_seen": 5,
          "current_phase": "data-exfil-root",
          "confidence": 1.0
        }
      ],
      "edge_updates": []
    }
  }
}