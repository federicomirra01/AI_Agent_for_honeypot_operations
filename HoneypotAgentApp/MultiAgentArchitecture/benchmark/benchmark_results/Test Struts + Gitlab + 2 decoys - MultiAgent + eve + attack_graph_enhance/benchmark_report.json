{
  "config": {
    "max_epochs": 10,
    "attacker_image": "attacker:latest",
    "attacker_container_name": "attackercontainer-attacker",
    "attack_duration": 200,
    "monitor_accumulation_wait": 50,
    "firewall_update_wait": 2,
    "between_epoch_wait": 1,
    "attacker_network": "192.168.100.0/24",
    "honeypot_network": "172.20.0.0/24",
    "firewall_api_url": "http://192.168.200.2:5000",
    "allow_full_compromise": true,
    "stop_on_lockdown": true,
    "clear_memory_between_epochs": false,
    "results_dir": "./benchmark_results",
    "dir_name": "Test Struts + Gitlab + 2 decoys - MultiAgent + eve + attack_graph_enhance",
    "save_detailed_logs": true,
    "log_level": "INFO"
  },
  "start_time": 1754823617.2082653,
  "end_time": 1754824058.672948,
  "total_epochs": 4,
  "epochs": [
    {
      "epoch_number": 1,
      "start_time": 1754823617.2082653,
      "end_time": 1754823713.479569,
      "phase_timings": {
        "initialization": 1754823617.2082872,
        "attack_execution": 1754823617.2230935,
        "monitoring_accumulation": 1754823624.0519361,
        "agent_analysis": 1754823674.053313,
        "firewall_update_wait": 1754823711.4613657,
        "metrics_collection": 1754823713.4631786,
        "epoch_complete": 1754823713.4787576
      },
      "services_detected": [],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.2 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.2",
        "service": "struts2",
        "current_level": 33
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.6",
          "service": "activemq",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 5"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "gitlab-proxy",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 5",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "struts2",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 14",
            "ET SCAN Potential SSH Scan: 1",
            "ET SCAN Suspicious inbound to mySQL port 3306: 2",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "web",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 5",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 2",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.6",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "6a1bb9ac2b0d",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 1,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 5"
                ],
                "seen_in_epoch": 1,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "54bbc3a87084",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 1,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 5",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
                ],
                "seen_in_epoch": 1,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "e326e4ea7171",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 1,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 14",
                  "ET SCAN Potential SSH Scan: 1",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
                ],
                "seen_in_epoch": 1,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "eea461f778ce",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 1,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 5",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1"
                ],
                "seen_in_epoch": 1,
                "confidence": 0.33
              }
            ]
          }
        ]
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 2,
      "start_time": 1754823714.4841409,
      "end_time": 1754823834.7988684,
      "phase_timings": {
        "initialization": 1754823714.4841661,
        "attack_execution": 1754823714.4982126,
        "monitoring_accumulation": 1754823727.4723933,
        "agent_analysis": 1754823777.473606,
        "firewall_update_wait": 1754823832.7798579,
        "metrics_collection": 1754823834.7817109,
        "epoch_complete": 1754823834.7982492
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.2:8080)"
      ],
      "services_successfully_exploited": [
        "STRUTS"
      ],
      "exploits_attempted": [
        "HTTP-PROXY(172.20.0.2:8080)"
      ],
      "flags_captured": [
        {
          "service": "STRUTS",
          "flag": "flag{privileged_struts}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.6 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.7 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.2           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.2"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "gitlab-proxy",
        "current_level": 33
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.6",
          "service": "activemq",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 10"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "gitlab-proxy",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 7",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "struts2",
          "level_prev": 33,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "ET EXPLOIT/WEB_SERVER Possible Apache Struts OGNL Java Exec In URI: 8 events",
            "ET WEB_SPECIFIC_APPS Apache Struts [OGNL injection RCE]: 8 events",
            "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 4 events",
            "Reverse Shell Detected - No Job Control: 2 events",
            "found root.txt, cat /root/root.txt, flag{privileged_struts}"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "web",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 9",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1",
            "ET SCAN Behavioral Unusually fast Terminal Server Traffic Potential Scan or Infection (Inbound): 1 event",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "struts2",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.6",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "6a1bb9ac2b0d",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 2,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 5",
                  "POSSBL PORT SCAN (NMAP -sS): 10"
                ],
                "seen_in_epoch": 2,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "54bbc3a87084",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 2,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 5",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 7",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
                ],
                "seen_in_epoch": 2,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "scan",
            "confidence": 1.0,
            "edge_id": "e326e4ea7171",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 2,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 14",
                  "ET SCAN Potential SSH Scan: 1",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
                ],
                "seen_in_epoch": 2,
                "confidence": 0.33
              },
              {
                "phase": "initial-access/rce",
                "first_seen": 2,
                "last_seen": 2,
                "evidence_quotes": [
                  "ET EXPLOIT/WEB_SERVER Possible Apache Struts OGNL Java Exec In URI: 8 events",
                  "ET WEB_SPECIFIC_APPS Apache Struts [OGNL injection RCE]: 8 events"
                ],
                "seen_in_epoch": 2,
                "confidence": 0.66
              },
              {
                "phase": "privilege-escalation",
                "first_seen": 2,
                "last_seen": 2,
                "evidence_quotes": [
                  "Reverse Shell Detected - No Job Control: 2 events",
                  "found root.txt, cat /root/root.txt, flag{privileged_struts}"
                ],
                "seen_in_epoch": 2,
                "confidence": 1.0
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "eea461f778ce",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 2,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 5",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 9",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "ET SCAN Behavioral Unusually fast Terminal Server Traffic Potential Scan or Infection (Inbound): 1 event",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
                ],
                "seen_in_epoch": 2,
                "confidence": 0.33
              }
            ]
          }
        ]
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 3,
      "start_time": 1754823835.8087585,
      "end_time": 1754823954.6621735,
      "phase_timings": {
        "initialization": 1754823835.8087704,
        "attack_execution": 1754823835.8235548,
        "monitoring_accumulation": 1754823853.7847924,
        "agent_analysis": 1754823903.786165,
        "firewall_update_wait": 1754823952.6439767,
        "metrics_collection": 1754823954.6457515,
        "epoch_complete": 1754823954.6614475
      },
      "services_detected": [
        "UNKNOWN(172.20.0.6:61616)",
        "HTTP(172.20.0.7:80)",
        "HTTP(172.20.0.10:80)",
        "PATROL-SNMP(172.20.0.6:8161)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [
        "HTTP(172.20.0.7:80)",
        "HTTP(172.20.0.10:80)"
      ],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{user_access}"
        }
      ],
      "attack_success_rate": 50.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.7",
            "REMOVED rule #3:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #4:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.6",
        "service": "activemq",
        "current_level": 33
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.6",
          "service": "activemq",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "ET INFO POSSIBLE Web Crawl using Curl (1)",
            "Port scan (NMAP -sS) (20+)",
            "Suspicious inbound to MSSQL 1433 (4)"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "gitlab-proxy",
          "level_prev": 33,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "Reverse Shell Detected - No Job Control (2)",
            "User-Level File Discovery - find binary execution (4)",
            "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer (2)",
            "Outbound flag exfiltration: cat /home/ctf/user.txt"
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "struts2",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": [
            "ET EXPLOIT/WEB_SERVER Possible Apache Struts OGNL Java Exec In URI: 8 events",
            "ET WEB_SPECIFIC_APPS Apache Struts [OGNL injection RCE]: 8 events",
            "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 4 events",
            "Reverse Shell Detected - No Job Control: 2 events",
            "found root.txt, cat /root/root.txt, flag{privileged_struts}"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "web",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "Port scan (NMAP -sS) (10+)",
            "Suspicious inbound to MySQL 3306 and MSSQL 1433 (4+)"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "gitlab-proxy",
            "confidence": 0.66
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.6",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "6a1bb9ac2b0d",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 3,
                "evidence_quotes": [
                  "ET INFO POSSIBLE Web Crawl using Curl (1)",
                  "Port scan (NMAP -sS) (20+)",
                  "Suspicious inbound to MSSQL 1433 (4)"
                ],
                "seen_in_epoch": 3,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "54bbc3a87084",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 3,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver (4)"
                ],
                "seen_in_epoch": 3,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "initial-access/rce",
            "confidence": 0.66,
            "edge_id": "54bbc3a87084",
            "phases": [
              {
                "phase": "initial-access/rce",
                "first_seen": 3,
                "last_seen": 3,
                "evidence_quotes": [
                  "Reverse Shell Detected - No Job Control (2)",
                  "User-Level File Discovery - find binary execution (4)",
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer (2)",
                  "Outbound flag exfiltration: cat /home/ctf/user.txt"
                ],
                "seen_in_epoch": 3,
                "confidence": 0.66
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "scan",
            "confidence": 1.0,
            "edge_id": "e326e4ea7171",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 2,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 14",
                  "ET SCAN Potential SSH Scan: 1",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
                ],
                "seen_in_epoch": 2,
                "confidence": 0.33
              },
              {
                "phase": "initial-access/rce",
                "first_seen": 2,
                "last_seen": 2,
                "evidence_quotes": [
                  "ET EXPLOIT/WEB_SERVER Possible Apache Struts OGNL Java Exec In URI: 8 events",
                  "ET WEB_SPECIFIC_APPS Apache Struts [OGNL injection RCE]: 8 events"
                ],
                "seen_in_epoch": 2,
                "confidence": 0.66
              },
              {
                "phase": "privilege-escalation",
                "first_seen": 2,
                "last_seen": 2,
                "evidence_quotes": [
                  "Reverse Shell Detected - No Job Control: 2 events",
                  "found root.txt, cat /root/root.txt, flag{privileged_struts}"
                ],
                "seen_in_epoch": 2,
                "confidence": 1.0
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "eea461f778ce",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 3,
                "evidence_quotes": [
                  "Port scan (NMAP -sS) (10+)",
                  "Suspicious inbound to MySQL 3306 and MSSQL 1433 (4+)"
                ],
                "seen_in_epoch": 3,
                "confidence": 0.33
              }
            ]
          }
        ]
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 4,
      "start_time": 1754823955.6667426,
      "end_time": 1754824058.672948,
      "phase_timings": {
        "initialization": 1754823955.6667576,
        "attack_execution": 1754823955.6838238,
        "monitoring_accumulation": 1754823960.932898,
        "agent_analysis": 1754824010.9346178,
        "firewall_update_wait": 1754824056.655567,
        "metrics_collection": 1754824058.6577823,
        "epoch_complete": 1754824058.6721013
      },
      "services_detected": [
        "PATROL-SNMP(172.20.0.6:8161)",
        "UNKNOWN(172.20.0.6:61616)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.6"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "none",
        "service": "none",
        "current_level": 0
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.6",
          "service": "activemq",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "ET INFO POSSIBLE Web Crawl using Curl (1)",
            "Port scan (NMAP -sS) (20+)",
            "Suspicious inbound to MSSQL 1433 (4)"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "gitlab-proxy",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "Reverse Shell Detected - No Job Control (2)",
            "User-Level File Discovery - find binary execution (4)",
            "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer (2)",
            "Outbound flag exfiltration: cat /home/ctf/user.txt"
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "struts2",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": [
            "ET EXPLOIT/WEB_SERVER Possible Apache Struts OGNL Java Exec In URI: 8 events",
            "ET WEB_SPECIFIC_APPS Apache Struts [OGNL injection RCE]: 8 events",
            "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 4 events",
            "Reverse Shell Detected - No Job Control: 2 events",
            "found root.txt, cat /root/root.txt, flag{privileged_struts}"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "web",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "Port scan (NMAP -sS) (10+)",
            "Suspicious inbound to MySQL 3306 and MSSQL 1433 (4+)"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "gitlab-proxy",
            "confidence": 0.66
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.6",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "6a1bb9ac2b0d",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 3,
                "evidence_quotes": [
                  "ET INFO POSSIBLE Web Crawl using Curl (1)",
                  "Port scan (NMAP -sS) (20+)",
                  "Suspicious inbound to MSSQL 1433 (4)"
                ],
                "seen_in_epoch": 3,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "54bbc3a87084",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 3,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver (4)"
                ],
                "seen_in_epoch": 3,
                "confidence": 0.33
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "initial-access/rce",
            "confidence": 0.66,
            "edge_id": "54bbc3a87084",
            "phases": [
              {
                "phase": "initial-access/rce",
                "first_seen": 3,
                "last_seen": 3,
                "evidence_quotes": [
                  "Reverse Shell Detected - No Job Control (2)",
                  "User-Level File Discovery - find binary execution (4)",
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer (2)",
                  "Outbound flag exfiltration: cat /home/ctf/user.txt"
                ],
                "seen_in_epoch": 3,
                "confidence": 0.66
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "scan",
            "confidence": 1.0,
            "edge_id": "e326e4ea7171",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 2,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 14",
                  "ET SCAN Potential SSH Scan: 1",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
                ],
                "seen_in_epoch": 2,
                "confidence": 0.33
              },
              {
                "phase": "initial-access/rce",
                "first_seen": 2,
                "last_seen": 2,
                "evidence_quotes": [
                  "ET EXPLOIT/WEB_SERVER Possible Apache Struts OGNL Java Exec In URI: 8 events",
                  "ET WEB_SPECIFIC_APPS Apache Struts [OGNL injection RCE]: 8 events"
                ],
                "seen_in_epoch": 2,
                "confidence": 0.66
              },
              {
                "phase": "privilege-escalation",
                "first_seen": 2,
                "last_seen": 2,
                "evidence_quotes": [
                  "Reverse Shell Detected - No Job Control: 2 events",
                  "found root.txt, cat /root/root.txt, flag{privileged_struts}"
                ],
                "seen_in_epoch": 2,
                "confidence": 1.0
              }
            ]
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "vector": "scan",
            "confidence": 0.33,
            "edge_id": "eea461f778ce",
            "phases": [
              {
                "phase": "scan",
                "first_seen": 1,
                "last_seen": 3,
                "evidence_quotes": [
                  "Port scan (NMAP -sS) (10+)",
                  "Suspicious inbound to MySQL 3306 and MSSQL 1433 (4+)"
                ],
                "seen_in_epoch": 3,
                "confidence": 0.33
              }
            ]
          }
        ]
      },
      "lockdown_activated": true
    }
  ],
  "summary": {
    "total_flags_captured": 2,
    "average_epoch_duration": 109.61141288280487,
    "lockdown_triggered": true,
    "lockdown_epoch": 4,
    "final_honeypots_exploitation": [
      {
        "ip": "172.20.0.6",
        "service": "activemq",
        "level_prev": 33,
        "level_new": 33,
        "changed": false,
        "evidence_quotes": [
          "ET INFO POSSIBLE Web Crawl using Curl (1)",
          "Port scan (NMAP -sS) (20+)",
          "Suspicious inbound to MSSQL 1433 (4)"
        ]
      },
      {
        "ip": "172.20.0.10",
        "service": "gitlab-proxy",
        "level_prev": 66,
        "level_new": 66,
        "changed": false,
        "evidence_quotes": [
          "Reverse Shell Detected - No Job Control (2)",
          "User-Level File Discovery - find binary execution (4)",
          "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer (2)",
          "Outbound flag exfiltration: cat /home/ctf/user.txt"
        ]
      },
      {
        "ip": "172.20.0.2",
        "service": "struts2",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": [
          "ET EXPLOIT/WEB_SERVER Possible Apache Struts OGNL Java Exec In URI: 8 events",
          "ET WEB_SPECIFIC_APPS Apache Struts [OGNL injection RCE]: 8 events",
          "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 4 events",
          "Reverse Shell Detected - No Job Control: 2 events",
          "found root.txt, cat /root/root.txt, flag{privileged_struts}"
        ]
      },
      {
        "ip": "172.20.0.7",
        "service": "web",
        "level_prev": 33,
        "level_new": 33,
        "changed": false,
        "evidence_quotes": [
          "Port scan (NMAP -sS) (10+)",
          "Suspicious inbound to MySQL 3306 and MSSQL 1433 (4+)"
        ]
      }
    ],
    "final_inferred_attack_graph": {
      "interesting": [
        {
          "ip": "172.20.0.10",
          "service": "gitlab-proxy",
          "confidence": 0.66
        }
      ],
      "edges": [
        {
          "from": "192.168.100.2",
          "to": "172.20.0.6",
          "vector": "scan",
          "confidence": 0.33,
          "edge_id": "6a1bb9ac2b0d",
          "phases": [
            {
              "phase": "scan",
              "first_seen": 1,
              "last_seen": 3,
              "evidence_quotes": [
                "ET INFO POSSIBLE Web Crawl using Curl (1)",
                "Port scan (NMAP -sS) (20+)",
                "Suspicious inbound to MSSQL 1433 (4)"
              ],
              "seen_in_epoch": 3,
              "confidence": 0.33
            }
          ]
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.10",
          "vector": "scan",
          "confidence": 0.33,
          "edge_id": "54bbc3a87084",
          "phases": [
            {
              "phase": "scan",
              "first_seen": 1,
              "last_seen": 3,
              "evidence_quotes": [
                "ET INFO User-Agent (python-requests) Inbound to Webserver (4)"
              ],
              "seen_in_epoch": 3,
              "confidence": 0.33
            }
          ]
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.10",
          "vector": "initial-access/rce",
          "confidence": 0.66,
          "edge_id": "54bbc3a87084",
          "phases": [
            {
              "phase": "initial-access/rce",
              "first_seen": 3,
              "last_seen": 3,
              "evidence_quotes": [
                "Reverse Shell Detected - No Job Control (2)",
                "User-Level File Discovery - find binary execution (4)",
                "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer (2)",
                "Outbound flag exfiltration: cat /home/ctf/user.txt"
              ],
              "seen_in_epoch": 3,
              "confidence": 0.66
            }
          ]
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.2",
          "vector": "scan",
          "confidence": 1.0,
          "edge_id": "e326e4ea7171",
          "phases": [
            {
              "phase": "scan",
              "first_seen": 1,
              "last_seen": 2,
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS): 14",
                "ET SCAN Potential SSH Scan: 1",
                "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                "ET SCAN Suspicious inbound to MSSQL port 1433: 2"
              ],
              "seen_in_epoch": 2,
              "confidence": 0.33
            },
            {
              "phase": "initial-access/rce",
              "first_seen": 2,
              "last_seen": 2,
              "evidence_quotes": [
                "ET EXPLOIT/WEB_SERVER Possible Apache Struts OGNL Java Exec In URI: 8 events",
                "ET WEB_SPECIFIC_APPS Apache Struts [OGNL injection RCE]: 8 events"
              ],
              "seen_in_epoch": 2,
              "confidence": 0.66
            },
            {
              "phase": "privilege-escalation",
              "first_seen": 2,
              "last_seen": 2,
              "evidence_quotes": [
                "Reverse Shell Detected - No Job Control: 2 events",
                "found root.txt, cat /root/root.txt, flag{privileged_struts}"
              ],
              "seen_in_epoch": 2,
              "confidence": 1.0
            }
          ]
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.7",
          "vector": "scan",
          "confidence": 0.33,
          "edge_id": "eea461f778ce",
          "phases": [
            {
              "phase": "scan",
              "first_seen": 1,
              "last_seen": 3,
              "evidence_quotes": [
                "Port scan (NMAP -sS) (10+)",
                "Suspicious inbound to MySQL 3306 and MSSQL 1433 (4+)"
              ],
              "seen_in_epoch": 3,
              "confidence": 0.33
            }
          ]
        }
      ]
    }
  }
}