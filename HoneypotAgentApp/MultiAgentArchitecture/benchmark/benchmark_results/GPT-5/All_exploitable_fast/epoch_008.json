{
  "epoch_number": 8,
  "start_time": 1756309605.4267216,
  "end_time": 1756309871.2913635,
  "phase_timings": {
    "initialization": 1756309605.426732,
    "attack_execution": 1756309605.4409008,
    "monitoring_accumulation": 1756309619.0808618,
    "agent_analysis": 1756309669.0822785,
    "firewall_update_wait": 1756309869.264999,
    "metrics_collection": 1756309871.2660844,
    "epoch_complete": 1756309871.2905114
  },
  "services_detected": [
    "HTTP-PROXY(172.20.0.3:8080)"
  ],
  "services_successfully_exploited": [
    "STRUTS"
  ],
  "exploits_attempted": [],
  "flags_captured": [
    {
      "service": "STRUTS",
      "flag": "flag{privileged_access_struts}"
    }
  ],
  "attack_success_rate": 0.0,
  "firewall_rules_added": [
    {
      "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2:2375 (tcp)"
    },
    {
      "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2:2376 (tcp)"
    },
    {
      "rules_added_current_epoch": "ALLOW 172.20.0.2 -> 192.168.100.0/24 (tcp)"
    }
  ],
  "firewall_rules_removed": [
    {
      "rules_removed_current_epoch": [
        "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.3           192.168.100.0/24",
        "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3           tcp dpt:8080"
      ]
    }
  ],
  "honeypots_exposed": {
    "ip": "172.20.0.2",
    "service": "unauthorized-rce-docker-1",
    "current_level": 0,
    "epoch": 8
  },
  "honeypots_exploitation": [
    {
      "ip": "172.20.0.10",
      "service": "cve-2021-22205-gitlab-1-proxy",
      "level_prev": 100,
      "level_new": 100,
      "changed": false,
      "evidence_quotes": [
        "bash -p",
        "SUID Binary Enumeration Detected",
        "Reverse Shell Detected - No Job Control"
      ]
    },
    {
      "ip": "172.20.0.3",
      "service": "s2-057-struts2-1",
      "level_prev": 66,
      "level_new": 66,
      "changed": false,
      "evidence_quotes": [
        "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
        "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity",
        "Reverse Shell Detected - No Job Control"
      ]
    },
    {
      "ip": "172.20.0.2",
      "service": "unauthorized-rce-docker-1",
      "level_prev": 0,
      "level_new": 0,
      "changed": false,
      "evidence_quotes": [
        "No evidence found."
      ]
    },
    {
      "ip": "172.20.0.7",
      "service": "xdebug-rce-xdebug2-1",
      "level_prev": 0,
      "level_new": 0,
      "changed": false,
      "evidence_quotes": [
        "No evidence found."
      ]
    }
  ],
  "inferred_attack_graph": {
    "interesting": [
      {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "confidence": 1.0
      },
      {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "confidence": 1.0
      }
    ],
    "edges": [
      {
        "from": "192.168.100.2",
        "to": "172.20.0.10",
        "edge_id": "5e1f0a3c9b7d",
        "vector": "privilege-escalation",
        "phases": [
          {
            "phase": "scan",
            "confidence": 1.0,
            "evidence_quotes": [
              "ET INFO POSSIBLE Web Crawl using Curl",
              "User-Agent (python-requests)",
              "multiple events targeting port 80 on 172.20.0.10"
            ],
            "seen_in_epoch": 1
          },
          {
            "phase": "initial-access/rce",
            "confidence": 0.7,
            "evidence_quotes": [
              "ET WEB_SERVER Possible bash shell piped to dev tcp"
            ],
            "seen_in_epoch": 1
          },
          {
            "phase": "scan",
            "confidence": 1.0,
            "evidence_quotes": [
              "ET INFO POSSIBLE Web Crawl using Curl"
            ],
            "seen_in_epoch": 2
          },
          {
            "phase": "scan",
            "confidence": 1.0,
            "evidence_quotes": [
              "User-Agent (python-requests) Inbound to Webserver"
            ],
            "seen_in_epoch": 2
          },
          {
            "phase": "initial-access/rce",
            "confidence": 1.0,
            "evidence_quotes": [
              "Reverse Shell Detected - No Job Control"
            ],
            "seen_in_epoch": 2
          },
          {
            "phase": "initial-access/rce",
            "confidence": 0.9,
            "evidence_quotes": [
              "ET WEB_SERVER Possible bash shell piped to dev tcp"
            ],
            "seen_in_epoch": 2
          },
          {
            "phase": "data-exfil-user",
            "confidence": 0.6,
            "evidence_quotes": [
              "find binary execution"
            ],
            "seen_in_epoch": 2
          },
          {
            "phase": "scan",
            "confidence": 1.0,
            "evidence_quotes": [
              "ET INFO POSSIBLE Web Crawl using Curl"
            ],
            "seen_in_epoch": 3
          },
          {
            "phase": "scan",
            "confidence": 1.0,
            "evidence_quotes": [
              "User-Agent (python-requests) Inbound to Webserver"
            ],
            "seen_in_epoch": 3
          },
          {
            "phase": "initial-access/rce",
            "confidence": 1.0,
            "evidence_quotes": [
              "Reverse Shell Detected - No Job Control"
            ],
            "seen_in_epoch": 3
          },
          {
            "phase": "initial-access/rce",
            "confidence": 0.9,
            "evidence_quotes": [
              "ET WEB_SERVER Possible bash shell piped to dev tcp"
            ],
            "seen_in_epoch": 3
          },
          {
            "phase": "privilege-escalation",
            "confidence": 1.0,
            "evidence_quotes": [
              "bash -p"
            ],
            "seen_in_epoch": 3
          },
          {
            "phase": "privilege-escalation",
            "confidence": 1.0,
            "evidence_quotes": [
              "SUID Binary Enumeration Detected"
            ],
            "seen_in_epoch": 3
          }
        ],
        "first_seen": 1,
        "last_seen": 3,
        "current_phase": "privilege-escalation",
        "confidence": 1.0
      },
      {
        "from": "192.168.100.2",
        "to": "172.20.0.3",
        "edge_id": "0af3b0c9d2e1",
        "vector": "initial-access/rce",
        "phases": [
          {
            "phase": "scan",
            "confidence": 1.0,
            "evidence_quotes": [
              "User-Agent (python-requests) Inbound to Webserver",
              "curl User-Agent to Dotted Quad"
            ],
            "seen_in_epoch": 4
          },
          {
            "phase": "initial-access/rce",
            "confidence": 1.0,
            "evidence_quotes": [
              "Apache Struts Possible OGNL Java Exec In URI",
              "Apache Struts ognl inbound OGNL injection remote code execution attempt",
              "Apache Struts java.lang inbound OGNL injection remote code execution attempt",
              ".exec in HTTP URI Inbound - Possible Exploit Activity",
              "Reverse Shell Detected - No Job Control"
            ],
            "seen_in_epoch": 4
          },
          {
            "phase": "scan",
            "confidence": 1.0,
            "evidence_quotes": [
              "User-Agent (python-requests) Inbound to Webserver",
              "curl User-Agent to Dotted Quad"
            ],
            "seen_in_epoch": 5
          },
          {
            "phase": "initial-access/rce",
            "confidence": 1.0,
            "evidence_quotes": [
              "Apache Struts Possible OGNL Java Exec In URI",
              "Apache Struts ognl inbound OGNL injection remote code execution attempt",
              "Apache Struts java.lang inbound OGNL injection remote code execution attempt",
              ".exec in HTTP URI Inbound - Possible Exploit Activity",
              "Reverse Shell Detected - No Job Control"
            ],
            "seen_in_epoch": 5
          },
          {
            "phase": "scan",
            "confidence": 1.0,
            "evidence_quotes": [
              "User-Agent curl/python-requests"
            ],
            "seen_in_epoch": 6
          },
          {
            "phase": "initial-access/rce",
            "confidence": 1.0,
            "evidence_quotes": [
              "OGNL injection RCE",
              ".exec in HTTP URI",
              "Reverse Shell Detected",
              "reverse shell (60376->9999)"
            ],
            "seen_in_epoch": 6
          },
          {
            "phase": "scan",
            "confidence": 1.0,
            "evidence_quotes": [
              "ET INFO User-Agent (python-requests) Inbound to Webserver",
              "ET HUNTING curl User-Agent to Dotted Quad"
            ],
            "seen_in_epoch": 7
          },
          {
            "phase": "initial-access/rce",
            "confidence": 1.0,
            "evidence_quotes": [
              "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
              "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
              "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
              "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
              "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity",
              "Reverse Shell Detected - No Job Control"
            ],
            "seen_in_epoch": 7
          }
        ],
        "first_seen": 4,
        "last_seen": 7,
        "current_phase": "initial-access/rce",
        "confidence": 1.0
      }
    ],
    "edge_updates": [
      {
        "edge_id": "0af3b0c9d2e1",
        "added_phases": [
          "scan",
          "initial-access/rce"
        ],
        "seen_in_epoch": 7
      }
    ]
  },
  "service_epoch_context": [],
  "lockdown_activated": false
}