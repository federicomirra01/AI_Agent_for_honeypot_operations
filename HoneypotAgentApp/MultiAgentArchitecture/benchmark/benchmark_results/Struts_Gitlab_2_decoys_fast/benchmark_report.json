{
  "config": {
    "max_epochs": 20,
    "attacker_image": "attacker:latest",
    "attacker_container_name": "attackercontainer-attacker",
    "attack_duration": 150,
    "monitor_accumulation_wait": 50,
    "firewall_update_wait": 2,
    "between_epoch_wait": 1,
    "attacker_network": "192.168.100.0/24",
    "honeypot_network": "172.20.0.0/24",
    "firewall_api_url": "http://192.168.200.2:5000",
    "allow_full_compromise": true,
    "stop_on_lockdown": true,
    "clear_memory_between_epochs": false,
    "results_dir": "./benchmark/benchmark_results",
    "dir_name": "Struts_Gitlab_2_decoys_fast",
    "save_detailed_logs": true,
    "log_level": "INFO"
  },
  "start_time": 1755610050.5021179,
  "end_time": 1755611938.3424902,
  "total_epochs": 10,
  "epochs": [
    {
      "epoch_number": 1,
      "start_time": 1755610050.5021179,
      "end_time": 1755610154.1691236,
      "phase_timings": {
        "initialization": 1755610050.5021348,
        "attack_execution": 1755610050.5181475,
        "monitoring_accumulation": 1755610057.40705,
        "agent_analysis": 1755610107.4087348,
        "firewall_update_wait": 1755610152.151792,
        "metrics_collection": 1755610154.152965,
        "epoch_complete": 1755610154.1681058
      },
      "services_detected": [],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.5 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.5 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.5",
        "service": "cve-2014-6271-web-1",
        "current_level": 0,
        "epoch": 1
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [],
        "edges": [],
        "edge_updates": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 2,
      "start_time": 1755610155.1730042,
      "end_time": 1755610267.9260533,
      "phase_timings": {
        "initialization": 1755610155.1730146,
        "attack_execution": 1755610155.186538,
        "monitoring_accumulation": 1755610159.9851196,
        "agent_analysis": 1755610209.9861343,
        "firewall_update_wait": 1755610265.906322,
        "metrics_collection": 1755610267.9079285,
        "epoch_complete": 1755610267.9250834
      },
      "services_detected": [
        "HTTP(172.20.0.5:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.4 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3 (tcp)"
        }
      ],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.5",
        "service": "cve-2014-6271-web-1",
        "current_level": 33,
        "epoch": 2
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "ET SCAN Suspicious inbound to mySQL port 3306: 1",
            "POSSBL PORT SCAN (NMAP -sS): 2",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
            "ET INFO POSSIBLE Web Crawl using Curl: 1"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [],
        "edges": [
          {
            "from": "attacker",
            "to": "172.20.0.5",
            "edge_id": "e2f2449ff2e3",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          }
        ],
        "edge_updates": [
          {
            "from": "attacker",
            "to": "172.20.0.5",
            "edge_id": "e2f2449ff2e3",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 3,
      "start_time": 1755610268.931219,
      "end_time": 1755610553.173863,
      "phase_timings": {
        "initialization": 1755610268.931236,
        "attack_execution": 1755610268.9448652,
        "monitoring_accumulation": 1755610429.0099435,
        "agent_analysis": 1755610479.0117688,
        "firewall_update_wait": 1755610551.1559074,
        "metrics_collection": 1755610553.1575327,
        "epoch_complete": 1755610553.173068
      },
      "services_detected": [],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.5",
        "service": "cve-2014-6271-web-1",
        "current_level": 33,
        "epoch": 3
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 66,
          "changed": true,
          "evidence_quotes": [
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
            "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
            "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
            "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
            "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2",
            "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "attacker",
            "to": "172.20.0.5",
            "edge_id": "e2f2449ff2e3",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.3",
            "edge_id": "1e0b9d3873e5",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              }
            ],
            "current_phase": "initial-access/rce",
            "confidence": 1.0
          }
        ],
        "edge_updates": [
          {
            "from": "attacker",
            "to": "172.20.0.3",
            "edge_id": "1e0b9d3873e5",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              }
            ],
            "current_phase": "initial-access/rce",
            "confidence": 1.0
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 4,
      "start_time": 1755610554.1781926,
      "end_time": 1755610848.1632814,
      "phase_timings": {
        "initialization": 1755610554.1782105,
        "attack_execution": 1755610554.1916273,
        "monitoring_accumulation": 1755610697.9697104,
        "agent_analysis": 1755610747.9707336,
        "firewall_update_wait": 1755610846.144103,
        "metrics_collection": 1755610848.1454499,
        "epoch_complete": 1755610848.1623852
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)",
        "PATROL-SNMP(172.20.0.4:8161)",
        "HTTP-PROXY(172.20.0.3:8080)",
        "UNKNOWN(172.20.0.4:61616)",
        "HTTP(172.20.0.5:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #4:    ACCEPT     tcp  --  172.20.0.5           192.168.100.0/24",
            "REMOVED rule #5:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.5"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.4",
        "service": "cve-2015-5254-activemq-1",
        "current_level": 0,
        "epoch": 4
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "Targeted Services: Web service on port 8080 (all alerts involved this port)",
            "Honeypot Engagement: Attack patterns suggest automated exploitation attempts; no clear evidence of post-exploit interaction",
            "Compromise Indicators: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
            "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
            "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
            "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
            "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2",
            "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "attacker",
            "to": "172.20.0.5",
            "edge_id": "e2f2449ff2e3",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.3",
            "edge_id": "1e0b9d3873e5",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              }
            ],
            "current_phase": "initial-access/rce",
            "confidence": 1.0
          }
        ],
        "edge_updates": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 5,
      "start_time": 1755610849.1672044,
      "end_time": 1755611138.4480717,
      "phase_timings": {
        "initialization": 1755610849.1672144,
        "attack_execution": 1755610849.1837733,
        "monitoring_accumulation": 1755611009.2436962,
        "agent_analysis": 1755611059.2450051,
        "firewall_update_wait": 1755611136.431594,
        "metrics_collection": 1755611138.433639,
        "epoch_complete": 1755611138.447121
      },
      "services_detected": [],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.4",
        "service": "cve-2015-5254-activemq-1",
        "current_level": 0,
        "epoch": 5
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
            "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
            "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
            "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
            "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2",
            "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "attacker",
            "to": "172.20.0.5",
            "edge_id": "e2f2449ff2e3",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.3",
            "edge_id": "1e0b9d3873e5",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              }
            ],
            "current_phase": "initial-access/rce",
            "confidence": 1.0
          }
        ],
        "edge_updates": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 6,
      "start_time": 1755611139.4531317,
      "end_time": 1755611268.851339,
      "phase_timings": {
        "initialization": 1755611139.4531434,
        "attack_execution": 1755611139.4676366,
        "monitoring_accumulation": 1755611144.5646033,
        "agent_analysis": 1755611194.5652454,
        "firewall_update_wait": 1755611266.8336747,
        "metrics_collection": 1755611268.8348358,
        "epoch_complete": 1755611268.8504202
      },
      "services_detected": [
        "PATROL-SNMP(172.20.0.4:8161)",
        "UNKNOWN(172.20.0.4:61616)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.4",
        "service": "cve-2015-5254-activemq-1",
        "current_level": 33,
        "epoch": 6
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 33,
          "changed": true,
          "evidence_quotes": [
            "Multiple unique signatures and protocol detection events suggest active probing and interaction attempts",
            "ET SCAN Suspicious inbound to mySQL port 3306: 2",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
            "POSSBL PORT SCAN (NMAP -sS): 2",
            "ET INFO POSSIBLE Web Crawl using Curl: 1",
            "SURICATA Applayer Detect protocol only one direction: 22"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
            "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
            "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
            "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
            "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2",
            "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "attacker",
            "to": "172.20.0.5",
            "edge_id": "e2f2449ff2e3",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.3",
            "edge_id": "1e0b9d3873e5",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              }
            ],
            "current_phase": "initial-access/rce",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.4",
            "edge_id": "af519bf54db6",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Multiple unique signatures and protocol detection events suggest active probing and interaction attempts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1",
                  "SURICATA Applayer Detect protocol only one direction: 22"
                ],
                "seen_in_epoch": 3,
                "first_seen": 3,
                "last_seen": 3
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          }
        ],
        "edge_updates": [
          {
            "from": "attacker",
            "to": "172.20.0.4",
            "edge_id": "af519bf54db6",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Multiple unique signatures and protocol detection events suggest active probing and interaction attempts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1",
                  "SURICATA Applayer Detect protocol only one direction: 22"
                ],
                "seen_in_epoch": 3,
                "first_seen": 3,
                "last_seen": 3
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 7,
      "start_time": 1755611269.8559587,
      "end_time": 1755611414.1084554,
      "phase_timings": {
        "initialization": 1755611269.8559709,
        "attack_execution": 1755611269.8709126,
        "monitoring_accumulation": 1755611274.9716706,
        "agent_analysis": 1755611324.973119,
        "firewall_update_wait": 1755611412.0915353,
        "metrics_collection": 1755611414.0929685,
        "epoch_complete": 1755611414.1075597
      },
      "services_detected": [
        "PATROL-SNMP(172.20.0.4:8161)",
        "UNKNOWN(172.20.0.4:61616)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.4"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 0,
        "epoch": 7
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "ET SCAN Suspicious inbound to mySQL port 3306: 1",
            "POSSBL PORT SCAN (NMAP -sS): 3",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
            "ET INFO POSSIBLE Web Crawl using Curl: 1",
            "SURICATA Applayer Detect protocol only one direction: 20"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "No new exploitation or escalation events; prior OGNL exploit evidence holds."
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "attacker",
            "to": "172.20.0.5",
            "edge_id": "e2f2449ff2e3",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.3",
            "edge_id": "1e0b9d3873e5",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              }
            ],
            "current_phase": "initial-access/rce",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.4",
            "edge_id": "af519bf54db6",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Multiple unique signatures and protocol detection events suggest active probing and interaction attempts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1",
                  "SURICATA Applayer Detect protocol only one direction: 22"
                ],
                "seen_in_epoch": 3,
                "first_seen": 3,
                "last_seen": 3
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          }
        ],
        "edge_updates": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 8,
      "start_time": 1755611415.1125557,
      "end_time": 1755611577.8853743,
      "phase_timings": {
        "initialization": 1755611415.1125693,
        "attack_execution": 1755611415.126748,
        "monitoring_accumulation": 1755611435.8815546,
        "agent_analysis": 1755611485.8822196,
        "firewall_update_wait": 1755611575.8698065,
        "metrics_collection": 1755611577.871915,
        "epoch_complete": 1755611577.8847027
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{privileged_access}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.3 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.4 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.4 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.5 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.5 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "current_level": 66,
        "epoch": 8
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "ET WEB_SERVER Possible bash shell piped to dev tcp: 1",
            "SUID Binary Enumeration Detected: 2",
            "Privilege Escalation Attempt - bash -p: 2",
            "Reverse Shell Detected - No Job Control: 1"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "attacker",
            "to": "172.20.0.5",
            "edge_id": "e2f2449ff2e3",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.3",
            "edge_id": "1e0b9d3873e5",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              }
            ],
            "current_phase": "initial-access/rce",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.4",
            "edge_id": "af519bf54db6",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Multiple unique signatures and protocol detection events suggest active probing and interaction attempts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1",
                  "SURICATA Applayer Detect protocol only one direction: 22"
                ],
                "seen_in_epoch": 3,
                "first_seen": 3,
                "last_seen": 3
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.10",
            "edge_id": "5c98b860d3a8",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 3",
                  "ET SCAN Suspicious inbound to MySQL port 3306: 1",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1",
                  "ET INFO User-Agent (python-requests) Inbound to Webserver: 2",
                  "SURICATA IPv4 truncated packet: 20",
                  "SURICATA AF-PACKET truncated packet: 20"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp: 1",
                  "Reverse Shell Detected - No Job Control: 1"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4
              },
              {
                "phase": "privilege-escalation",
                "confidence": 1.0,
                "evidence_quotes": [
                  "SUID Binary Enumeration Detected: 2",
                  "Privilege Escalation Attempt - bash -p: 2"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4
              }
            ],
            "current_phase": "privilege-escalation",
            "confidence": 1.0
          }
        ],
        "edge_updates": [
          {
            "from": "attacker",
            "to": "172.20.0.10",
            "edge_id": "5c98b860d3a8",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 3",
                  "ET SCAN Suspicious inbound to MySQL port 3306: 1",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1",
                  "ET INFO User-Agent (python-requests) Inbound to Webserver: 2",
                  "SURICATA IPv4 truncated packet: 20",
                  "SURICATA AF-PACKET truncated packet: 20"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp: 1",
                  "Reverse Shell Detected - No Job Control: 1"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4
              },
              {
                "phase": "privilege-escalation",
                "confidence": 1.0,
                "evidence_quotes": [
                  "SUID Binary Enumeration Detected: 2",
                  "Privilege Escalation Attempt - bash -p: 2"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4
              }
            ],
            "current_phase": "privilege-escalation",
            "confidence": 1.0
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 9,
      "start_time": 1755611578.891254,
      "end_time": 1755611756.7258475,
      "phase_timings": {
        "initialization": 1755611578.8912714,
        "attack_execution": 1755611578.9047675,
        "monitoring_accumulation": 1755611600.2627392,
        "agent_analysis": 1755611650.26365,
        "firewall_update_wait": 1755611754.7091365,
        "metrics_collection": 1755611756.7105026,
        "epoch_complete": 1755611756.7248085
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)",
        "UNKNOWN(172.20.0.4:61616)",
        "PATROL-SNMP(172.20.0.4:8161)",
        "HTTP-PROXY(172.20.0.3:8080)",
        "HTTP(172.20.0.5:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{privileged_access}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10",
            "REMOVED rule #3:    ACCEPT     tcp  --  172.20.0.5           192.168.100.0/24",
            "REMOVED rule #4:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.5",
            "REMOVED rule #5:    ACCEPT     tcp  --  172.20.0.4           192.168.100.0/24",
            "REMOVED rule #6:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.4"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "current_level": 66,
        "epoch": 9
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 3",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 2",
            "SURICATA Applayer Detect protocol only one direction: 24",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
            "ET INFO POSSIBLE Web Crawl using Curl: 1"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": [
            "ET WEB_SERVER Possible bash shell piped to dev tcp: 1",
            "SUID Binary Enumeration Detected: 2",
            "Privilege Escalation Attempt - bash -p: 2",
            "Reverse Shell Detected - No Job Control: 1"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 66,
          "changed": false,
          "evidence_quotes": [
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
            "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
            "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
            "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
            "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "attacker",
            "to": "172.20.0.5",
            "edge_id": "e2f2449ff2e3",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.3",
            "edge_id": "1e0b9d3873e5",
            "vector": "initial-access/rce",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              }
            ],
            "current_phase": "initial-access/rce",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.4",
            "edge_id": "af519bf54db6",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Multiple unique signatures and protocol detection events suggest active probing and interaction attempts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1",
                  "SURICATA Applayer Detect protocol only one direction: 22"
                ],
                "seen_in_epoch": 3,
                "first_seen": 3,
                "last_seen": 3
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.10",
            "edge_id": "5c98b860d3a8",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 3",
                  "ET SCAN Suspicious inbound to MySQL port 3306: 1",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1",
                  "ET INFO User-Agent (python-requests) Inbound to Webserver: 2",
                  "SURICATA IPv4 truncated packet: 20",
                  "SURICATA AF-PACKET truncated packet: 20"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp: 1",
                  "Reverse Shell Detected - No Job Control: 1"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4
              },
              {
                "phase": "privilege-escalation",
                "confidence": 1.0,
                "evidence_quotes": [
                  "SUID Binary Enumeration Detected: 2",
                  "Privilege Escalation Attempt - bash -p: 2"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4
              }
            ],
            "current_phase": "privilege-escalation",
            "confidence": 1.0
          }
        ],
        "edge_updates": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 10,
      "start_time": 1755611757.7294374,
      "end_time": 1755611938.3424902,
      "phase_timings": {
        "initialization": 1755611757.729454,
        "attack_execution": 1755611757.7470515,
        "monitoring_accumulation": 1755611770.6954226,
        "agent_analysis": 1755611820.696413,
        "firewall_update_wait": 1755611936.323095,
        "metrics_collection": 1755611938.324558,
        "epoch_complete": 1755611938.341444
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.3:8080)"
      ],
      "services_successfully_exploited": [
        "STRUTS"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "STRUTS",
          "flag": "flag{privileged_struts}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.3 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.4 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.4 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.5 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.5 -> 192.168.100.0/24 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.3           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "",
        "service": "",
        "current_level": 0,
        "epoch": 10
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 3",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 33,
          "level_new": 33,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 2",
            "SURICATA Applayer Detect protocol only one direction: 24",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
            "ET INFO POSSIBLE Web Crawl using Curl: 1"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": [
            "ET WEB_SERVER Possible bash shell piped to dev tcp: 1",
            "SUID Binary Enumeration Detected: 2",
            "Privilege Escalation Attempt - bash -p: 2",
            "Reverse Shell Detected - No Job Control: 1"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 66,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "Reverse Shell Detected - No Job Control [1]"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1",
            "confidence": 1.0
          },
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "attacker",
            "to": "172.20.0.5",
            "edge_id": "e2f2449ff2e3",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1"
                ],
                "seen_in_epoch": 1,
                "first_seen": 1,
                "last_seen": 1
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.3",
            "edge_id": "1e0b9d3873e5",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2"
                ],
                "seen_in_epoch": 2,
                "first_seen": 2,
                "last_seen": 2
              },
              {
                "phase": "data-exfil-user",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Reverse Shell Detected - No Job Control [1]"
                ],
                "seen_in_epoch": 5,
                "first_seen": 5,
                "last_seen": 5
              }
            ],
            "current_phase": "data-exfil-user",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.4",
            "edge_id": "af519bf54db6",
            "vector": "scan",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Multiple unique signatures and protocol detection events suggest active probing and interaction attempts",
                  "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "POSSBL PORT SCAN (NMAP -sS): 2",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1",
                  "SURICATA Applayer Detect protocol only one direction: 22"
                ],
                "seen_in_epoch": 3,
                "first_seen": 3,
                "last_seen": 3
              }
            ],
            "current_phase": "scan",
            "confidence": 1.0
          },
          {
            "from": "attacker",
            "to": "172.20.0.10",
            "edge_id": "5c98b860d3a8",
            "vector": "privilege-escalation",
            "phases": [
              {
                "phase": "scan",
                "confidence": 1.0,
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS): 3",
                  "ET SCAN Suspicious inbound to MySQL port 3306: 1",
                  "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                  "ET INFO POSSIBLE Web Crawl using Curl: 1",
                  "ET INFO User-Agent (python-requests) Inbound to Webserver: 2",
                  "SURICATA IPv4 truncated packet: 20",
                  "SURICATA AF-PACKET truncated packet: 20"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4
              },
              {
                "phase": "initial-access/rce",
                "confidence": 1.0,
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp: 1",
                  "Reverse Shell Detected - No Job Control: 1"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4
              },
              {
                "phase": "privilege-escalation",
                "confidence": 1.0,
                "evidence_quotes": [
                  "SUID Binary Enumeration Detected: 2",
                  "Privilege Escalation Attempt - bash -p: 2"
                ],
                "seen_in_epoch": 4,
                "first_seen": 4,
                "last_seen": 4
              }
            ],
            "current_phase": "privilege-escalation",
            "confidence": 1.0
          }
        ],
        "edge_updates": [
          {
            "from": "attacker",
            "to": "172.20.0.3",
            "edge_id": "1e0b9d3873e5",
            "vector": "data-exfil-user",
            "phases": [
              {
                "phase": "data-exfil-user",
                "confidence": 1.0,
                "evidence_quotes": [
                  "Reverse Shell Detected - No Job Control [1]"
                ],
                "seen_in_epoch": 5,
                "first_seen": 5,
                "last_seen": 5
              }
            ],
            "current_phase": "data-exfil-user",
            "confidence": 1.0
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": true
    }
  ],
  "summary": {
    "total_flags_captured": 3,
    "average_epoch_duration": 187.8799823999405,
    "lockdown_triggered": true,
    "lockdown_epoch": 10,
    "final_honeypots_exploitation": [
      {
        "ip": "172.20.0.5",
        "service": "cve-2014-6271-web-1",
        "level_prev": 33,
        "level_new": 33,
        "changed": false,
        "evidence_quotes": [
          "POSSBL PORT SCAN (NMAP -sS): 3",
          "ET SCAN Suspicious inbound to mySQL port 3306: 1",
          "ET SCAN Suspicious inbound to MSSQL port 1433: 1"
        ]
      },
      {
        "ip": "172.20.0.4",
        "service": "cve-2015-5254-activemq-1",
        "level_prev": 33,
        "level_new": 33,
        "changed": false,
        "evidence_quotes": [
          "POSSBL PORT SCAN (NMAP -sS): 2",
          "SURICATA Applayer Detect protocol only one direction: 24",
          "ET SCAN Suspicious inbound to mySQL port 3306: 1",
          "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
          "ET INFO POSSIBLE Web Crawl using Curl: 1"
        ]
      },
      {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": [
          "ET WEB_SERVER Possible bash shell piped to dev tcp: 1",
          "SUID Binary Enumeration Detected: 2",
          "Privilege Escalation Attempt - bash -p: 2",
          "Reverse Shell Detected - No Job Control: 1"
        ]
      },
      {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "level_prev": 66,
        "level_new": 100,
        "changed": true,
        "evidence_quotes": [
          "Reverse Shell Detected - No Job Control [1]"
        ]
      }
    ],
    "final_inferred_attack_graph": {
      "interesting": [
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "confidence": 1.0
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "confidence": 1.0
        }
      ],
      "edges": [
        {
          "from": "attacker",
          "to": "172.20.0.5",
          "edge_id": "e2f2449ff2e3",
          "vector": "scan",
          "phases": [
            {
              "phase": "scan",
              "confidence": 1.0,
              "evidence_quotes": [
                "ET SCAN Suspicious inbound to mySQL port 3306: 1",
                "POSSBL PORT SCAN (NMAP -sS): 2",
                "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                "ET INFO POSSIBLE Web Crawl using Curl: 1"
              ],
              "seen_in_epoch": 1,
              "first_seen": 1,
              "last_seen": 1
            }
          ],
          "current_phase": "scan",
          "confidence": 1.0
        },
        {
          "from": "attacker",
          "to": "172.20.0.3",
          "edge_id": "1e0b9d3873e5",
          "vector": "data-exfil-user",
          "phases": [
            {
              "phase": "scan",
              "confidence": 1.0,
              "evidence_quotes": [
                "ET INFO User-Agent (python-requests) Inbound to Webserver: 2"
              ],
              "seen_in_epoch": 2,
              "first_seen": 2,
              "last_seen": 2
            },
            {
              "phase": "initial-access/rce",
              "confidence": 1.0,
              "evidence_quotes": [
                "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI: 2",
                "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action: 2",
                "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt: 2",
                "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt: 2",
                "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity: 2"
              ],
              "seen_in_epoch": 2,
              "first_seen": 2,
              "last_seen": 2
            },
            {
              "phase": "data-exfil-user",
              "confidence": 1.0,
              "evidence_quotes": [
                "Reverse Shell Detected - No Job Control [1]"
              ],
              "seen_in_epoch": 5,
              "first_seen": 5,
              "last_seen": 5
            }
          ],
          "current_phase": "data-exfil-user",
          "confidence": 1.0
        },
        {
          "from": "attacker",
          "to": "172.20.0.4",
          "edge_id": "af519bf54db6",
          "vector": "scan",
          "phases": [
            {
              "phase": "scan",
              "confidence": 1.0,
              "evidence_quotes": [
                "Multiple unique signatures and protocol detection events suggest active probing and interaction attempts",
                "ET SCAN Suspicious inbound to mySQL port 3306: 2",
                "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                "POSSBL PORT SCAN (NMAP -sS): 2",
                "ET INFO POSSIBLE Web Crawl using Curl: 1",
                "SURICATA Applayer Detect protocol only one direction: 22"
              ],
              "seen_in_epoch": 3,
              "first_seen": 3,
              "last_seen": 3
            }
          ],
          "current_phase": "scan",
          "confidence": 1.0
        },
        {
          "from": "attacker",
          "to": "172.20.0.10",
          "edge_id": "5c98b860d3a8",
          "vector": "privilege-escalation",
          "phases": [
            {
              "phase": "scan",
              "confidence": 1.0,
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS): 3",
                "ET SCAN Suspicious inbound to MySQL port 3306: 1",
                "ET SCAN Suspicious inbound to MSSQL port 1433: 1",
                "ET INFO POSSIBLE Web Crawl using Curl: 1",
                "ET INFO User-Agent (python-requests) Inbound to Webserver: 2",
                "SURICATA IPv4 truncated packet: 20",
                "SURICATA AF-PACKET truncated packet: 20"
              ],
              "seen_in_epoch": 4,
              "first_seen": 4,
              "last_seen": 4
            },
            {
              "phase": "initial-access/rce",
              "confidence": 1.0,
              "evidence_quotes": [
                "ET WEB_SERVER Possible bash shell piped to dev tcp: 1",
                "Reverse Shell Detected - No Job Control: 1"
              ],
              "seen_in_epoch": 4,
              "first_seen": 4,
              "last_seen": 4
            },
            {
              "phase": "privilege-escalation",
              "confidence": 1.0,
              "evidence_quotes": [
                "SUID Binary Enumeration Detected: 2",
                "Privilege Escalation Attempt - bash -p: 2"
              ],
              "seen_in_epoch": 4,
              "first_seen": 4,
              "last_seen": 4
            }
          ],
          "current_phase": "privilege-escalation",
          "confidence": 1.0
        }
      ],
      "edge_updates": [
        {
          "from": "attacker",
          "to": "172.20.0.3",
          "edge_id": "1e0b9d3873e5",
          "vector": "data-exfil-user",
          "phases": [
            {
              "phase": "data-exfil-user",
              "confidence": 1.0,
              "evidence_quotes": [
                "Reverse Shell Detected - No Job Control [1]"
              ],
              "seen_in_epoch": 5,
              "first_seen": 5,
              "last_seen": 5
            }
          ],
          "current_phase": "data-exfil-user",
          "confidence": 1.0
        }
      ]
    }
  }
}