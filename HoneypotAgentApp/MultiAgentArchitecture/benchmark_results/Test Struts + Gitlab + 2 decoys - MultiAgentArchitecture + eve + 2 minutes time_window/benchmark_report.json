{
  "config": {
    "max_epochs": 8,
    "attacker_image": "attacker:latest",
    "attacker_container_name": "attackercontainer-attacker",
    "attack_duration": 200,
    "monitor_accumulation_wait": 50,
    "firewall_update_wait": 2,
    "between_epoch_wait": 1,
    "attacker_network": "192.168.100.0/24",
    "honeypot_network": "172.20.0.0/24",
    "firewall_api_url": "http://192.168.200.2:5000",
    "allow_full_compromise": true,
    "stop_on_lockdown": true,
    "clear_memory_between_epochs": false,
    "results_dir": "./benchmark_results",
    "dir_name": "Test Struts + Gitlab + 2 decoys - MultiAgentArchitecture + eve + 2 minutes time_window",
    "save_detailed_logs": true,
    "log_level": "INFO"
  },
  "start_time": 1754668766.0389059,
  "end_time": 1754669315.7545516,
  "total_epochs": 5,
  "epochs": [
    {
      "epoch_number": 1,
      "start_time": 1754668766.0389059,
      "end_time": 1754668882.0270684,
      "phase_timings": {
        "initialization": 1754668766.0389233,
        "attack_execution": 1754668766.0553603,
        "monitoring_accumulation": 1754668772.838397,
        "agent_analysis": 1754668822.8399427,
        "firewall_update_wait": 1754668880.0094616,
        "metrics_collection": 1754668882.011971,
        "epoch_complete": 1754668882.0262113
      },
      "services_detected": [],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.6 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.6 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "172.20.0.6",
        "service": "activemq",
        "current_level": 0
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.6",
          "service": "activemq",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "nginx (gitlab-proxy)",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "struts2",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "bash-httpd (web)",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [],
        "edges": []
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 2,
      "start_time": 1754668883.031929,
      "end_time": 1754668984.9523158,
      "phase_timings": {
        "initialization": 1754668883.0319452,
        "attack_execution": 1754668883.046247,
        "monitoring_accumulation": 1754668888.1348789,
        "agent_analysis": 1754668938.1364517,
        "firewall_update_wait": 1754668982.9334126,
        "metrics_collection": 1754668984.9352727,
        "epoch_complete": 1754668984.9515276
      },
      "services_detected": [
        "PATROL-SNMP(172.20.0.6:8161)",
        "UNKNOWN(172.20.0.6:61616)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.2 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.6           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.6"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.2",
        "service": "struts2",
        "current_level": 0
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.6",
          "service": "activemq",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS): 2 events [no payload]",
            "ET SCAN Suspicious inbound to mySQL port 3306: 1 event [no payload]",
            "ET SCAN Suspicious inbound to MSSQL port 1433: 1 event [no payload]",
            "ET INFO POSSIBLE Web Crawl using Curl: 1 event [command: GET /showcase]",
            "SURICATA Applayer Detect protocol only one direction: 23 events [no payload]"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "nginx (gitlab-proxy)",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "struts2",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "bash-httpd (web)",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [],
        "edges": []
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 3,
      "start_time": 1754668985.9560611,
      "end_time": 1754669091.7611513,
      "phase_timings": {
        "initialization": 1754668985.9560761,
        "attack_execution": 1754668985.9701202,
        "monitoring_accumulation": 1754668998.8164477,
        "agent_analysis": 1754669048.818201,
        "firewall_update_wait": 1754669089.7479382,
        "metrics_collection": 1754669091.7489054,
        "epoch_complete": 1754669091.760303
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.2:8080)"
      ],
      "services_successfully_exploited": [
        "STRUTS"
      ],
      "exploits_attempted": [
        "HTTP-PROXY(172.20.0.2:8080)"
      ],
      "flags_captured": [
        {
          "service": "STRUTS",
          "flag": "flag{privileged_struts}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.2           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.2"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.10",
        "service": "nginx (gitlab-proxy)",
        "current_level": 0
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.6",
          "service": "activemq",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "nginx (gitlab-proxy)",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "struts2",
          "level_prev": 0,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "Multiple RCE and privilege escalation attempts via Apache Struts OGNL injection (severity 1)",
            "Confirmed remote shell and root compromise evidenced by \"Reverse Shell Detected - No Job Control\" and exfiltration of 'root.txt' (flag: flag{privileged_struts})",
            "Confirmed attacker interaction: attacker successfully exploited Struts2 RCE, established interactive shell as root, accessed sensitive file (root.txt)",
            "Reverse Shell Detected - No Job Control [count: 1] (payload includes shell prompt and exfiltration commands: 'find / -name root.txt', 'cat /root/root.txt')"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "bash-httpd (web)",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "No evidence found."
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "struts2",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "rce-priv-esc",
            "confidence": 1.0
          }
        ]
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 4,
      "start_time": 1754669092.7648995,
      "end_time": 1754669216.6736772,
      "phase_timings": {
        "initialization": 1754669092.7649114,
        "attack_execution": 1754669092.7767344,
        "monitoring_accumulation": 1754669110.5953777,
        "agent_analysis": 1754669160.5961268,
        "firewall_update_wait": 1754669214.653471,
        "metrics_collection": 1754669216.6564465,
        "epoch_complete": 1754669216.672863
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [
        "HTTP(172.20.0.10:80)"
      ],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{user_access}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.7 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.7 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10"
          ]
        }
      ],
      "honeypots_exposed": {
        "ip": "172.20.0.7",
        "service": "bash-httpd (web)",
        "current_level": 0
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.6",
          "service": "activemq",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "Targeted Services: No evidence found.",
            "Honeypot Engagement: No evidence found."
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "nginx (gitlab-proxy)",
          "level_prev": 0,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "Reverse Shell Detected - No Job Control",
            "executing 'find / -type f -name 'user.txt'' and 'cat /home/ctf/user.txt'",
            "interactive session for file discovery and exfiltration (e.g., executing \"find / -type f -name 'user.txt'\" and \"cat /home/ctf/user.txt\")"
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "struts2",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": [
            "No direct evidence (event captured within payload; minimal details)",
            "Honeypot Engagement: No evidence found."
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "bash-httpd (web)",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "Targeted Services: No evidence found.",
            "Honeypot Engagement: No evidence found."
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "struts2",
            "confidence": 1.0
          },
          {
            "ip": "172.20.0.10",
            "service": "nginx (gitlab-proxy)",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "rce-priv-esc",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "rce-post-compromise",
            "confidence": 1.0
          }
        ]
      },
      "lockdown_activated": false
    },
    {
      "epoch_number": 5,
      "start_time": 1754669217.6781309,
      "end_time": 1754669315.7545516,
      "phase_timings": {
        "initialization": 1754669217.6781404,
        "attack_execution": 1754669217.6948977,
        "monitoring_accumulation": 1754669222.4184625,
        "agent_analysis": 1754669272.420378,
        "firewall_update_wait": 1754669313.7357225,
        "metrics_collection": 1754669315.7370532,
        "epoch_complete": 1754669315.7538376
      },
      "services_detected": [
        "HTTP(172.20.0.7:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [
        "HTTP(172.20.0.7:80)"
      ],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "honeypots_exposed": {
        "ip": "",
        "service": "",
        "current_level": 0
      },
      "honeypots_exploitation": [
        {
          "ip": "172.20.0.6",
          "service": "activemq",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "Targeted Services: None observed",
            "Honeypot Engagement: No evidence found."
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "nginx (gitlab-proxy)",
          "level_prev": 0,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "Reverse Shell Detected - No Job Control",
            "executing 'find / -type f -name 'user.txt'' and 'cat /home/ctf/user.txt'",
            "interactive session for file discovery and exfiltration (e.g., executing \"find / -type f -name 'user.txt'\" and \"cat /home/ctf/user.txt\")"
          ]
        },
        {
          "ip": "172.20.0.2",
          "service": "struts2",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": [
            "No direct evidence (event captured within payload; minimal details)",
            "Honeypot Engagement: No evidence found."
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "bash-httpd (web)",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)",
            "ET SCAN Suspicious inbound to mySQL port 3306",
            "ET SCAN Suspicious inbound to MSSQL port 1433",
            "ET INFO POSSIBLE Web Crawl using Curl"
          ]
        }
      ],
      "inferred_attack_graph": {
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "struts2",
            "confidence": 1.0
          },
          {
            "ip": "172.20.0.10",
            "service": "nginx (gitlab-proxy)",
            "confidence": 1.0
          }
        ],
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "vector": "rce-priv-esc",
            "confidence": 1.0
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "vector": "rce-post-compromise",
            "confidence": 1.0
          }
        ]
      },
      "lockdown_activated": true
    }
  ],
  "summary": {
    "total_flags_captured": 2,
    "average_epoch_duration": 109.13976759910584,
    "lockdown_triggered": true,
    "lockdown_epoch": 5,
    "final_honeypots_exploitation": [
      {
        "ip": "172.20.0.6",
        "service": "activemq",
        "level_prev": 0,
        "level_new": 0,
        "changed": false,
        "evidence_quotes": [
          "Targeted Services: None observed",
          "Honeypot Engagement: No evidence found."
        ]
      },
      {
        "ip": "172.20.0.10",
        "service": "nginx (gitlab-proxy)",
        "level_prev": 0,
        "level_new": 100,
        "changed": true,
        "evidence_quotes": [
          "Reverse Shell Detected - No Job Control",
          "executing 'find / -type f -name 'user.txt'' and 'cat /home/ctf/user.txt'",
          "interactive session for file discovery and exfiltration (e.g., executing \"find / -type f -name 'user.txt'\" and \"cat /home/ctf/user.txt\")"
        ]
      },
      {
        "ip": "172.20.0.2",
        "service": "struts2",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": [
          "No direct evidence (event captured within payload; minimal details)",
          "Honeypot Engagement: No evidence found."
        ]
      },
      {
        "ip": "172.20.0.7",
        "service": "bash-httpd (web)",
        "level_prev": 0,
        "level_new": 0,
        "changed": false,
        "evidence_quotes": [
          "POSSBL PORT SCAN (NMAP -sS)",
          "ET SCAN Suspicious inbound to mySQL port 3306",
          "ET SCAN Suspicious inbound to MSSQL port 1433",
          "ET INFO POSSIBLE Web Crawl using Curl"
        ]
      }
    ],
    "final_inferred_attack_graph": {
      "interesting": [
        {
          "ip": "172.20.0.2",
          "service": "struts2",
          "confidence": 1.0
        },
        {
          "ip": "172.20.0.10",
          "service": "nginx (gitlab-proxy)",
          "confidence": 1.0
        }
      ],
      "edges": [
        {
          "from": "192.168.100.2",
          "to": "172.20.0.2",
          "vector": "rce-priv-esc",
          "confidence": 1.0
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.10",
          "vector": "rce-post-compromise",
          "confidence": 1.0
        }
      ]
    }
  }
}